(()=>{var e={14082:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/logo.2c128f3962a8aeac067e.png"},35358:(e,t,n)=>{var r={"./af":17582,"./af.js":17582,"./ar":93042,"./ar-dz":54265,"./ar-dz.js":54265,"./ar-kw":92553,"./ar-kw.js":92553,"./ar-ly":85352,"./ar-ly.js":85352,"./ar-ma":67097,"./ar-ma.js":67097,"./ar-ps":76150,"./ar-ps.js":76150,"./ar-sa":84427,"./ar-sa.js":84427,"./ar-tn":7221,"./ar-tn.js":7221,"./ar.js":93042,"./az":60458,"./az.js":60458,"./be":17596,"./be.js":17596,"./bg":93830,"./bg.js":93830,"./bm":27044,"./bm.js":27044,"./bn":58573,"./bn-bd":13296,"./bn-bd.js":13296,"./bn.js":58573,"./bo":25614,"./bo.js":25614,"./br":84422,"./br.js":84422,"./bs":91786,"./bs.js":91786,"./ca":75833,"./ca.js":75833,"./cs":52711,"./cs.js":52711,"./cv":71036,"./cv.js":71036,"./cy":84977,"./cy.js":84977,"./da":8770,"./da.js":8770,"./de":67342,"./de-at":81566,"./de-at.js":81566,"./de-ch":87544,"./de-ch.js":87544,"./de.js":67342,"./dv":82875,"./dv.js":82875,"./el":78536,"./el.js":78536,"./en-au":38617,"./en-au.js":38617,"./en-ca":79227,"./en-ca.js":79227,"./en-gb":59754,"./en-gb.js":59754,"./en-ie":37217,"./en-ie.js":37217,"./en-il":85418,"./en-il.js":85418,"./en-in":80800,"./en-in.js":80800,"./en-nz":67299,"./en-nz.js":67299,"./en-sg":76305,"./en-sg.js":76305,"./eo":8673,"./eo.js":8673,"./es":71301,"./es-do":3187,"./es-do.js":3187,"./es-mx":48223,"./es-mx.js":48223,"./es-us":37634,"./es-us.js":37634,"./es.js":71301,"./et":4976,"./et.js":4976,"./eu":11847,"./eu.js":11847,"./fa":74372,"./fa.js":74372,"./fi":41628,"./fi.js":41628,"./fil":56802,"./fil.js":56802,"./fo":42874,"./fo.js":42874,"./fr":9853,"./fr-ca":87170,"./fr-ca.js":87170,"./fr-ch":22825,"./fr-ch.js":22825,"./fr.js":9853,"./fy":68876,"./fy.js":68876,"./ga":93533,"./ga.js":93533,"./gd":82770,"./gd.js":82770,"./gl":98602,"./gl.js":98602,"./gom-deva":63059,"./gom-deva.js":63059,"./gom-latn":48212,"./gom-latn.js":48212,"./gu":23409,"./gu.js":23409,"./he":17210,"./he.js":17210,"./hi":4750,"./hi.js":4750,"./hr":51315,"./hr.js":51315,"./hu":47626,"./hu.js":47626,"./hy-am":91317,"./hy-am.js":91317,"./id":26892,"./id.js":26892,"./is":97577,"./is.js":97577,"./it":57628,"./it-ch":3046,"./it-ch.js":3046,"./it.js":57628,"./ja":92504,"./ja.js":92504,"./jv":25917,"./jv.js":25917,"./ka":64513,"./ka.js":64513,"./kk":94935,"./kk.js":94935,"./km":96661,"./km.js":96661,"./kn":89964,"./kn.js":89964,"./ko":98067,"./ko.js":98067,"./ku":61165,"./ku-kmr":85158,"./ku-kmr.js":85158,"./ku.js":61165,"./ky":11177,"./ky.js":11177,"./lb":2967,"./lb.js":2967,"./lo":81972,"./lo.js":81972,"./lt":58469,"./lt.js":58469,"./lv":33155,"./lv.js":33155,"./me":87935,"./me.js":87935,"./mi":74483,"./mi.js":74483,"./mk":32501,"./mk.js":32501,"./ml":73120,"./ml.js":73120,"./mn":20266,"./mn.js":20266,"./mr":19406,"./mr.js":19406,"./ms":80109,"./ms-my":90864,"./ms-my.js":90864,"./ms.js":80109,"./mt":22904,"./mt.js":22904,"./my":44067,"./my.js":44067,"./nb":21301,"./nb.js":21301,"./ne":81152,"./ne.js":81152,"./nl":76735,"./nl-be":97761,"./nl-be.js":97761,"./nl.js":76735,"./nn":37569,"./nn.js":37569,"./oc-lnc":20833,"./oc-lnc.js":20833,"./pa-in":3044,"./pa-in.js":3044,"./pl":34249,"./pl.js":34249,"./pt":87585,"./pt-br":26826,"./pt-br.js":26826,"./pt.js":87585,"./ro":62526,"./ro.js":62526,"./ru":62204,"./ru.js":62204,"./sd":43270,"./sd.js":43270,"./se":61541,"./se.js":61541,"./si":71921,"./si.js":71921,"./sk":49935,"./sk.js":49935,"./sl":46254,"./sl.js":46254,"./sq":59897,"./sq.js":59897,"./sr":42496,"./sr-cyrl":11135,"./sr-cyrl.js":11135,"./sr.js":42496,"./ss":32215,"./ss.js":32215,"./sv":84716,"./sv.js":84716,"./sw":50803,"./sw.js":50803,"./ta":31538,"./ta.js":31538,"./te":2302,"./te.js":2302,"./tet":25280,"./tet.js":25280,"./tg":14100,"./tg.js":14100,"./th":95385,"./th.js":95385,"./tk":736,"./tk.js":736,"./tl-ph":79726,"./tl-ph.js":79726,"./tlh":41873,"./tlh.js":41873,"./tr":36463,"./tr.js":36463,"./tzl":27491,"./tzl.js":27491,"./tzm":29500,"./tzm-latn":80196,"./tzm-latn.js":80196,"./tzm.js":29500,"./ug-cn":91287,"./ug-cn.js":91287,"./uk":35341,"./uk.js":35341,"./ur":36246,"./ur.js":36246,"./uz":55550,"./uz-latn":77254,"./uz-latn.js":77254,"./uz.js":55550,"./vi":78796,"./vi.js":78796,"./x-pseudo":22736,"./x-pseudo.js":22736,"./yo":28621,"./yo.js":28621,"./zh-cn":67601,"./zh-cn.js":67601,"./zh-hk":39053,"./zh-hk.js":39053,"./zh-mo":71248,"./zh-mo.js":71248,"./zh-tw":74725,"./zh-tw.js":74725};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id=35358},35479:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Mt,navigateToTab:()=>Nt,navigationRef:()=>Lt});var r={};n.r(r),n.d(r,{CustomDarkTheme:()=>St,LightTheme:()=>vt,default:()=>wt});var a=n(10467),o=n(80296),l=n(64467),s=n(36665),i=n(73929),d=n(20530),u=n(6283),c=n(66986),f=n(43570),m=n(15248),h=n(91087),p=n(43117),g=n(59814),y=n(8218),x=n(73668),j=n(50368),b=n(44767),C=n(15648),v=n(40484),S=n(51690),w=n(18885),T=n(61092),B=n(47514),k=n(2469),D=n(45458),F=n(77109);const P={API_URL:"https://barb-kq5v.onrender.com/api",DEBUG:!1,TIMEOUT:2e4,MAX_RETRIES:1};var A=Array.isArray(P.API_URL)?P.API_URL:[P.API_URL].concat((0,D.default)(P.API_URL_ALTERNATIVES||[])),I=A[0],E=F.default.create({baseURL:I,headers:{"Content-Type":"application/json"},timeout:P.TIMEOUT||1e4,validateStatus:function(e){return e>=200&&e<500}}),O=P.MAX_RETRIES||3,z=function(){var e=(0,a.default)((function*(e){var t=e.config;if(t.retryCount=t.retryCount||0,t.retryCount>=O*A.length)return Promise.reject(e);if("ECONNABORTED"===e.code||!e.response){var n=Math.floor(t.retryCount/O)%A.length;t.baseURL=A[n],console.log(`Trying different base URL: ${t.baseURL}`)}return t.retryCount+=1,yield new Promise((function(e){return setTimeout(e,1e3*(t.retryCount%O+1))})),E(t)}));return function(t){return e.apply(this,arguments)}}();E.interceptors.request.use(function(){var e=(0,a.default)((function*(e){try{var t=yield h.default.getItem("userToken");if(!t){var n=yield h.default.getItem("userInfo");if(n)t=JSON.parse(n).token}return t?(e.headers.Authorization=`Bearer ${t}`,console.log(`Adding auth token to request: ${t.substring(0,15)}...`)):console.log("No auth token available for request"),console.log(`API Request: ${e.method.toUpperCase()} ${e.baseURL}${e.url}`),e}catch(r){return console.error("Error in request interceptor:",r),e}}));return function(t){return e.apply(this,arguments)}}(),(function(e){return console.error("Request interceptor error:",e),Promise.reject(e)})),E.interceptors.response.use((function(e){return e}),function(){var e=(0,a.default)((function*(e){var t,n,r;return console.error("API Error:",(null==(t=e.response)?void 0:t.data)||e.message),e.response&&"ECONNABORTED"!==e.code?(401===(null==(n=e.response)?void 0:n.status)&&(console.log("Unauthorized - clearing token"),yield h.default.removeItem("userToken"),yield h.default.removeItem("userInfo")),Promise.reject(e)):(console.log(`Retrying request (${(null==(r=e.config)?void 0:r.retryCount)||1}/${O})`),z(e))}));return function(t){return e.apply(this,arguments)}}());var $=function(){return E.get("/services")},R=function(){return E.get("/appointments")},M=function(e,t){return E.put(`/appointments/${e}`,t)},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return console.log(`Making DELETE request to /appointments/${e} with data:`,t),E.delete(`/appointments/${e}`,{data:t})},N=function(e){return console.log(`Deleting appointment permanently: /appointments/${e}/delete`),E.delete(`/appointments/${e}/delete`)},_=function(e,t,n){var r=encodeURIComponent(t),a=encodeURIComponent(n);return E.get(`/appointments/availability/${e}?date=${r}&salonId=${a}`)};const W=E;var H=n(60397);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(){var e=W.defaults.baseURL;e.endsWith("/api")||e.endsWith("/")}();var G=(0,s.createContext)(),q=function(e){var t=e.children,n=(0,s.useState)(!1),r=(0,o.default)(n,2),l=r[0],i=r[1],d=(0,s.useState)(null),u=(0,o.default)(d,2),c=u[0],f=u[1],m=(0,s.useState)(null),p=(0,o.default)(m,2),g=p[0],y=p[1],x=(0,s.useState)(null),j=(0,o.default)(x,2),b=j[0],C=j[1],v=function(){var e=(0,a.default)((function*(){try{console.log("Creating test user account..."),yield W.post("/users/register",{name:"Test User",email:"test@example.com",password:"password123",phone:"123-456-7890",role:"customer"}),console.log("Test user created or already exists")}catch(b){var e,t,n,r,a;if(400===(null==(e=b.response)?void 0:e.status)&&null!=(t=b.response)&&null!=(n=t.data)&&null!=(r=n.message)&&r.includes("already exists"))console.log("Test user already exists");else console.error("Error creating test user:",(null==(a=b.response)?void 0:a.data)||b.message)}}));return function(){return e.apply(this,arguments)}}(),S=function(){var e=(0,a.default)((function*(e,t){i(!0),C(null);try{console.log(`Attempting login with ${e}`);var n=(yield W.post("/users/login",{email:e,password:t})).data;if(console.log("Login response:",JSON.stringify(n)),n.success){var r=V(V({},n.user),{},{token:n.token||n.user.token});console.log("Setting user info with token:",r.token),y(r),f(r.token),yield h.default.setItem("userInfo",JSON.stringify(r)),yield h.default.setItem("userToken",r.token);var a=yield h.default.getItem("userInfo"),o=yield h.default.getItem("userToken");console.log("Saved user info:",a?"Yes":"No"),console.log("Saved token:",o?"Yes":"No")}return i(!1),n}catch(b){var l,s,d,u,c;return console.error("Login error:",(null==(l=b.response)?void 0:l.data)||b.message),i(!1),C((null==(s=b.response)||null==(d=s.data)?void 0:d.message)||"An error occurred during login"),{success:!1,message:(null==(u=b.response)||null==(c=u.data)?void 0:c.message)||"Login failed"}}}));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=(0,a.default)((function*(e){i(!0),C(null);try{console.log(`Registering user: ${e.email}`);var t=(yield W.post("/users/register",e)).data;return console.log("Register response:",t),t.success&&(y(t.user),f(t.user.token),yield h.default.setItem("userInfo",JSON.stringify(t.user)),yield h.default.setItem("userToken",t.user.token)),i(!1),t}catch(b){var n,r,a,o,l;return console.error("Registration error:",(null==(n=b.response)?void 0:n.data)||b.message),i(!1),C((null==(r=b.response)||null==(a=r.data)?void 0:a.message)||"An error occurred during registration"),{success:!1,message:(null==(o=b.response)||null==(l=o.data)?void 0:l.message)||"Registration failed"}}}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,a.default)((function*(){try{console.log("=== LOGOUT STARTED ==="),i(!0);var e=["userInfo","userToken"];for(var t of(console.log("Clearing AsyncStorage keys:",e),e))yield h.default.removeItem(t),console.log(`Removed key: ${t}`);var n=yield h.default.getItem("userInfo"),r=yield h.default.getItem("userToken");return console.log("After removal - userInfo exists:",!!n),console.log("After removal - userToken exists:",!!r),console.log("Clearing React state..."),f(null),y(null),yield new Promise((function(e){return setTimeout(e,800)})),console.log("=== LOGOUT COMPLETED ==="),i(!1),{success:!0,message:"Logout successful"}}catch(b){return console.error("Logout error:",b),i(!1),f(null),y(null),{success:!1,message:"Error during logout, but state was cleared"}}}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,a.default)((function*(e){i(!0),C(null);try{var t=(yield W.put("/users/profile",e)).data;return t.success&&(y(t.user),yield h.default.setItem("userInfo",JSON.stringify(t.user))),i(!1),t}catch(b){var n,r,a,o,l;return console.error("Profile update error:",(null==(n=b.response)?void 0:n.data)||b.message),i(!1),C((null==(r=b.response)||null==(a=r.data)?void 0:a.message)||"An error occurred while updating profile"),{success:!1,message:(null==(o=b.response)||null==(l=o.data)?void 0:l.message)||"Profile update failed"}}}));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,a.default)((function*(){try{i(!0);var e=yield h.default.getItem("userInfo"),t=yield h.default.getItem("userToken");(e=JSON.parse(e))?(console.log("User is logged in:",e.name),f(t),y(e)):console.log("No user logged in"),i(!1)}catch(b){console.log("isLogged in error:",b),i(!1)}}));return function(){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){k(),v()}),[]),(0,H.jsx)(G.Provider,{value:{isLoading:l,userToken:c,userInfo:g,error:b,login:S,register:w,logout:T,updateProfile:B,createTestUser:v},children:t})},Y=x.default.create({container:{flex:1,backgroundColor:"#fff"},scrollView:{flexGrow:1,padding:20,justifyContent:"center"},header:{alignItems:"center",marginBottom:40},logo:{width:120,height:120,marginBottom:10},title:{fontSize:28,fontWeight:"bold",marginBottom:5,color:"#0F4C75"},subtitle:{fontSize:16,color:"#3282B8",textAlign:"center"},form:{width:"100%"},input:{marginBottom:15},button:{marginTop:10,paddingVertical:6},demoButton:{marginTop:10,paddingVertical:6,borderColor:"#3282B8"},registerContainer:{flexDirection:"row",justifyContent:"center",marginTop:20},registerText:{color:"#0F4C75",fontWeight:"bold"},snackbar:{backgroundColor:"#d32f2f"}});const J=function(e){var t=e.navigation,r=(0,s.useState)(""),l=(0,o.default)(r,2),d=l[0],u=l[1],c=(0,s.useState)(""),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)(""),g=(0,o.default)(p,2),y=g[0],x=g[1],D=(0,s.useState)(!1),F=(0,o.default)(D,2),P=F[0],A=F[1],I=(0,s.useContext)(G),E=I.login,O=I.isLoading,z=I.userToken;(0,s.useEffect)((function(){z&&t.reset({index:0,routes:[{name:"Main"}]})}),[z,t]);var $=function(){var e=(0,a.default)((function*(){if(!d||!m)return x("Please fill in all fields"),void A(!0);try{var e=yield E(d,m);e.success?console.log("Login successful, redirecting..."):(x(e.message),A(!0))}catch(t){console.error("Login error:",t),x("An unexpected error occurred. Please try again."),A(!0)}}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,a.default)((function*(){u("test@example.com"),h("password123"),setTimeout((0,a.default)((function*(){(yield E("test@example.com","password123")).success||S.default.alert("Demo Mode","Could not log in with test account. Creating a new account...",[{text:"OK"}])})),300)}));return function(){return e.apply(this,arguments)}}();return(0,H.jsx)(b.default,{behavior:"height",style:Y.container,children:(0,H.jsxs)(j.default,{contentContainerStyle:Y.scrollView,children:[(0,H.jsxs)(i.default,{style:Y.header,children:[(0,H.jsx)(v.default,{source:n(14082),style:Y.logo,resizeMode:"contain"}),(0,H.jsx)(w.default,{style:Y.title,children:"BarberBook"}),(0,H.jsx)(w.default,{style:Y.subtitle,children:"Book your next haircut with ease"})]}),(0,H.jsxs)(i.default,{style:Y.form,children:[(0,H.jsx)(T.default,{label:"Email",value:d,onChangeText:u,mode:"outlined",style:Y.input,keyboardType:"email-address",autoCapitalize:"none",testID:"email-input"}),(0,H.jsx)(T.default,{label:"Password",value:m,onChangeText:h,mode:"outlined",style:Y.input,secureTextEntry:!0,testID:"password-input"}),(0,H.jsx)(B.default,{mode:"contained",onPress:$,style:Y.button,loading:O,disabled:O,testID:"login-button",children:"Login"}),(0,H.jsx)(B.default,{mode:"outlined",onPress:R,style:Y.demoButton,disabled:O,children:"Demo Login"}),(0,H.jsxs)(i.default,{style:Y.registerContainer,children:[(0,H.jsx)(w.default,{children:"Don't have an account? "}),(0,H.jsx)(C.default,{onPress:function(){return t.navigate("Register")},children:(0,H.jsx)(w.default,{style:Y.registerText,children:"Register here"})})]})]}),(0,H.jsx)(k.default,{visible:P,onDismiss:function(){return A(!1)},duration:3e3,style:Y.snackbar,children:y})]})})};var Z=x.default.create({container:{flex:1,backgroundColor:"#fff"},scrollView:{flexGrow:1,padding:20},header:{alignItems:"center",marginVertical:30},title:{fontSize:28,fontWeight:"bold",marginBottom:5,color:"#0F4C75"},subtitle:{fontSize:16,color:"#3282B8",textAlign:"center"},form:{width:"100%"},input:{marginBottom:15},button:{marginTop:10,paddingVertical:6},loginContainer:{flexDirection:"row",justifyContent:"center",marginTop:20,marginBottom:30},loginText:{color:"#0F4C75",fontWeight:"bold"},snackbar:{backgroundColor:"#d32f2f"}});const K=function(e){var t=e.navigation,n=(0,s.useState)(""),r=(0,o.default)(n,2),l=r[0],d=r[1],u=(0,s.useState)(""),c=(0,o.default)(u,2),f=c[0],m=c[1],h=(0,s.useState)(""),p=(0,o.default)(h,2),g=p[0],y=p[1],x=(0,s.useState)(""),v=(0,o.default)(x,2),S=v[0],D=v[1],F=(0,s.useState)(""),P=(0,o.default)(F,2),A=P[0],I=P[1],E=(0,s.useState)(""),O=(0,o.default)(E,2),z=O[0],$=O[1],R=(0,s.useState)(!1),M=(0,o.default)(R,2),L=M[0],N=M[1],_=(0,s.useContext)(G),W=_.register,U=_.isLoading,V=function(){var e=(0,a.default)((function*(){if(!l||!f||!S||!A)return $("Please fill in all required fields"),void N(!0);if(S!==A)return $("Passwords do not match"),void N(!0);var e={name:l,email:f,password:S,phone:g},n=yield W(e);n.success?t.navigate("Login"):($(n.message),N(!0))}));return function(){return e.apply(this,arguments)}}();return(0,H.jsx)(b.default,{behavior:"height",style:Z.container,children:(0,H.jsxs)(j.default,{contentContainerStyle:Z.scrollView,children:[(0,H.jsxs)(i.default,{style:Z.header,children:[(0,H.jsx)(w.default,{style:Z.title,children:"Create Account"}),(0,H.jsx)(w.default,{style:Z.subtitle,children:"Sign up to book your appointment"})]}),(0,H.jsxs)(i.default,{style:Z.form,children:[(0,H.jsx)(T.default,{label:"Full Name",value:l,onChangeText:d,mode:"outlined",style:Z.input}),(0,H.jsx)(T.default,{label:"Email",value:f,onChangeText:m,mode:"outlined",style:Z.input,keyboardType:"email-address",autoCapitalize:"none"}),(0,H.jsx)(T.default,{label:"Phone (optional)",value:g,onChangeText:y,mode:"outlined",style:Z.input,keyboardType:"phone-pad"}),(0,H.jsx)(T.default,{label:"Password",value:S,onChangeText:D,mode:"outlined",style:Z.input,secureTextEntry:!0}),(0,H.jsx)(T.default,{label:"Confirm Password",value:A,onChangeText:I,mode:"outlined",style:Z.input,secureTextEntry:!0}),(0,H.jsx)(B.default,{mode:"contained",onPress:V,style:Z.button,loading:U,disabled:U,children:"Register"}),(0,H.jsxs)(i.default,{style:Z.loginContainer,children:[(0,H.jsx)(w.default,{children:"Already have an account? "}),(0,H.jsx)(C.default,{onPress:function(){return t.navigate("Login")},children:(0,H.jsx)(w.default,{style:Z.loginText,children:"Login"})})]})]}),(0,H.jsx)(k.default,{visible:L,onDismiss:function(){return N(!1)},duration:3e3,style:Z.snackbar,children:z})]})})};var X=n(12686),Q=n(26318),ee=n(29299),te=n(21055),ne=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{color:"#d32f2f",marginBottom:20,textAlign:"center"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,borderBottomLeftRadius:20,borderBottomRightRadius:20},greeting:{fontSize:24,fontWeight:"bold",color:"white"},subGreeting:{fontSize:16,color:"#BBE1FA",marginTop:5},section:{marginVertical:15,paddingHorizontal:15},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#1B262C"},seeAll:{color:"#3282B8",fontWeight:"bold"},card:{marginBottom:15,borderRadius:10,elevation:2},emptyCard:{marginBottom:15,borderRadius:10,elevation:2,alignItems:"center",padding:10},bookButton:{marginTop:10},horizontalCard:{width:220,marginRight:15,borderRadius:10,elevation:2},serviceImage:{height:120,borderTopLeftRadius:10,borderTopRightRadius:10},price:{fontWeight:"bold",color:"#0F4C75",marginTop:5},statusContainer:{marginTop:10,alignItems:"flex-start"},status:{paddingHorizontal:10,paddingVertical:3,borderRadius:20,color:"white",fontSize:12,fontWeight:"bold"}});const re=function(e){var t,n=e.navigation,r=(0,s.useState)([]),l=(0,o.default)(r,2),d=l[0],u=l[1],c=(0,s.useState)([]),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)(!0),g=(0,o.default)(p,2),y=g[0],x=g[1],b=(0,s.useState)(null),v=(0,o.default)(b,2),S=v[0],T=v[1],k=(0,s.useContext)(G).userInfo;return(0,s.useEffect)((function(){var e=function(){var e=(0,a.default)((function*(){try{x(!0),T(null);var e=(yield $()).data.services.slice(0,3),t=(yield R()).data.appointments.filter((function(e){return"confirmed"===e.status||"pending"===e.status})).sort((function(e,t){return new Date(e.date)-new Date(t.date)})).slice(0,2);u(e),h(t)}catch(S){console.error("Error fetching home data:",S),T("Failed to load data. Please try again later.")}finally{x(!1)}}));return function(){return e.apply(this,arguments)}}();e()}),[]),y?(0,H.jsx)(i.default,{style:ne.centered,children:(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"})}):S?(0,H.jsxs)(i.default,{style:ne.centered,children:[(0,H.jsx)(w.default,{style:ne.errorText,children:S}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return n.reset({index:0,routes:[{name:"Home"}]})},children:"Retry"})]}):(0,H.jsxs)(j.default,{style:ne.container,children:[(0,H.jsxs)(i.default,{style:ne.header,children:[(0,H.jsxs)(w.default,{style:ne.greeting,children:["Hello, ",(null==k||null==(t=k.name)?void 0:t.split(" ")[0])||"there","! \ud83d\udc4b"]}),(0,H.jsx)(w.default,{style:ne.subGreeting,children:"Ready for a fresh cut?"})]}),(0,H.jsxs)(i.default,{style:ne.section,children:[(0,H.jsxs)(i.default,{style:ne.sectionHeader,children:[(0,H.jsx)(w.default,{style:ne.sectionTitle,children:"Upcoming Appointments"}),(0,H.jsx)(C.default,{onPress:function(){return n.navigate("Appointments")},children:(0,H.jsx)(w.default,{style:ne.seeAll,children:"See All"})})]}),0===m.length?(0,H.jsx)(Q.default,{style:ne.emptyCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"You don't have any upcoming appointments."}),(0,H.jsx)(B.default,{mode:"contained",style:ne.bookButton,onPress:function(){return n.navigate("Services")},children:"Book Now"})]})}):m.map((function(e){return(0,H.jsx)(Q.default,{style:ne.card,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{children:e.service.name}),(0,H.jsxs)(ee.default,{children:["Date: ",new Date(e.date).toLocaleDateString()]}),(0,H.jsxs)(ee.default,{children:["Time: ",e.startTime," - ",e.endTime]}),(0,H.jsxs)(ee.default,{children:["Barber: ",e.barber.name]}),(0,H.jsx)(i.default,{style:ne.statusContainer,children:(0,H.jsx)(w.default,{style:[ne.status,{backgroundColor:"confirmed"===e.status?"#4CAF50":"pending"===e.status?"#FFC107":"#F44336"}],children:e.status.toUpperCase()})})]})},e._id)}))]}),(0,H.jsxs)(i.default,{style:ne.section,children:[(0,H.jsxs)(i.default,{style:ne.sectionHeader,children:[(0,H.jsx)(w.default,{style:ne.sectionTitle,children:"Our Services"}),(0,H.jsx)(C.default,{onPress:function(){return n.navigate("Services")},children:(0,H.jsx)(w.default,{style:ne.seeAll,children:"See All"})})]}),(0,H.jsx)(j.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:d.map((function(e){return(0,H.jsxs)(Q.default,{style:ne.horizontalCard,children:[(0,H.jsx)(Q.default.Cover,{source:{uri:e.image||"https://via.placeholder.com/150"},style:ne.serviceImage}),(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{children:e.name}),(0,H.jsx)(ee.default,{numberOfLines:2,children:e.description}),(0,H.jsxs)(ee.default,{style:ne.price,children:["$",e.price]})]}),(0,H.jsx)(Q.default.Actions,{children:(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return n.navigate("Booking",{service:e})},children:"Book"})})]},e._id)}))})]})]})};var ae=n(51218),oe=n(71225),le=n(802),se=n(49036),ie=[{_id:"1",name:"Classic Haircut",description:"Traditional haircut includes consultation, shampoo, condition, and style.",price:25,duration:30,image:"https://images.unsplash.com/photo-1589710751893-f9aa8656451d?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8Nnx8aGFpcmN1dHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",category:"haircut"},{_id:"2",name:"Beard Trim",description:"Professional beard grooming and shaping with razor detailing.",price:15,duration:20,image:"https://images.unsplash.com/photo-1621605810052-80936645a058?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8YmVhcmQlMjB0cmltfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",category:"beard"},{_id:"3",name:"Premium Package",description:"Haircut, beard trim, hot towel facial, and styling in one session.",price:45,duration:60,image:"https://images.unsplash.com/photo-1564222256577-45e728f2c611?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTB8fGJhcmJlcnxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",category:"combo"},{_id:"4",name:"Kids Haircut",description:"Gentle haircut service for children under 12 years old.",price:20,duration:25,image:"https://images.unsplash.com/photo-1626143508000-4b31a27e9c7a?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NXx8a2lkcyUyMGhhaXJjdXR8ZW58MHx8MHx8&auto=format&fit=crop&w=500&q=60",category:"haircut"},{_id:"5",name:"Hair Coloring",description:"Professional hair coloring service with premium products.",price:60,duration:90,image:"https://images.unsplash.com/photo-1619283651048-9ef01ec1da6e?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MjB8fGhhaXIlMjBjb2xvcnxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",category:"coloring"},{_id:"6",name:"Protein Treatment",description:"Deep protein treatment to strengthen and repair damaged hair.",price:85,duration:120,image:"https://images.unsplash.com/photo-1560869713-7d0a29430803?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTJ8fGhhaXIlMjB0cmVhdG1lbnR8ZW58MHx8MHx8&auto=format&fit=crop&w=500&q=60",category:"treatment"},{_id:"7",name:"Brushing/Blowout",description:"Professional blow dry and styling to achieve smooth, voluminous hair.",price:35,duration:30,image:"https://images.unsplash.com/photo-1595922648424-6b3b0b81d044?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8M3x8aGFpciUyMGRyeWluZ3xlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",category:"styling"},{_id:"8",name:"Haircut & Protein Combo",description:"Complete haircut with deep protein treatment for damaged hair. Full hair transformation.",price:100,duration:150,image:"https://images.unsplash.com/photo-1605497788044-5a32c7078486?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8NXx8aGFpciUyMHRyZWF0bWVudHxlbnwwfHwwfHw%3D&auto=format&fit=crop&w=500&q=60",category:"combo"},{_id:"9",name:"Cut & Style Combo",description:"Haircut followed by professional blow dry and styling for a complete new look.",price:55,duration:60,image:"https://images.unsplash.com/photo-1519735777090-ec97162dc266?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxzZWFyY2h8OHx8aGFpcmN1dCUyMGFuZCUyMHN0eWxlfGVufDB8fDB8fA%3D%3D&auto=format&fit=crop&w=500&q=60",category:"combo"}],de=[{id:"all",name:"All"},{id:"haircut",name:"Haircut"},{id:"beard",name:"Beard"},{id:"treatment",name:"Treatment"},{id:"styling",name:"Styling"},{id:"combo",name:"Combo"},{id:"coloring",name:"Coloring"}],ue=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,color:"white",fontWeight:"bold"},headerSubtitle:{fontSize:16,color:"#BBE1FA",marginTop:5},searchBar:{margin:15,borderRadius:10,elevation:2},categoriesContainer:{marginBottom:10},categoriesList:{paddingHorizontal:15},categoryChip:{marginRight:8,backgroundColor:"white"},selectedCategoryChip:{backgroundColor:"#0F4C75"},categoryChipText:{color:"#666"},selectedCategoryChipText:{color:"white"},servicesList:{padding:15,paddingTop:5},card:{marginBottom:15,borderRadius:10,elevation:3},cardImage:{height:150,borderTopLeftRadius:10,borderTopRightRadius:10},cardContent:{padding:15},cardTitle:{fontSize:18,fontWeight:"bold",marginBottom:5},cardDescription:{color:"#666",marginBottom:10},cardDetails:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:10},priceContainer:{flexDirection:"column"},price:{fontSize:18,fontWeight:"bold",color:"#0F4C75"},duration:{color:"#666",fontSize:12},bookButton:{borderRadius:5},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{fontSize:16,color:"#666",textAlign:"center"}});const ce=function(e){var t=e.navigation,n=(0,s.useState)([]),r=(0,o.default)(n,2),l=r[0],d=r[1],u=(0,s.useState)([]),c=(0,o.default)(u,2),f=c[0],m=c[1],h=(0,s.useState)(""),p=(0,o.default)(h,2),g=p[0],y=p[1],x=(0,s.useState)("all"),j=(0,o.default)(x,2),b=j[0],C=j[1],v=(0,s.useState)(!0),S=(0,o.default)(v,2),T=S[0],k=S[1],D=(0,s.useState)(null),F=(0,o.default)(D,2),P=F[0],A=F[1],I=(0,s.useState)(!1),E=(0,o.default)(I,2),O=E[0],z=E[1];(0,s.useEffect)((function(){R()}),[]);var R=function(){var e=(0,a.default)((function*(){try{k(!0),A(null),z(!1);var e=yield $();e.data.services.length>0?(d(e.data.services),m(e.data.services)):(console.log("No services found, using sample data"),d(ie),m(ie),z(!0))}catch(P){console.error("Error fetching services:",P),A("Failed to load services from server. Showing sample data instead."),d(ie),m(ie),z(!0)}finally{k(!1)}}));return function(){return e.apply(this,arguments)}}(),M=function(e,t){var n=l;e&&(n=n.filter((function(t){return t.name.toLowerCase().includes(e.toLowerCase())||t.description.toLowerCase().includes(e.toLowerCase())}))),"all"!==t&&(n=n.filter((function(e){return e.category===t}))),m(n)};return T?(0,H.jsx)(i.default,{style:ue.centered,children:(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"})}):(0,H.jsxs)(i.default,{style:ue.container,children:[(0,H.jsxs)(i.default,{style:ue.header,children:[(0,H.jsx)(w.default,{style:ue.headerTitle,children:"Our Services"}),(0,H.jsx)(w.default,{style:ue.headerSubtitle,children:"Choose from our premium services"})]}),(0,H.jsx)(oe.default,{placeholder:"Search services",onChangeText:function(e){y(e),M(e,b)},value:g,style:ue.searchBar}),(0,H.jsx)(i.default,{style:ue.categoriesContainer,children:(0,H.jsx)(ae.default,{horizontal:!0,data:de,renderItem:function(e){var t=e.item;return(0,H.jsx)(le.default,{selected:b===t.id,style:[ue.categoryChip,b===t.id&&ue.selectedCategoryChip],textStyle:[ue.categoryChipText,b===t.id&&ue.selectedCategoryChipText],onPress:function(){return e=t.id,C(e),void M(g,e);var e},children:t.name})},keyExtractor:function(e){return e.id},showsHorizontalScrollIndicator:!1,contentContainerStyle:ue.categoriesList})}),O&&(0,H.jsx)(se.default,{visible:!0,icon:"information",actions:[{label:"Retry",onPress:R}],children:'Showing demo services. Tap "Retry" to attempt loading from server.'}),P&&(0,H.jsx)(se.default,{visible:!0,icon:"alert",actions:[{label:"Retry",onPress:R}],children:P}),0===f.length?(0,H.jsx)(i.default,{style:ue.emptyContainer,children:(0,H.jsx)(w.default,{style:ue.emptyText,children:"No services match your search"})}):(0,H.jsx)(ae.default,{data:f,renderItem:function(e){var n=e.item;return(0,H.jsxs)(Q.default,{style:ue.card,onPress:function(){return t.navigate("Booking",{service:n})},children:[(0,H.jsx)(Q.default.Cover,{source:{uri:n.image||"https://via.placeholder.com/300x150?text=No+Image"},style:ue.cardImage}),(0,H.jsxs)(Q.default.Content,{style:ue.cardContent,children:[(0,H.jsx)(w.default,{style:ue.cardTitle,children:n.name}),(0,H.jsx)(w.default,{style:ue.cardDescription,numberOfLines:2,children:n.description}),(0,H.jsxs)(i.default,{style:ue.cardDetails,children:[(0,H.jsxs)(i.default,{style:ue.priceContainer,children:[(0,H.jsxs)(w.default,{style:ue.price,children:["$",n.price]}),(0,H.jsxs)(w.default,{style:ue.duration,children:[n.duration," min"]})]}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return t.navigate("Booking",{service:n})},style:ue.bookButton,children:"Book"})]})]})]})},keyExtractor:function(e){return e._id},contentContainerStyle:ue.servicesList})]})};var fe=n(40834),me=n(15558),he=n(59793),pe=n(63627),ge=n(34638),ye=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},serviceCard:{margin:15,elevation:2},serviceDetails:{flexDirection:"row",marginVertical:10},price:{fontWeight:"bold",marginRight:15},duration:{color:"#666"},progressContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingHorizontal:20,marginVertical:15},progressItem:{alignItems:"center"},progressDot:{width:30,height:30,borderRadius:15,backgroundColor:"#E0E0E0",justifyContent:"center",alignItems:"center",marginBottom:5},progressActive:{backgroundColor:"#0F4C75"},progressNumber:{color:"white",fontWeight:"bold"},progressLine:{flex:1,height:2,backgroundColor:"#E0E0E0",marginHorizontal:5},progressText:{fontSize:12,color:"#666"},section:{padding:15,marginBottom:10},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},sectionTitle:{fontSize:18,fontWeight:"bold",marginBottom:15},salonList:{marginTop:10},salonCard:{flexDirection:"row",backgroundColor:"white",padding:15,borderRadius:10,marginBottom:10,elevation:2,alignItems:"center"},selectedSalonCard:{backgroundColor:"#E1F5FE",borderWidth:1,borderColor:"#0F4C75"},salonIcon:{marginRight:10},salonInfo:{flex:1},salonName:{fontSize:16,fontWeight:"bold"},salonAddress:{fontSize:12,color:"#666",marginBottom:3},salonPhone:{fontSize:12,color:"#666"},selectedIndicator:{marginLeft:10},selectedChip:{backgroundColor:"#0F4C75"},barberScroll:{marginTop:10,paddingBottom:5},barberCard:{width:160,backgroundColor:"white",borderRadius:10,padding:15,marginRight:10,alignItems:"center",elevation:2},selectedBarberCard:{backgroundColor:"#E1F5FE",borderWidth:1,borderColor:"#0F4C75"},barberImage:{marginBottom:10},barberName:{fontWeight:"bold",textAlign:"center",marginBottom:5},availabilityContainer:{flexDirection:"row",alignItems:"center",marginVertical:5},availabilityDot:{width:8,height:8,borderRadius:4,marginRight:5},availabilityText:{fontSize:10,color:"#666"},specialties:{fontSize:10,color:"#666",textAlign:"center"},timeGrid:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginTop:10},timeCard:{width:"30%",backgroundColor:"white",padding:15,borderRadius:5,alignItems:"center",marginBottom:10,elevation:1},selectedTimeCard:{backgroundColor:"#0F4C75"},timeText:{color:"#333"},endTimeText:{color:"#666"},availableTimeCard:{backgroundColor:"#4CAF50"},unavailableTimeCard:{backgroundColor:"#F44336"},availableTimeText:{color:"white"},unavailableTimeText:{color:"white"},selectedTimeText:{color:"white",fontWeight:"bold"},noTimesText:{textAlign:"center",color:"#666",marginTop:20},summaryCard:{marginBottom:20},summaryRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:10},summaryLabel:{fontWeight:"bold"},summaryValue:{textAlign:"right"},divider:{backgroundColor:"#e0e0e0"},bookButton:{padding:10,marginTop:20,borderRadius:8,elevation:8,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.3,shadowRadius:4.65},errorContainer:{padding:10,backgroundColor:"#FFCCCC",borderWidth:1,borderColor:"#FF0000",borderRadius:5,marginBottom:10},errorText:{color:"#FF0000",fontWeight:"bold"},centeredContent:{flex:1,justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,color:"#666"},emptyContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},emptyText:{color:"#666",marginBottom:10},changeButton:{padding:10},debugContainer:{marginTop:10,padding:10,backgroundColor:"#E1F5FE",borderRadius:5},debugButton:{padding:10},weeklySchedule:{flexDirection:"row",justifyContent:"space-between",width:"90%",backgroundColor:"#f5f5f5",borderRadius:5,padding:5,marginTop:10},dayIndicator:{alignItems:"center",padding:2},dayText:{fontSize:10,fontWeight:"bold",color:"#666",marginBottom:3},dayDot:{width:10,height:10,borderRadius:5},emptySubText:{fontSize:14,color:"#888",textAlign:"center",marginTop:5,marginBottom:15},buttonContent:{height:60,paddingVertical:10}});const xe=function(e){var t=e.route,n=e.navigation,r=t.params.service,l=(0,s.useState)([]),d=(0,o.default)(l,2),u=d[0],c=d[1],f=(0,s.useState)(null),m=(0,o.default)(f,2),h=m[0],p=m[1],g=(0,s.useState)([]),y=(0,o.default)(g,2),x=y[0],b=y[1],v=(0,s.useState)(null),T=(0,o.default)(v,2),k=T[0],D=T[1],F=(0,s.useState)(""),P=(0,o.default)(F,2),A=P[0],I=P[1],E=(0,s.useState)(""),O=(0,o.default)(E,2),z=O[0],$=O[1],R=(0,s.useState)([]),M=(0,o.default)(R,2),L=M[0],N=M[1],U=(0,s.useState)([]),V=(0,o.default)(U,2),q=V[0],Y=V[1],J=(0,s.useState)(!0),Z=(0,o.default)(J,2),K=Z[0],ne=Z[1],re=(0,s.useState)(!1),ae=(0,o.default)(re,2),oe=ae[0],se=ae[1],ie=(0,s.useState)(null),de=(0,o.default)(ie,2),ue=de[0],ce=de[1],xe=(0,s.useState)(1),je=(0,o.default)(xe,2),be=je[0],Ce=je[1],ve=(0,s.useContext)(G).userInfo,Se=["09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30"],we=new Date;(0,ge.default)(we,"yyyy-MM-dd");(0,s.useEffect)((function(){Te()}),[]),(0,s.useEffect)((function(){h&&Be(h._id)}),[h]),(0,s.useEffect)((function(){if(k&&A)ke();else{var e=[].concat(Se);Y(e),N([])}}),[k,A]);var Te=function(){var e=(0,a.default)((function*(){try{ne(!0),ce(null);var e=yield W.get("/salons",{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}});if(!e.data||!e.data.success)throw new Error("Failed to fetch salons");c(e.data.salons),console.log(`Loaded ${e.data.salons.length} salons`),ne(!1)}catch(ue){console.error("Error fetching salons:",ue),ce("Failed to load salons. Please try again."),ne(!1),S.default.alert("Error","Failed to load salons. Please try again later.")}}));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=(0,a.default)((function*(e){try{ne(!0),ce(null),console.log(`Fetching barbers for salon ID: ${e}`);var t=yield W.get(`/salons/${e}`,{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}});if(!t.data||!t.data.success)throw new Error("Failed to fetch salon details");var n=t.data.salon;if(console.log(`Loaded salon: ${n.name}`),!n.staff||!Array.isArray(n.staff)||0===n.staff.length)return console.log("No staff array found in salon data or it is empty"),b([]),ce("No barbers available for this salon. Staff not assigned."),ne(!1),void Ce(2);var r=n.staff.map((function(e){return"object"===typeof e?e._id:e}));console.log(`Found ${n.staff.length} staff IDs`);var a=[];if(n.staff.every((function(e){return"object"===typeof e&&e.role})))console.log("Staff objects are populated with role data, using directly"),a=n.staff.filter((function(e){var t=(e.role||"").toLowerCase(),n="barber"===t||t.includes("barber")||"stylist"===t;return console.log(`Direct staff member check - ${e.name}: role=${e.role}, isBarber=${n}`),n}));else try{console.log("Using admin endpoint to fetch users");var o=yield W.get("/admin/users",{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}});if(!o.data||!o.data.success)throw new Error("Failed to fetch users");var l=o.data.users||[];console.log(`Fetched ${l.length} total users from admin endpoint`),a=l.filter((function(e){if(!r.includes(e._id))return!1;var t=(e.role||"").toLowerCase(),n="barber"===t||t.includes("barber")||"stylist"===t;return console.log(`Admin staff check - ${e.name}: role=${e.role}, isBarber=${n}`),n}))}catch(ue){console.error("Error fetching from admin endpoint:",ue);try{for(var s of(console.log("Trying direct staff ID lookup"),a=[],r))try{var i=yield W.get(`/admin/users/${s}`,{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}});if(i.data&&i.data.success){var d=i.data.user,u=(d.role||"").toLowerCase();("barber"===u||u.includes("barber")||"stylist"===u)&&(a.push(d),console.log(`Added staff member by ID: ${d.name}, role=${d.role}`))}}catch(c){console.log(`Error fetching staff ID ${s}:`,c)}}catch(f){console.error("Error with fallback approach:",f)}}console.log(`Found ${a.length} barbers for this salon`),a.length>0?(b(a),console.log(`Loaded ${a.length} barbers for salon ${n.name}`)):(b([]),ce("No barbers available for this salon. Staff exists but no barber roles found."),S.default.alert("No Barbers","This salon does not have any barbers assigned. Please select another salon or use the debug button to check staff roles.")),ne(!1),Ce(2)}catch(ue){console.error("Error fetching barbers by salon:",ue),ce("Failed to load barbers. Please try again."),S.default.alert("Error","Failed to load barbers: "+(ue.message||"Unknown error")),ne(!1),Ce(2)}}));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=(0,a.default)((function*(){if(k&&A)try{ne(!0);for(var e=[],t=new Date,n=new Date(A),r=n.getDate()===t.getDate()&&n.getMonth()===t.getMonth()&&n.getFullYear()===t.getFullYear(),a=t.getHours(),o=t.getMinutes(),l=9;l<=17;l++)for(var s of[0,30])if(!r||!(l<a||l===a&&s<=o)){var i=l.toString().padStart(2,"0"),d=s.toString().padStart(2,"0");e.push(`${i}:${d}`)}Y(e);try{console.log("Fetching availability for:",{barberId:k._id,date:A,salonId:h._id});var u=yield _(k._id,A,h._id);if(console.log("Availability response:",null==u?void 0:u.data),null!=u&&u.data&&u.data.success){Y(e);var c=u.data.availableTimes||[];console.log("Available times from API:",c);var f=c.filter((function(t){return e.includes(t)}));console.log("Filtered times:",f),N(f),(4===be&&0===f.length||z&&!f.includes(z))&&$(null)}else console.error("API error response or no response data:",null==u?void 0:u.data),console.log("Using fallback time slots due to API error"),Y(e),N(e)}catch(ue){console.error("Error fetching barber availability:",ue),console.log("Using fallback time slots due to error"),Y(e),N(e)}ne(!1)}catch(ue){console.error("Error in fetchAvailableTimes:",ue),ne(!1);for(var m=[],p=9;p<=17;p++)m.push(`${p}:00`),m.push(`${p}:30`);Y(m),N(m)}}));return function(){return e.apply(this,arguments)}}(),De=function(e){var t=e.split(":").map(Number),n=(0,o.default)(t,2);return function(e){var t=Math.floor(e),n=Math.round(60*(e-t));return`${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`}(n[0]+n[1]/60+r.duration/60)},Fe=function(e){var t=new Date(e.dateString),n=new Date;n.setHours(0,0,0,0),t<n?S.default.alert("Invalid Date","You cannot book appointments in the past. Please select today or a future date."):(I(e.dateString),Ce(4))},Pe=function(){var e=(0,a.default)((function*(){if(k&&A&&z&&h)try{var e;se(!0),console.log("Starting booking process...");var t=r.duration||30,a=z.split(":").map(Number),l=(0,o.default)(a,2),s=l[0],i=l[1],d=s,u=i+t;u>=60&&(d+=Math.floor(u/60),u%=60);var c=`${d.toString().padStart(2,"0")}:${u.toString().padStart(2,"0")}`,f={barberId:k._id,serviceId:r._id,salonId:h._id,date:A,startTime:z,endTime:c};console.log("Booking data:",f);var m,p=yield W.post("/appointments",f,{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}});if(se(!1),console.log("BOOKING SUCCESS! Response:",null==p?void 0:p.data),null==p||null==(e=p.data)||!e.success)throw new Error((null==p||null==(m=p.data)?void 0:m.message)||"Unknown booking error");console.log("BOOKING SUCCESS! Response:",null==p?void 0:p.data);setTimeout((function(){try{console.log("Navigating back to previous screen"),n.goBack(),setTimeout((function(){S.default.alert("Booking Confirmed!",`Your appointment with ${k.name} on ${(0,ge.default)(new Date(A),"MMMM d")} at ${z} has been booked successfully.`,[{text:"OK"}])}),100)}catch(e){console.error("Navigation error:",e),S.default.alert("Booking Confirmed!",`Your appointment with ${k.name} on ${(0,ge.default)(new Date(A),"MMMM d")} at ${z} has been booked successfully.`,[{text:"OK"}])}}),100)}catch(ue){console.error("Booking error:",ue),se(!1),S.default.alert("Error",ue.message||"Failed to book appointment. Please try again.")}else S.default.alert("Error","Please complete all booking details")}));return function(){return e.apply(this,arguments)}}(),Ae=function(){var e=(0,a.default)((function*(e){try{console.log(`Debug: Fetching detailed data for salon ${e}`);var t=(yield W.get(`/salons/${e}`,{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}})).data;console.log("Raw salon data:",JSON.stringify(t));var n=[],r="";t.salon&&t.salon.staff&&(console.log("Staff array length:",t.salon.staff.length),console.log("Staff array type:",typeof t.salon.staff),console.log("Staff array:",JSON.stringify(t.salon.staff)),n=t.salon.staff.map((function(e){return"object"===typeof e?e._id:e})),t.salon.staff.forEach((function(e,t){if(console.log(`Staff #${t}:`,JSON.stringify(e)),"object"===typeof e){var n=e.role||"unknown";r+=`${t+1}. ${e.name}: role=${n}\n`}else r+=`${t+1}. ID only: ${e}\n`})));try{var a=(yield W.get("/users",{headers:{Authorization:`Bearer ${null==ve?void 0:ve.token}`}})).data;if(a.success&&a.users){var o=a.users.filter((function(e){return n.includes(e._id)}));console.log(`Found ${o.length} staff members through user lookup`);var l=o.filter((function(e){var t=(e.role||"").toLowerCase(),n="barber"===t||t.includes("barber")||"stylist"===t;return console.log(`User ${e.name}, role=${e.role}, isBarber=${n}`),n}));console.log(`Found ${l.length} potential barbers`),o.forEach((function(e,t){var n=e.role||"unknown",a="barber"===n.toLowerCase()||n.toLowerCase().includes("barber")||"stylist"===n.toLowerCase();r+=`${t+1}. ${e.name}: role=${n} (${a?"Valid Barber":"Not a Barber"})\n`}))}}catch(s){console.error("Error fetching users for debug:",s),r+="(Error fetching user details)\n"}S.default.alert("Debug Info",`Salon: ${t.salon.name}\nStaff count: ${t.salon.staff?t.salon.staff.length:0}\n\nStaff:\n${r||"No staff details available"}`)}catch(i){console.error("Debug fetch error:",i),S.default.alert("Debug Error",i.toString())}}));return function(t){return e.apply(this,arguments)}}();return K&&0===u.length?(0,H.jsxs)(i.default,{style:ye.centered,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:10},children:"Loading salons..."})]}):(0,H.jsxs)(j.default,{style:ye.container,children:[(0,H.jsx)(i.default,{style:ye.header,children:(0,H.jsx)(w.default,{style:ye.headerTitle,children:"Book Appointment"})}),(0,H.jsx)(Q.default,{style:ye.serviceCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{children:r.name}),(0,H.jsxs)(i.default,{style:ye.serviceDetails,children:[(0,H.jsxs)(ee.default,{style:ye.price,children:["$",r.price]}),(0,H.jsxs)(ee.default,{style:ye.duration,children:[r.duration," min"]})]}),(0,H.jsx)(ee.default,{children:r.description})]})}),(0,H.jsxs)(i.default,{style:ye.progressContainer,children:[(0,H.jsxs)(i.default,{style:ye.progressItem,children:[(0,H.jsx)(i.default,{style:[ye.progressDot,be>=1?ye.progressActive:null],children:(0,H.jsx)(w.default,{style:ye.progressNumber,children:"1"})}),(0,H.jsx)(w.default,{style:ye.progressText,children:"Salon"})]}),(0,H.jsx)(i.default,{style:ye.progressLine}),(0,H.jsxs)(i.default,{style:ye.progressItem,children:[(0,H.jsx)(i.default,{style:[ye.progressDot,be>=2?ye.progressActive:null],children:(0,H.jsx)(w.default,{style:ye.progressNumber,children:"2"})}),(0,H.jsx)(w.default,{style:ye.progressText,children:"Barber"})]}),(0,H.jsx)(i.default,{style:ye.progressLine}),(0,H.jsxs)(i.default,{style:ye.progressItem,children:[(0,H.jsx)(i.default,{style:[ye.progressDot,be>=3?ye.progressActive:null],children:(0,H.jsx)(w.default,{style:ye.progressNumber,children:"3"})}),(0,H.jsx)(w.default,{style:ye.progressText,children:"Date"})]}),(0,H.jsx)(i.default,{style:ye.progressLine}),(0,H.jsxs)(i.default,{style:ye.progressItem,children:[(0,H.jsx)(i.default,{style:[ye.progressDot,be>=4?ye.progressActive:null],children:(0,H.jsx)(w.default,{style:ye.progressNumber,children:"4"})}),(0,H.jsx)(w.default,{style:ye.progressText,children:"Time"})]})]}),1===be&&(0,H.jsxs)(i.default,{style:ye.section,children:[(0,H.jsx)(w.default,{style:ye.sectionTitle,children:"Select Salon"}),0!==u.length||K?(0,H.jsx)(i.default,{style:ye.salonList,children:u.map((function(e){return(0,H.jsxs)(C.default,{style:[ye.salonCard,h&&h._id===e._id?ye.selectedSalonCard:null],onPress:function(){return function(e){p(e),D(null),I(""),$("")}(e)},children:[(0,H.jsx)(fe.default,{size:60,icon:"store",backgroundColor:"#0F4C75",style:ye.salonIcon}),(0,H.jsxs)(i.default,{style:ye.salonInfo,children:[(0,H.jsx)(te.default,{style:ye.salonName,children:e.name}),(0,H.jsx)(ee.default,{style:ye.salonAddress,children:e.address&&e.address.street?(0,H.jsxs)(w.default,{children:[e.address.street,", ",e.address.city]}):(0,H.jsx)(w.default,{children:"Address not available"})}),(0,H.jsx)(ee.default,{style:ye.salonPhone,children:(0,H.jsx)(w.default,{children:e.phone||"Phone not available"})})]}),h&&h._id===e._id&&(0,H.jsx)(i.default,{style:ye.selectedIndicator,children:(0,H.jsx)(le.default,{mode:"flat",style:ye.selectedChip,children:"Selected"})})]},e._id)}))}):(0,H.jsx)(i.default,{style:ye.emptyContainer,children:(0,H.jsx)(w.default,{style:ye.emptyText,children:"No salons available."})}),(0,H.jsx)(i.default,{style:ye.debugContainer,children:(0,H.jsx)(B.default,{mode:"outlined",style:ye.debugButton,onPress:function(){if(u&&u.length>0){var e=u[0]._id;Ae(e)}else S.default.alert("Debug Info","No salons to debug")},children:"Debug Salon Data"})})]}),2===be&&(0,H.jsxs)(i.default,{style:ye.section,children:[(0,H.jsxs)(i.default,{style:ye.sectionHeader,children:[(0,H.jsx)(w.default,{style:ye.sectionTitle,children:"Select Barber"}),(0,H.jsx)(B.default,{mode:"outlined",onPress:function(){return Ce(1)},compact:!0,children:"Change Salon"})]}),ue?(0,H.jsx)(i.default,{style:ye.errorContainer,children:(0,H.jsx)(w.default,{style:ye.errorText,children:ue})}):K?(0,H.jsxs)(i.default,{style:ye.centeredContent,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:ye.loadingText,children:"Loading barbers..."})]}):0===x.length?(0,H.jsxs)(i.default,{style:ye.emptyContainer,children:[(0,H.jsx)(w.default,{style:ye.emptyText,children:"No barbers available for this salon."}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return Ce(1)},style:ye.changeButton,children:"Select Different Salon"})]}):(0,H.jsx)(j.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,style:ye.barberScroll,children:x.map((function(e){for(var t=e.workSchedule&&e.workSchedule.length>0,n=(new Date).getDay(),r=t&&e.workSchedule.some((function(e){return e.day===n&&e.isWorking})),a=[],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=function(n){var r=t&&e.workSchedule.some((function(e){return e.day===n&&e.isWorking}));a.push({day:o[n],isWorking:r})},s=0;s<7;s++)l(s);return(0,H.jsxs)(C.default,{style:[ye.barberCard,k&&k._id===e._id?ye.selectedBarberCard:null],onPress:function(){return function(e){D(e),Ce(3)}(e)},children:[(0,H.jsx)(me.default,{size:70,source:{uri:e.profileImage||"https://via.placeholder.com/70"},style:ye.barberImage}),(0,H.jsx)(w.default,{style:ye.barberName,children:e.name}),(0,H.jsxs)(i.default,{style:ye.availabilityContainer,children:[(0,H.jsx)(i.default,{style:[ye.availabilityDot,{backgroundColor:r?"#4CAF50":"#F44336"}]}),(0,H.jsx)(w.default,{style:ye.availabilityText,children:r?"Available Today":"Unavailable Today"})]}),(0,H.jsx)(i.default,{style:ye.weeklySchedule,children:a.map((function(e,t){return(0,H.jsxs)(i.default,{style:ye.dayIndicator,children:[(0,H.jsx)(w.default,{style:ye.dayText,children:e.day}),(0,H.jsx)(i.default,{style:[ye.dayDot,{backgroundColor:e.isWorking?"#4CAF50":"#F44336"}]})]},t)}))}),e.specialties&&e.specialties.length>0&&(0,H.jsx)(w.default,{style:ye.specialties,numberOfLines:1,children:e.specialties.slice(0,2).join(", ")})]},e._id)}))})]}),3===be&&function(){var e=(new Date).toISOString().split("T")[0],t={};return A&&(t[A]={selected:!0,selectedColor:"#0F4C75"}),(0,H.jsxs)(i.default,{style:ye.section,children:[(0,H.jsxs)(i.default,{style:ye.sectionHeader,children:[(0,H.jsx)(w.default,{style:ye.sectionTitle,children:"Select Date"}),(0,H.jsx)(B.default,{mode:"outlined",onPress:function(){return Ce(2)},compact:!0,children:"Change Barber"})]}),(0,H.jsx)(pe.Calendar,{current:e,minDate:e,onDayPress:Fe,markedDates:t,theme:{selectedDayBackgroundColor:"#0F4C75",todayTextColor:"#0F4C75",arrowColor:"#0F4C75"}})]})}(),4===be&&(0,H.jsxs)(i.default,{style:ye.section,children:[(0,H.jsxs)(i.default,{style:ye.sectionHeader,children:[(0,H.jsx)(w.default,{style:ye.sectionTitle,children:"Select Time"}),(0,H.jsx)(B.default,{mode:"outlined",onPress:function(){return Ce(3)},compact:!0,children:"Change Date"})]}),K?(0,H.jsxs)(i.default,{style:ye.centeredContent,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:ye.loadingText,children:"Loading available times..."})]}):0===L.length?(0,H.jsxs)(i.default,{style:ye.emptyContainer,children:[(0,H.jsx)(w.default,{style:ye.emptyText,children:"No available time slots for this date."}),(0,H.jsx)(w.default,{style:ye.emptySubText,children:"Try selecting a different date or barber."}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){var e=[].concat(Se);Y(e),N(e)},style:ye.changeButton,children:"Force Show All Time Slots"}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return Ce(3)},style:[ye.changeButton,{marginTop:10}],children:"Select Different Date"})]}):(0,H.jsx)(i.default,{style:ye.timeGrid,children:q.map((function(e){var t=L.includes(e);return(0,H.jsxs)(C.default,{style:[ye.timeCard,t?ye.availableTimeCard:ye.unavailableTimeCard,z===e?ye.selectedTimeCard:null],onPress:function(){return t&&function(e){$(e)}(e)},disabled:!t,children:[(0,H.jsx)(w.default,{style:[ye.timeText,t?ye.availableTimeText:ye.unavailableTimeText,z===e?ye.selectedTimeText:null],children:e}),(0,H.jsx)(w.default,{style:ye.endTimeText,children:t?`- ${De(e)}`:"(Booked)"})]},e)}))})]}),h&&k&&A&&z&&(0,H.jsxs)(i.default,{style:ye.section,children:[(0,H.jsx)(w.default,{style:ye.sectionTitle,children:"Booking Summary"}),(0,H.jsx)(Q.default,{style:ye.summaryCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Salon:"}),(0,H.jsx)(w.default,{style:ye.summaryValue,children:h.name})]}),(0,H.jsx)(he.default,{style:ye.divider}),(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Service:"}),(0,H.jsx)(w.default,{style:ye.summaryValue,children:r.name})]}),(0,H.jsx)(he.default,{style:ye.divider}),(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Barber:"}),(0,H.jsx)(w.default,{style:ye.summaryValue,children:k.name})]}),(0,H.jsx)(he.default,{style:ye.divider}),(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Date:"}),(0,H.jsx)(w.default,{style:ye.summaryValue,children:(0,ge.default)(new Date(A),"MMMM d, yyyy")})]}),(0,H.jsx)(he.default,{style:ye.divider}),(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Time:"}),(0,H.jsxs)(w.default,{style:ye.summaryValue,children:[z," - ",De(z)]})]}),(0,H.jsx)(he.default,{style:ye.divider}),(0,H.jsxs)(i.default,{style:ye.summaryRow,children:[(0,H.jsx)(w.default,{style:ye.summaryLabel,children:"Price:"}),(0,H.jsxs)(w.default,{style:ye.summaryValue,children:["$",r.price]})]})]})}),(0,H.jsx)(B.default,{mode:"contained",style:[ye.bookButton,{backgroundColor:"#3F51B5",height:65,margin:20,borderRadius:10,elevation:10}],contentStyle:{height:65},loading:oe,disabled:oe,labelStyle:{fontSize:18,fontWeight:"bold",color:"white"},onPress:Pe,children:"CONFIRM APPOINTMENT"})]})]})};var je=n(82660),be=n(16773),Ce=n(26062),ve=n(42490),Se=n(27339);function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Be=[{_id:"1",service:{_id:"101",name:"Classic Haircut",price:25,duration:30},barber:{_id:"201",name:"John Barber"},date:new Date(Date.now()+1728e5).toISOString(),startTime:"10:00",endTime:"10:30",status:"confirmed"},{_id:"2",service:{_id:"102",name:"Beard Trim",price:15,duration:20},barber:{_id:"202",name:"Mike Scissors"},date:new Date(Date.now()+432e6).toISOString(),startTime:"14:00",endTime:"14:20",status:"pending"},{_id:"3",service:{_id:"103",name:"Premium Package",price:45,duration:60},barber:{_id:"203",name:"Sarah Style"},date:new Date(Date.now()-2592e5).toISOString(),startTime:"11:00",endTime:"12:00",status:"completed"},{_id:"4",service:{_id:"104",name:"Hair Coloring",price:60,duration:90},barber:{_id:"204",name:"Alex Color"},date:new Date(Date.now()-6048e5).toISOString(),startTime:"09:00",endTime:"10:30",status:"cancelled"}],ke=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},errorText:{color:"#d32f2f",marginBottom:20,textAlign:"center"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,color:"white",fontWeight:"bold"},tabContainer:{flexDirection:"row",justifyContent:"space-around",padding:10,backgroundColor:"white"},tabButton:{flex:1,margin:5},appointmentsList:{padding:15,paddingBottom:80},card:{marginBottom:15,borderRadius:10,elevation:3},pastCard:{opacity:.8},row:{flexDirection:"row",justifyContent:"space-between",marginVertical:5},label:{fontWeight:"bold",color:"#666"},statusContainer:{marginTop:10,marginBottom:15,alignItems:"flex-start"},cancelButton:{marginTop:15,borderColor:"#F44336",backgroundColor:"#F44336",padding:5,marginHorizontal:20},emptyContainer:{padding:20,alignItems:"center"},emptyText:{fontSize:16,color:"gray",marginBottom:20,textAlign:"center"},bookButton:{marginTop:10},fab:{position:"absolute",margin:16,right:0,bottom:0,backgroundColor:"#0F4C75"},dialogTitle:{fontSize:20,fontWeight:"bold",marginBottom:10},dialogText:{marginBottom:10},dialogSubText:{marginBottom:10},dialogButton:{marginRight:10},dialogConfirmButton:{marginLeft:10},input:{borderWidth:1,borderColor:"#ddd",borderRadius:5,padding:10,marginTop:5,minHeight:80},barberName:{fontWeight:"bold"},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},actionChip:{borderColor:"#F44336",backgroundColor:"white"},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:10},deleteButton:{borderColor:"#FF5722",backgroundColor:"white"}});const De=function(e){var t=e.navigation,n=(0,s.useState)([]),r=(0,o.default)(n,2),l=r[0],d=r[1],u=(0,s.useState)(!0),c=(0,o.default)(u,2),f=c[0],m=c[1],h=(0,s.useState)(!1),p=(0,o.default)(h,2),g=p[0],y=p[1],x=(0,s.useState)(null),j=(0,o.default)(x,2),b=j[0],C=j[1],v=(0,s.useState)("upcoming"),T=(0,o.default)(v,2),k=T[0],D=T[1],F=(0,s.useState)(!1),P=(0,o.default)(F,2),A=P[0],I=P[1],E=(0,s.useState)(""),O=(0,o.default)(E,2),z=O[0],$=O[1],M=(0,s.useState)(!1),_=(0,o.default)(M,2),W=_[0],U=_[1],V=(0,s.useState)(null),G=(0,o.default)(V,2),q=G[0],Y=G[1];(0,s.useEffect)((function(){return J(),t.addListener("focus",(function(){J()}))}),[t]);var J=function(){var e=(0,a.default)((function*(){try{m(!0),C(null),I(!1),console.log("Fetching appointments...");var e=yield R();e.data.appointments&&e.data.appointments.length>0?(console.log(`Received ${e.data.appointments.length} appointments from API`),e.data.appointments.forEach((function(e){console.log(`Appointment ${e._id}: status=${e.status}, date=${new Date(e.date).toDateString()}`)})),d(e.data.appointments)):(console.log("No appointments found or empty response, using sample data"),d(Be),I(!0)),m(!1)}catch(b){console.error("Error fetching appointments:",b),C("Failed to load appointments from server. Showing sample data instead."),d(Be),I(!0),m(!1)}}));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=(0,a.default)((function*(){y(!0),yield J(),y(!1)}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,a.default)((function*(e,t){try{if(m(!0),console.log(`Cancelling appointment ${e} with reason: ${t||"No reason provided"}`),A){console.log("Using sample data, updating locally");var n=l.map((function(n){return n._id===e?Te(Te({},n),{},{status:"cancelled",cancellationReason:t}):n}));return d(n),m(!1),void S.default.alert("Success","Appointment cancelled successfully")}console.log("Sending cancellation request with reason:",t);var r,a=yield L(e,{cancellationReason:t});if(console.log("Cancel appointment response:",a.data),a.data&&a.data.success)S.default.alert("Success","Appointment cancelled successfully"),yield J();else console.error("Failed to cancel appointment:",a.data),S.default.alert("Error",(null==(r=a.data)?void 0:r.message)||"Failed to cancel appointment"),m(!1)}catch(b){var o,s;console.error("Error cancelling appointment:",b),S.default.alert("Error",(null==(o=b.response)||null==(s=o.data)?void 0:s.message)||"Failed to cancel appointment. Please try again."),m(!1)}}));return function(t,n){return e.apply(this,arguments)}}(),ee=function(){var e=(0,a.default)((function*(e){try{if(m(!0),console.log(`Deleting appointment ${e}`),A){console.log("Using sample data, updating locally");var t=l.filter((function(t){return t._id!==e}));return d(t),m(!1),void S.default.alert("Success","Appointment deleted successfully")}console.log("Sending delete request");var n,r=yield N(e);if(console.log("Delete appointment response:",r.data),r.data&&r.data.success)S.default.alert("Success","Appointment deleted successfully"),yield J();else console.error("Failed to delete appointment:",r.data),S.default.alert("Error",(null==(n=r.data)?void 0:n.message)||"Failed to delete appointment"),m(!1)}catch(b){var a,o;console.error("Error deleting appointment:",b),S.default.alert("Error",(null==(a=b.response)||null==(o=a.data)?void 0:o.message)||"Failed to delete appointment. Please try again."),m(!1)}}));return function(t){return e.apply(this,arguments)}}(),ne=l.filter((function(e){var t=new Date(e.date),n=new Date;return n.setHours(0,0,0,0),"upcoming"===k?t>=n||t.getDate()===n.getDate()&&"completed"!==e.status&&"cancelled"!==e.status:t<n||"completed"===e.status||"cancelled"===e.status})).sort((function(e,t){var n=new Date(e.date),r=new Date(t.date);return"upcoming"===k?n-r:r-n}));return f&&!g?(0,H.jsx)(i.default,{style:ke.centered,children:(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"})}):(0,H.jsxs)(i.default,{style:ke.container,children:[(0,H.jsx)(i.default,{style:ke.header,children:(0,H.jsx)(w.default,{style:ke.headerTitle,children:"My Appointments"})}),(0,H.jsxs)(i.default,{style:ke.tabContainer,children:[(0,H.jsx)(B.default,{mode:"upcoming"===k?"contained":"outlined",onPress:function(){return D("upcoming")},style:ke.tabButton,children:"Upcoming"}),(0,H.jsx)(B.default,{mode:"past"===k?"contained":"outlined",onPress:function(){return D("past")},style:ke.tabButton,children:"Past"})]}),(0,H.jsx)(he.default,{}),A&&(0,H.jsx)(se.default,{visible:!0,icon:"information",actions:[{label:"Retry",onPress:J}],children:'Showing demo appointments. Tap "Retry" to attempt loading from server.'}),b?(0,H.jsx)(se.default,{visible:!0,icon:"alert",actions:[{label:"Retry",onPress:J}],children:b}):(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(ae.default,{data:ne,renderItem:function(e){var t=e.item,n=new Date(t.date),r=new Date;r.setHours(0,0,0,0);var a=n<r||"completed"===t.status||"cancelled"===t.status,o=!a&&("confirmed"===t.status||"pending"===t.status);return console.log(`Appointment ${t._id}: date=${n.toDateString()}, status=${t.status}, isPast=${a}, canCancel=${o}`),(0,H.jsx)(Q.default,{style:[ke.card,a&&ke.pastCard],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:ke.headerRow,children:[(0,H.jsx)(te.default,{children:t.service.name}),o&&(0,H.jsx)(le.default,{mode:"outlined",style:ke.actionChip,textStyle:{color:"#F44336"},children:"Cancellable"})]}),(0,H.jsxs)(i.default,{style:ke.row,children:[(0,H.jsx)(w.default,{style:ke.label,children:"Date:"}),(0,H.jsx)(w.default,{children:(0,ge.default)(new Date(t.date),"MMMM d, yyyy")})]}),(0,H.jsxs)(i.default,{style:ke.row,children:[(0,H.jsx)(w.default,{style:ke.label,children:"Time:"}),(0,H.jsxs)(w.default,{children:[t.startTime," - ",t.endTime]})]}),(0,H.jsxs)(i.default,{style:ke.row,children:[(0,H.jsx)(w.default,{style:ke.label,children:"Barber:"}),(0,H.jsx)(w.default,{style:ke.barberName,children:t.barber.name})]}),(0,H.jsxs)(i.default,{style:ke.row,children:[(0,H.jsx)(w.default,{style:ke.label,children:"Price:"}),(0,H.jsxs)(w.default,{children:["$",t.service.price]})]}),(0,H.jsx)(i.default,{style:ke.statusContainer,children:(0,H.jsx)(le.default,{style:{backgroundColor:"confirmed"===t.status?"#4CAF50":"pending"===t.status?"#FFC107":"completed"===t.status?"#3282B8":"#F44336"},textStyle:{color:"white"},children:t.status.toUpperCase()})}),(0,H.jsxs)(i.default,{style:ke.buttonContainer,children:[o&&(0,H.jsx)(B.default,{mode:"contained",style:ke.cancelButton,icon:"close",color:"#F44336",onPress:function(){return function(e){var t=l.find((function(t){return t._id===e}));Y(e),U(!0),$(""),console.log(`Prompted cancellation for appointment ${e}`),t&&console.log(`Appointment details: ${t.service.name} on ${(0,ge.default)(new Date(t.date),"MMM d")}`)}(t._id)},children:"Cancel"}),(0,H.jsx)(B.default,{mode:"outlined",style:ke.deleteButton,icon:"delete",color:"#FF5722",onPress:function(){return function(e){var t=l.find((function(t){return t._id===e}));S.default.alert("Delete Appointment",`Are you sure you want to delete this appointment${t?` for ${t.service.name}`:""}?`,[{text:"Cancel",style:"cancel"},{text:"Delete",onPress:function(){return ee(e)},style:"destructive"}]),console.log(`Prompted deletion for appointment ${e}`)}(t._id)},children:"Delete"})]})]})})},keyExtractor:function(e){return e._id},contentContainerStyle:ke.appointmentsList,refreshControl:(0,H.jsx)(je.default,{refreshing:g,onRefresh:Z,colors:["#0F4C75"]}),ListEmptyComponent:(0,H.jsxs)(i.default,{style:ke.emptyContainer,children:[(0,H.jsx)(w.default,{style:ke.emptyText,children:"upcoming"===k?"You don't have any upcoming appointments":"You don't have any past appointments"}),"upcoming"===k&&(0,H.jsx)(B.default,{mode:"contained",style:ke.bookButton,onPress:function(){return t.navigate("Services")},children:"Book an Appointment"})]})}),"upcoming"===k&&(0,H.jsx)(Ce.default,{style:ke.fab,icon:"plus",label:"Book",onPress:function(){return t.navigate("Services")}})]}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Se.default,{visible:W,onDismiss:function(){return U(!1)},children:[(0,H.jsx)(Se.default.Title,{style:ke.dialogTitle,children:"Confirm Cancellation"}),(0,H.jsxs)(Se.default.Content,{children:[(0,H.jsx)(w.default,{style:ke.dialogText,children:"Are you sure you want to cancel this appointment? This action cannot be undone."}),(0,H.jsx)(w.default,{style:ke.dialogSubText,children:"Please provide a reason for cancelling (optional):"}),(0,H.jsx)(be.default,{style:ke.input,value:z,onChangeText:$,placeholder:"e.g., Schedule conflict, illness, etc.",multiline:!0})]}),(0,H.jsxs)(Se.default.Actions,{children:[(0,H.jsx)(B.default,{onPress:function(){return U(!1)},style:ke.dialogButton,children:"Go Back"}),(0,H.jsx)(B.default,{onPress:function(){U(!1),K(q,z)},mode:"contained",color:"#F44336",style:ke.dialogConfirmButton,children:"Confirm Cancellation"})]})]})})]})};var Fe=n(29698),Pe=n(22618),Ae=n(30336),Ie=n(91808),Ee=n(99599),Oe=n(61672);function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Re=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{alignItems:"center",padding:20,paddingTop:50,backgroundColor:"white"},avatar:{marginBottom:10},name:{fontSize:22,fontWeight:"bold",color:"#1B262C"},role:{fontSize:16,color:"#3282B8",marginBottom:10},editButton:{marginVertical:10,borderColor:"#0F4C75",borderWidth:1},adminButton:{marginTop:10,backgroundColor:"#0F4C75"},content:{padding:15},form:{marginVertical:10},input:{marginBottom:15,backgroundColor:"white"},buttonContainer:{flexDirection:"row",justifyContent:"space-between",marginTop:10},cancelButton:{flex:1,marginRight:10},saveButton:{flex:1,marginLeft:10},logoutButton:{marginVertical:30,borderColor:"#d32f2f",borderWidth:1},directLogoutButton:{marginVertical:30,borderColor:"#d32f2f",borderWidth:1,backgroundColor:"#d32f2f",padding:15,borderRadius:5,alignItems:"center"},logoutButtonText:{color:"white",fontWeight:"bold",fontSize:16},card:{marginTop:10},salonItem:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#eee"},salonInfo:{flex:1},salonName:{fontSize:16,fontWeight:"bold"},salonAddress:{fontSize:14,color:"#666",marginTop:3}});const Me=function(){var e=(0,s.useContext)(G),t=e.userInfo,n=e.updateProfile,r=e.logout,l=e.isLoading,d=(0,Oe.useNavigation)(),u=(0,s.useState)(!1),c=(0,o.default)(u,2),f=c[0],m=c[1],p=(0,s.useState)((null==t?void 0:t.name)||""),y=(0,o.default)(p,2),x=y[0],b=y[1],v=(0,s.useState)((null==t?void 0:t.email)||""),k=(0,o.default)(v,2),D=k[0],F=k[1],P=(0,s.useState)((null==t?void 0:t.phone)||""),A=(0,o.default)(P,2),I=A[0],E=A[1],O=(0,s.useState)(""),z=(0,o.default)(O,2),$=z[0],R=z[1],M=(0,s.useState)(""),L=(0,o.default)(M,2),N=L[0],_=L[1],U=(0,s.useState)(!0),V=(0,o.default)(U,2),q=V[0],Y=V[1],J=(0,s.useState)(!1),Z=(0,o.default)(J,2),K=(Z[0],Z[1],(0,s.useState)([])),ee=(0,o.default)(K,2),te=ee[0],ne=ee[1],re=(0,s.useState)(!1),ae=(0,o.default)(re,2),oe=ae[0],le=ae[1];(0,s.useEffect)((function(){!t||"manager"!==t.role&&"barber"!==t.role||se()}),[t]);var se=function(){var e=(0,a.default)((function*(){try{le(!0);var e="manager"===t.role?"/manager/salons":`/users/barber/${t._id}/salons`,n=yield W.get(e,{headers:{Authorization:`Bearer ${t.token}`}});n.data&&n.data.success?ne(n.data.salons||[]):console.error("Failed to load salons:",n.data),le(!1)}catch(r){console.error("Error fetching salons:",r),le(!1)}}));return function(){return e.apply(this,arguments)}}(),ie=function(){var e=(0,a.default)((function*(){if(x.trim())if($&&$!==N)S.default.alert("Error","Passwords do not match");else try{var e={name:x,phone:I};$&&(e.password=$);var t=yield n(e);t.success?(S.default.alert("Success","Profile updated successfully"),m(!1),R(""),_("")):S.default.alert("Error",t.message||"Failed to update profile")}catch(r){S.default.alert("Error","Something went wrong. Please try again."),console.error("Profile update error:",r)}else S.default.alert("Error","Please enter your name")}));return function(){return e.apply(this,arguments)}}();return t?(0,H.jsxs)(j.default,{style:Re.container,children:[(0,H.jsxs)(i.default,{style:Re.header,children:[(0,H.jsx)(me.default,{size:100,source:{uri:t.profileImage||"https://via.placeholder.com/100"},style:Re.avatar}),(0,H.jsx)(w.default,{style:Re.name,children:t.name}),(0,H.jsx)(w.default,{style:Re.role,children:t.role.charAt(0).toUpperCase()+t.role.slice(1)}),!f&&(0,H.jsx)(B.default,{mode:"outlined",style:Re.editButton,onPress:function(){return m(!0)},children:"Edit Profile"}),"admin"===t.role||"seif.ayadi.3.9.2@gmail.com"===t.email?(0,H.jsx)(B.default,{mode:"contained",style:Re.adminButton,onPress:function(){return d.navigate("AdminDashboard")},children:"Admin Dashboard"}):null,"manager"===t.role?(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(B.default,{mode:"contained",style:Re.adminButton,onPress:function(){return d.navigate("ManagerDashboard")},children:"Staff Dashboard"}),(0,H.jsx)(B.default,{mode:"contained",style:[Re.adminButton,{marginTop:10}],onPress:function(){return d.navigate("SalonDashboard")},children:"Salon Dashboard"})]}):null]}),(0,H.jsxs)(i.default,{style:Re.content,children:[f?(0,H.jsxs)(i.default,{style:Re.form,children:[(0,H.jsx)(T.default,{label:"Name",value:x,onChangeText:b,mode:"outlined",style:Re.input}),(0,H.jsx)(T.default,{label:"Email",value:D,onChangeText:F,mode:"outlined",style:Re.input,disabled:!0}),(0,H.jsx)(T.default,{label:"Phone",value:I,onChangeText:E,mode:"outlined",style:Re.input,keyboardType:"phone-pad"}),(0,H.jsx)(T.default,{label:"New Password (leave blank to keep current)",value:$,onChangeText:R,mode:"outlined",style:Re.input,secureTextEntry:!0}),(0,H.jsx)(T.default,{label:"Confirm New Password",value:N,onChangeText:_,mode:"outlined",style:Re.input,secureTextEntry:!0}),(0,H.jsxs)(i.default,{style:Re.buttonContainer,children:[(0,H.jsx)(B.default,{mode:"outlined",onPress:function(){m(!1),b(t.name),F(t.email),E(t.phone||""),R(""),_("")},style:Re.cancelButton,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:ie,loading:l,disabled:l,style:Re.saveButton,children:"Save"})]})]}):(0,H.jsx)(H.Fragment,{children:(0,H.jsxs)(Fe.default,{children:[(0,H.jsx)(Pe.default,{children:"Account Information"}),(0,H.jsx)(Ae.default,{title:"Email",description:t.email,left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"email"}))}}),(0,H.jsx)(Ae.default,{title:"Phone",description:t.phone||"Not provided",left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"phone"}))}}),(0,H.jsx)(he.default,{}),(0,H.jsx)(Pe.default,{children:"Preferences"}),(0,H.jsx)(Ae.default,{title:"Notifications",left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"bell"}))},right:function(){return(0,H.jsx)(Ee.default,{value:q,onValueChange:Y,color:"#0F4C75"})}}),(0,H.jsx)(he.default,{}),(0,H.jsx)(Pe.default,{children:"About"}),(0,H.jsx)(Ae.default,{title:"Terms of Service",left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"file-document"}))},onPress:function(){}}),(0,H.jsx)(Ae.default,{title:"Privacy Policy",left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"shield-account"}))},onPress:function(){}}),(0,H.jsx)(Ae.default,{title:"App Version",description:"1.0.0",left:function(e){return(0,H.jsx)(Ie.default,$e($e({},e),{},{icon:"information"}))}})]})}),t&&("manager"===t.role||"barber"===t.role)&&(0,H.jsxs)(Q.default,{style:Re.card,children:[(0,H.jsx)(Q.default.Title,{title:"Your Salons"}),(0,H.jsx)(Q.default.Content,{children:oe?(0,H.jsx)(X.default,{size:"small",color:"#0F4C75"}):te.length>0?(0,H.jsx)(i.default,{children:te.map((function(e){var t,n;return(0,H.jsxs)(C.default,{onPress:function(){return d.navigate("SalonDashboard",{salonId:e._id})},style:Re.salonItem,children:[(0,H.jsxs)(i.default,{style:Re.salonInfo,children:[(0,H.jsx)(w.default,{style:Re.salonName,children:e.name}),(0,H.jsxs)(w.default,{style:Re.salonAddress,children:[null==(t=e.address)?void 0:t.street,", ",null==(n=e.address)?void 0:n.city]})]}),(0,H.jsx)(g.default,{name:"chevron-forward",size:20,color:"#888"})]},e._id)}))}):(0,H.jsx)(w.default,{children:"No salons associated with your account"})})]}),(0,H.jsx)(C.default,{style:Re.directLogoutButton,activeOpacity:.6,onPress:function(){if(console.log("FORCE LOGOUT - no navigation approach"),h.default.clear(),"undefined"!==typeof window)return console.log("Reloading browser"),void window.location.reload();r&&r(),S.default.alert("Logout Complete","Please restart the app to complete logout",[{text:"OK"}])},children:(0,H.jsx)(w.default,{style:Re.logoutButtonText,children:"LOGOUT"})})]})]}):(0,H.jsx)(i.default,{style:Re.centered,children:(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"})})};var Le=n(33680),Ne=n(61906);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,color:"white",fontWeight:"bold"},tabContainer:{flexDirection:"row",justifyContent:"space-around",padding:10,backgroundColor:"white"},tabButton:{margin:5},appointmentsList:{padding:15,paddingBottom:80},card:{marginBottom:15,borderRadius:10,elevation:3},pastCard:{opacity:.8},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},row:{flexDirection:"row",justifyContent:"space-between",marginVertical:5},label:{fontWeight:"bold",color:"#666"},subText:{fontSize:12,color:"#888",fontStyle:"italic",marginTop:2},statusContainer:{marginTop:10,marginBottom:10,alignItems:"flex-start"},emptyContainer:{padding:20,alignItems:"center"},emptyText:{fontSize:16,color:"gray",marginBottom:20,textAlign:"center"},dialogText:{marginBottom:10},input:{borderWidth:1,borderColor:"#ddd",borderRadius:5,padding:10,marginTop:5,minHeight:80},menu:{position:"absolute",top:50,right:10},infoBox:{backgroundColor:"#f9f9f9",padding:10,borderRadius:5,marginTop:10},cancelButton:{marginTop:15,borderColor:"#F44336",borderWidth:1}});const Ue=function(e){var t=e.navigation,n=((0,s.useContext)(G).userInfo,(0,s.useState)([])),r=(0,o.default)(n,2),d=r[0],u=r[1],c=(0,s.useState)(!0),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)(!1),g=(0,o.default)(p,2),y=g[0],x=g[1],j=(0,s.useState)(null),b=(0,o.default)(j,2),C=b[0],v=b[1],T=(0,s.useState)("upcoming"),k=(0,o.default)(T,2),D=k[0],F=k[1],P=(0,s.useState)(!1),A=(0,o.default)(P,2),I=A[0],E=A[1],O=(0,s.useState)(""),z=(0,o.default)(O,2),$=z[0],_=z[1],W=(0,s.useState)(""),U=(0,o.default)(W,2),V=U[0],q=U[1],Y=(0,s.useState)(null),J=(0,o.default)(Y,2),Z=J[0],K=J[1],ee=(0,s.useState)({}),ne=(0,o.default)(ee,2),re=ne[0],oe=ne[1];(0,s.useEffect)((function(){return ie(),t.addListener("focus",(function(){ie()}))}),[t]);var ie=function(){var e=(0,a.default)((function*(){try{h(!0),v(null);var e=yield R();e.data.appointments&&e.data.appointments.length>0?u(e.data.appointments):u([]),h(!1)}catch(C){console.error("Error fetching appointments:",C),v("Failed to load appointments. Please try again."),h(!1)}}));return function(){return e.apply(this,arguments)}}(),de=function(){var e=(0,a.default)((function*(){x(!0),yield ie(),x(!1)}));return function(){return e.apply(this,arguments)}}(),ue=function(e,t){K(e),_(t),q(""),E(!0),oe({})},ce=function(){var e=(0,a.default)((function*(){if(Z){E(!1),h(!0);try{switch($){case"cancel":(yield L(Z._id,{cancellationReason:V})).data.success&&S.default.alert("Success","Appointment cancelled successfully");break;case"complete":(yield M(Z._id,{status:"completed",notes:V})).data.success&&S.default.alert("Success","Appointment marked as completed");break;case"noshow":(yield M(Z._id,{status:"no-show",notes:V})).data.success&&S.default.alert("Success","Appointment marked as no-show")}yield ie()}catch(C){var e,t;console.error("Error updating appointment:",C),S.default.alert("Error",(null==(e=C.response)||null==(t=e.data)?void 0:t.message)||"Failed to update appointment")}finally{h(!1)}}}));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=(0,a.default)((function*(e){try{h(!0),console.log(`Deleting appointment ${e}`);var t,n=yield N(e);if(console.log("Delete appointment response:",n.data),n.data&&n.data.success)S.default.alert("Success","Appointment deleted successfully"),yield ie();else console.error("Failed to delete appointment:",n.data),S.default.alert("Error",(null==(t=n.data)?void 0:t.message)||"Failed to delete appointment"),h(!1)}catch(C){var r,a;console.error("Error deleting appointment:",C),S.default.alert("Error",(null==(r=C.response)||null==(a=r.data)?void 0:a.message)||"Failed to delete appointment. Please try again."),h(!1)}}));return function(t){return e.apply(this,arguments)}}(),me=d.filter((function(e){var t=new Date(e.date),n=(new Date,new Date);n.setHours(0,0,0,0);var r=t.getDate(),a=t.getMonth(),o=t.getFullYear(),l=n.getDate(),s=n.getMonth(),i=n.getFullYear(),d=r===l&&a===s&&o===i,u="cancelled"===e.status,c="completed"===e.status,f="no-show"===e.status,m=!u&&!c&&!f,h=new Date(t);return h.setHours(0,0,0,0),"today"===D?d&&m:"upcoming"===D?h>n&&m:h<n||u||c||f})).sort((function(e,t){var n=new Date(e.date),r=new Date(t.date);if(n.toDateString()===r.toDateString()){var a=e.startTime.split(":").map(Number),l=(0,o.default)(a,2),s=l[0],i=l[1],d=t.startTime.split(":").map(Number),u=(0,o.default)(d,2);return 60*s+i-(60*u[0]+u[1])}return"past"===D?r-n:n-r}));return m&&!y?(0,H.jsx)(i.default,{style:He.centered,children:(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"})}):(0,H.jsxs)(i.default,{style:He.container,children:[(0,H.jsx)(i.default,{style:He.header,children:(0,H.jsx)(w.default,{style:He.headerTitle,children:"Appointments Management"})}),(0,H.jsxs)(i.default,{style:He.tabContainer,children:[(0,H.jsx)(B.default,{mode:"today"===D?"contained":"outlined",onPress:function(){return F("today")},style:[He.tabButton,{flex:1}],children:"Today"}),(0,H.jsx)(B.default,{mode:"upcoming"===D?"contained":"outlined",onPress:function(){return F("upcoming")},style:[He.tabButton,{flex:1}],children:"Upcoming"}),(0,H.jsx)(B.default,{mode:"past"===D?"contained":"outlined",onPress:function(){return F("past")},style:[He.tabButton,{flex:1}],children:"Past"})]}),(0,H.jsx)(he.default,{}),C?(0,H.jsx)(se.default,{visible:!0,icon:"alert",actions:[{label:"Retry",onPress:ie}],children:C}):(0,H.jsx)(ae.default,{data:me,renderItem:function(e){var t=e.item,n=new Date(t.date)<new Date||"completed"===t.status||"cancelled"===t.status||"no-show"===t.status,r=function(e){oe(We(We({},re),{},(0,l.default)({},e,!re[e])))};return(0,H.jsx)(Q.default,{style:[He.card,n&&He.pastCard],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:He.headerRow,children:[(0,H.jsx)(te.default,{children:t.service.name}),!n&&(0,H.jsxs)(i.default,{children:[(0,H.jsx)(Le.default,{icon:"dots-vertical",onPress:function(){return r(t._id)},size:24}),(0,H.jsxs)(Ne.default,{visible:re[t._id]||!1,onDismiss:function(){return r(t._id)},anchor:{x:200,y:0},style:He.menu,children:[(0,H.jsx)(Ne.default.Item,{onPress:function(){return ue(t,"complete")},title:"Mark as Complete",icon:"check"}),(0,H.jsx)(Ne.default.Item,{onPress:function(){return ue(t,"cancel")},title:"Cancel Appointment",icon:"close"}),(0,H.jsx)(Ne.default.Item,{onPress:function(){return ue(t,"noshow")},title:"Mark as No-Show",icon:"account-off"}),(0,H.jsx)(Ne.default.Item,{onPress:function(){return function(e){var t=d.find((function(t){return t._id===e}));S.default.alert("Delete Appointment",`Are you sure you want to delete this appointment${t?` for ${t.service.name}`:""}? This action cannot be undone.`,[{text:"Cancel",style:"cancel"},{text:"Delete",onPress:function(){return fe(e)},style:"destructive"}]),console.log(`Prompted deletion for appointment ${e}`)}(t._id)},title:"Delete Appointment",icon:"delete"})]})]})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Customer:"}),(0,H.jsx)(w.default,{children:t.customer.name})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Barber:"}),(0,H.jsx)(w.default,{children:t.barber.name})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Date:"}),(0,H.jsx)(w.default,{children:(0,ge.default)(new Date(t.date),"MMMM d, yyyy")})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Time:"}),(0,H.jsxs)(w.default,{children:[t.startTime," - ",t.endTime]})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Service:"}),(0,H.jsx)(w.default,{children:t.service.name})]}),(0,H.jsxs)(i.default,{style:He.row,children:[(0,H.jsx)(w.default,{style:He.label,children:"Price:"}),(0,H.jsxs)(w.default,{children:["$",t.service.price]})]}),(0,H.jsx)(i.default,{style:He.statusContainer,children:(0,H.jsx)(le.default,{style:{backgroundColor:"confirmed"===t.status?"#4CAF50":"pending"===t.status?"#FFC107":"completed"===t.status?"#3282B8":"no-show"===t.status?"#9C27B0":"#F44336"},textStyle:{color:"white"},children:t.status.toUpperCase()})}),t.cancellationReason&&(0,H.jsxs)(i.default,{style:He.infoBox,children:[(0,H.jsx)(w.default,{style:He.label,children:"Cancellation Reason:"}),(0,H.jsx)(w.default,{children:t.cancellationReason}),t.cancelledBy&&(0,H.jsxs)(w.default,{style:He.subText,children:["Cancelled by: ",t.cancelledBy]})]}),t.notes&&(0,H.jsxs)(i.default,{style:He.infoBox,children:[(0,H.jsx)(w.default,{style:He.label,children:"Notes:"}),(0,H.jsx)(w.default,{children:t.notes})]}),!n&&(0,H.jsx)(B.default,{mode:"outlined",style:He.cancelButton,icon:"close",onPress:function(){return ue(t,"cancel")},children:"Cancel Appointment"})]})})},keyExtractor:function(e){return e._id},contentContainerStyle:He.appointmentsList,refreshControl:(0,H.jsx)(je.default,{refreshing:y,onRefresh:de,colors:["#0F4C75"]}),ListEmptyComponent:(0,H.jsx)(i.default,{style:He.emptyContainer,children:(0,H.jsx)(w.default,{style:He.emptyText,children:"today"===D?"You don't have any appointments scheduled for today":"upcoming"===D?"You don't have any upcoming appointments":"You don't have any past appointments"})})}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Se.default,{visible:I,onDismiss:function(){return E(!1)},children:[(0,H.jsx)(Se.default.Title,{children:"cancel"===$?"Cancel Appointment":"complete"===$?"Complete Appointment":"Mark as No-Show"}),(0,H.jsxs)(Se.default.Content,{children:[(0,H.jsx)(w.default,{style:He.dialogText,children:"cancel"===$?"Please provide a reason for cancelling:":"complete"===$?"Add any notes about this appointment (optional):":"Add any notes about this no-show (optional):"}),(0,H.jsx)(be.default,{style:He.input,value:V,onChangeText:q,placeholder:"cancel"===$?"e.g., Customer requested cancellation":"complete"===$?"e.g., Service notes, products used":"e.g., Customer didn't show up, no call",multiline:!0})]}),(0,H.jsxs)(Se.default.Actions,{children:[(0,H.jsx)(B.default,{onPress:function(){return E(!1)},children:"Cancel"}),(0,H.jsx)(B.default,{onPress:ce,children:"Confirm"})]})]})})]})};var Ve=n(8615);function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},headerSubtitle:{fontSize:16,color:"#BBE1FA",marginTop:5},content:{flex:1},calendarContainer:qe({margin:10,backgroundColor:"white",borderRadius:10,overflow:"hidden"},void 0),scheduleContainer:qe({margin:10,marginTop:5,padding:15,backgroundColor:"white",borderRadius:10},void 0),scheduleTitle:{fontSize:18,fontWeight:"bold",marginBottom:15,color:"#1B262C"},scheduleGrid:{marginTop:5},timeSlot:{flexDirection:"row",marginBottom:10,height:80},currentTimeSlot:{borderLeftWidth:3,borderLeftColor:"#0F4C75"},timeColumn:{width:60,alignItems:"center",justifyContent:"center",backgroundColor:"#f0f0f0",borderRadius:5},timeText:{fontSize:12,fontWeight:"bold"},appointmentColumn:{flex:1,marginLeft:10,borderRadius:5,padding:10,justifyContent:"center"},appointmentCard:{padding:5},appointmentHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:5},customerName:{fontSize:14,fontWeight:"bold"},serviceText:{fontSize:12},priceText:{fontSize:12,fontWeight:"bold",marginTop:5},statusChip:{height:20,paddingHorizontal:5},statusChipText:{fontSize:8,color:"white"},emptySlot:{alignItems:"center",justifyContent:"center",height:"100%"},emptySlotText:{color:"#757575",fontStyle:"italic"},emptySchedule:{alignItems:"center",justifyContent:"center",padding:30},emptyText:{color:"#757575",textAlign:"center"},fab:{position:"absolute",margin:16,right:0,bottom:0,backgroundColor:"#0F4C75"},modalContent:{backgroundColor:"white",padding:20,margin:20,borderRadius:10},modalTitle:{textAlign:"center",marginBottom:15},appointmentDetails:{marginBottom:15},appointmentDetail:{marginBottom:5},detailLabel:{fontWeight:"bold"},divider:{marginVertical:10},actionButtons:{flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",marginVertical:10},actionButton:{width:"48%",padding:10,alignItems:"center",borderWidth:1,borderColor:"#0F4C75",borderRadius:5,marginBottom:10},actionButtonSelected:{backgroundColor:"#0F4C75"},actionButtonText:{color:"#0F4C75"},noteInput:{marginTop:10,marginBottom:20},modalActions:{flexDirection:"row",justifyContent:"space-between"},modalButton:{flex:1,marginHorizontal:5},timeSlotsContainer:{maxHeight:300,marginVertical:10},timeSlotButton:{padding:15,marginVertical:5,backgroundColor:"#f0f0f0",borderRadius:5,alignItems:"center"},selectedTimeSlot:{backgroundColor:"#BBE1FA",borderWidth:1,borderColor:"#0F4C75"},timeSlotButtonText:{fontSize:16},noSlotsText:{textAlign:"center",margin:20,color:"#757575"}});const Je=function(e){var t=e.navigation,n=(0,s.useContext)(G).userInfo,r=(0,s.useState)(!0),l=(0,o.default)(r,2),d=l[0],u=l[1],c=(0,s.useState)([]),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)((0,ge.default)(new Date,"yyyy-MM-dd")),g=(0,o.default)(p,2),y=g[0],x=g[1],b=(0,s.useState)({}),v=(0,o.default)(b,2),k=v[0],D=v[1],F=(0,s.useState)([]),P=(0,o.default)(F,2),A=P[0],I=P[1],E=(0,s.useState)(null),O=(0,o.default)(E,2),z=O[0],$=O[1],N=(0,s.useState)(!1),_=(0,o.default)(N,2),W=_[0],U=_[1],V=(0,s.useState)(""),q=(0,o.default)(V,2),Y=q[0],J=q[1],Z=(0,s.useState)(""),K=(0,o.default)(Z,2),Q=K[0],ee=K[1],ne=(0,s.useState)(!1),re=(0,o.default)(ne,2),ae=re[0],oe=re[1],se=(0,s.useState)([]),ie=(0,o.default)(se,2),de=ie[0],ue=ie[1],ce=(0,s.useState)(null),fe=(0,o.default)(ce,2),me=fe[0],ye=fe[1];(0,s.useEffect)((function(){return xe(),t.addListener("focus",xe)}),[t]),(0,s.useEffect)((function(){m.length>0&&(je(),be())}),[m,y]);var xe=function(){var e=(0,a.default)((function*(){try{u(!0);var e=yield R();e.data&&e.data.appointments?h(e.data.appointments):h([]),u(!1)}catch(t){console.error("Error fetching appointments:",t),u(!1),S.default.alert("Error","Failed to load appointments. Please try again.")}}));return function(){return e.apply(this,arguments)}}(),je=function(){var e={};m.forEach((function(t){var n=t.date.split("T")[0];e[n]?e[n].dots.push({color:Se(t.status)}):e[n]={marked:!0,dotColor:Se(t.status),dots:[{color:Se(t.status)}]}})),e[y]?e[y]=qe(qe({},e[y]),{},{selected:!0,selectedColor:"rgba(15, 76, 117, 0.2)"}):e[y]={selected:!0,selectedColor:"rgba(15, 76, 117, 0.2)"},D(e)},be=function(){var e=m.filter((function(e){return e.date.split("T")[0]===y}));e.sort((function(e,t){var n=e.startTime.split(":").map(Number),r=(0,o.default)(n,2),a=r[0],l=r[1],s=t.startTime.split(":").map(Number),i=(0,o.default)(s,2);return 60*a+l-(60*i[0]+i[1])}));for(var t=[],n=9;n<18;n++){var r=function(){var r=`${n.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`,o=30===a?0:30,l=`${(30===a?n+1:n).toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`,s=e.find((function(e){return e.startTime===r}));t.push({time:r,endTime:l,appointment:s||null,status:s?s.status:"free"})};for(var a of[0,30])r()}I(t),ue(t.filter((function(e){return"free"===e.status})).map((function(e){return{startTime:e.time,endTime:e.endTime}})))},Se=function(e){switch(e){case"confirmed":return"#4CAF50";case"pending":return"#FFC107";case"completed":return"#3282B8";case"cancelled":return"#F44336";case"no-show":return"#9C27B0";default:return"#757575"}},we=function(e){J(e)},Te=function(){var e=(0,a.default)((function*(){if(z&&Y)try{var e;switch(u(!0),U(!1),Y){case"complete":(e=yield M(z._id,{status:"completed",notes:Q})).data&&e.data.success&&S.default.alert("Success","Appointment marked as completed");break;case"cancel":(e=yield L(z._id,{cancellationReason:Q})).data&&e.data.success&&S.default.alert("Success","Appointment cancelled successfully");break;case"noshow":(e=yield M(z._id,{status:"no-show",notes:Q})).data&&e.data.success&&S.default.alert("Success","Appointment marked as no-show");break;case"swap":return oe(!0),void U(!1)}yield xe(),u(!1)}catch(r){var t,n;console.error("Error updating appointment:",r),u(!1),S.default.alert("Error",(null==(t=r.response)||null==(n=t.data)?void 0:n.message)||"Failed to update appointment")}}));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=(0,a.default)((function*(){if(z&&me)try{u(!0),oe(!1);var e=yield M(z._id,{startTime:me.startTime,endTime:me.endTime,notes:`Time changed from ${z.startTime}-${z.endTime} to ${me.startTime}-${me.endTime}`});e.data&&e.data.success?(S.default.alert("Success","Appointment time updated successfully"),yield xe()):S.default.alert("Error","Failed to update appointment time"),ye(null),u(!1)}catch(r){var t,n;console.error("Error updating appointment time:",r),u(!1),S.default.alert("Error",(null==(t=r.response)||null==(n=t.data)?void 0:n.message)||"Failed to update appointment time")}}));return function(){return e.apply(this,arguments)}}(),ke=function(e,t){return(0,H.jsxs)(i.default,{style:[Ye.timeSlot,function(){var t=new Date,n=(0,ge.default)(t,"yyyy-MM-dd");if(y!==n)return!1;var r=t.getHours(),a=t.getMinutes(),l=e.time.split(":").map(Number),s=(0,o.default)(l,2),i=s[0],d=s[1],u=e.endTime.split(":").map(Number),c=(0,o.default)(u,2),f=c[0],m=c[1];return(r>i||r===i&&a>=d)&&(r<f||r===f&&a<m)}()&&Ye.currentTimeSlot],children:[(0,H.jsx)(i.default,{style:Ye.timeColumn,children:(0,H.jsx)(w.default,{style:Ye.timeText,children:e.time})}),(0,H.jsx)(i.default,{style:[Ye.appointmentColumn,{backgroundColor:e.appointment?Se(e.appointment.status)+"30":"transparent"}],children:e.appointment?(0,H.jsxs)(C.default,{style:Ye.appointmentCard,onPress:function(){return t=e.appointment,$(t),U(!0),J(""),void ee("");var t},children:[(0,H.jsxs)(i.default,{style:Ye.appointmentHeader,children:[(0,H.jsx)(w.default,{style:Ye.customerName,children:e.appointment.customer.name}),(0,H.jsx)(le.default,{style:[Ye.statusChip,{backgroundColor:Se(e.appointment.status)}],textStyle:Ye.statusChipText,children:e.appointment.status.toUpperCase()})]}),(0,H.jsx)(w.default,{style:Ye.serviceText,children:e.appointment.service.name}),(0,H.jsxs)(w.default,{style:Ye.priceText,children:["$",e.appointment.service.price]})]}):(0,H.jsx)(i.default,{style:Ye.emptySlot,children:(0,H.jsx)(w.default,{style:Ye.emptySlotText,children:"Free"})})})]},t)};return d&&0===m.length?(0,H.jsxs)(i.default,{style:Ye.centered,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading your schedule..."})]}):(0,H.jsxs)(i.default,{style:Ye.container,children:[(0,H.jsxs)(i.default,{style:Ye.header,children:[(0,H.jsx)(w.default,{style:Ye.headerTitle,children:"Barber Dashboard"}),(0,H.jsxs)(w.default,{style:Ye.headerSubtitle,children:["Welcome, ",null==n?void 0:n.name]})]}),(0,H.jsxs)(j.default,{style:Ye.content,children:[(0,H.jsx)(i.default,{style:Ye.calendarContainer,children:(0,H.jsx)(pe.Calendar,{markingType:"multi-dot",markedDates:k,onDayPress:function(e){x(e.dateString)},theme:{todayTextColor:"#0F4C75",arrowColor:"#0F4C75"}})}),(0,H.jsxs)(i.default,{style:Ye.scheduleContainer,children:[(0,H.jsxs)(w.default,{style:Ye.scheduleTitle,children:["Schedule for ",(0,ge.default)(new Date(y),"MMMM d, yyyy")]}),A.length>0?(0,H.jsx)(i.default,{style:Ye.scheduleGrid,children:A.map((function(e,t){return ke(e,t)}))}):(0,H.jsx)(i.default,{style:Ye.emptySchedule,children:(0,H.jsx)(w.default,{style:Ye.emptyText,children:"No appointments scheduled for this day."})})]})]}),(0,H.jsx)(Ce.default,{style:Ye.fab,icon:"refresh",onPress:xe}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:W,onDismiss:function(){return U(!1)},contentContainerStyle:Ye.modalContent,children:[(0,H.jsx)(te.default,{style:Ye.modalTitle,children:"Appointment Actions"}),z&&(0,H.jsxs)(i.default,{style:Ye.appointmentDetails,children:[(0,H.jsxs)(w.default,{style:Ye.appointmentDetail,children:[(0,H.jsx)(w.default,{style:Ye.detailLabel,children:"Customer: "}),z.customer.name]}),(0,H.jsxs)(w.default,{style:Ye.appointmentDetail,children:[(0,H.jsx)(w.default,{style:Ye.detailLabel,children:"Service: "}),z.service.name]}),(0,H.jsxs)(w.default,{style:Ye.appointmentDetail,children:[(0,H.jsx)(w.default,{style:Ye.detailLabel,children:"Time: "}),z.startTime," - ",z.endTime]}),(0,H.jsxs)(w.default,{style:Ye.appointmentDetail,children:[(0,H.jsx)(w.default,{style:Ye.detailLabel,children:"Status: "}),z.status.toUpperCase()]})]}),(0,H.jsx)(he.default,{style:Ye.divider}),(0,H.jsxs)(i.default,{style:Ye.actionButtons,children:[(0,H.jsx)(C.default,{style:[Ye.actionButton,"complete"===Y&&Ye.actionButtonSelected],onPress:function(){return we("complete")},children:(0,H.jsx)(w.default,{style:Ye.actionButtonText,children:"Complete"})}),(0,H.jsx)(C.default,{style:[Ye.actionButton,"cancel"===Y&&Ye.actionButtonSelected],onPress:function(){return we("cancel")},children:(0,H.jsx)(w.default,{style:Ye.actionButtonText,children:"Cancel"})}),(0,H.jsx)(C.default,{style:[Ye.actionButton,"noshow"===Y&&Ye.actionButtonSelected],onPress:function(){return we("noshow")},children:(0,H.jsx)(w.default,{style:Ye.actionButtonText,children:"No-Show"})}),(0,H.jsx)(C.default,{style:[Ye.actionButton,"swap"===Y&&Ye.actionButtonSelected],onPress:function(){return we("swap")},children:(0,H.jsx)(w.default,{style:Ye.actionButtonText,children:"Change Time"})})]}),Y&&"swap"!==Y&&(0,H.jsx)(T.default,{label:"complete"===Y?"Notes (optional)":"cancel"===Y?"Cancellation Reason":"No-Show Notes",value:Q,onChangeText:ee,style:Ye.noteInput,multiline:!0}),(0,H.jsxs)(i.default,{style:Ye.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){return U(!1)},style:Ye.modalButton,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:Te,disabled:"cancel"===Y&&!Q,style:Ye.modalButton,children:"Confirm"})]})]})}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:ae,onDismiss:function(){return oe(!1)},contentContainerStyle:Ye.modalContent,children:[(0,H.jsx)(te.default,{style:Ye.modalTitle,children:"Select New Time"}),de.length>0?(0,H.jsx)(j.default,{style:Ye.timeSlotsContainer,children:de.map((function(e,t){return(0,H.jsx)(C.default,{style:[Ye.timeSlotButton,me&&me.startTime===e.startTime&&Ye.selectedTimeSlot],onPress:function(){return ye(e)},children:(0,H.jsxs)(w.default,{style:Ye.timeSlotButtonText,children:[e.startTime," - ",e.endTime]})},t)}))}):(0,H.jsx)(w.default,{style:Ye.noSlotsText,children:"No available time slots for this day."}),(0,H.jsxs)(i.default,{style:Ye.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){return oe(!1)},style:Ye.modalButton,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:Be,disabled:!me,style:Ye.modalButton,children:"Change Time"})]})]})})]})};var Ze=n(31140);function Ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ke(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centeredContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},headerSubtitle:{fontSize:16,color:"#BBE1FA",marginTop:5},content:{flex:1},statsContainer:{flexDirection:"row",justifyContent:"space-between",padding:15},statsCard:{width:"30%",elevation:2},statsValue:{fontSize:24,fontWeight:"bold"},section:{padding:15,marginBottom:20},sectionHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#1B262C"},subtitle:{fontSize:16,fontWeight:"bold",marginTop:15,marginBottom:10,color:"#1B262C"},searchbar:{marginBottom:15,elevation:2},userCard:{marginBottom:10,elevation:2},userCardHeader:{flexDirection:"row",alignItems:"center"},userInfo:{flex:1,marginLeft:10},userDetailsRow:{flexDirection:"row",alignItems:"center",marginTop:2},userEmail:{fontSize:12,color:"#666"},userPhone:{fontSize:12,color:"#666"},staffIdContainer:{flexDirection:"row",alignItems:"center"},staffId:{fontSize:12,color:"#666"},roleChip:{marginLeft:10},userCardActions:{flexDirection:"row",justifyContent:"space-around",marginTop:10},emptyText:{textAlign:"center",padding:20,color:"#666"},fab:{position:"absolute",margin:16,right:0,bottom:0,backgroundColor:"#0F4C75"},modalContent:{backgroundColor:"white",padding:20,margin:20,borderRadius:5},modalTitle:{marginBottom:15,textAlign:"center"},input:{marginBottom:15},roleSelector:{marginVertical:15},roleLabel:{marginBottom:10,fontSize:16},roleButtons:{flexDirection:"row",justifyContent:"space-around"},roleButton:{width:"45%"},modalActions:{flexDirection:"row",justifyContent:"space-around",marginTop:20},button:{marginHorizontal:5,width:"45%"},statusChip:{marginLeft:10},salonCard:{marginBottom:10,elevation:2},salonCardHeader:{flexDirection:"row",alignItems:"center"},salonInfo:{flex:1,marginLeft:10},salonAddress:{fontSize:12,color:"#666"},salonPhone:{fontSize:12,color:"#666"},salonCardActions:{flexDirection:"row",justifyContent:"space-around",marginTop:10},emptyContainer:{padding:20,alignItems:"center"},statusSelector:{marginVertical:15}});const et=function(e){var t=e.navigation,n=(0,s.useContext)(G).userInfo,r=(0,s.useState)(!0),l=(0,o.default)(r,2),d=l[0],u=l[1],c=(0,s.useState)([]),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)([]),g=(0,o.default)(p,2),y=g[0],x=g[1],b=(0,s.useState)([]),C=(0,o.default)(b,2),v=C[0],k=C[1],D=(0,s.useState)([]),F=(0,o.default)(D,2),P=F[0],A=F[1],I=(0,s.useState)(""),E=(0,o.default)(I,2),O=E[0],z=E[1],$=(0,s.useState)(!1),R=(0,o.default)($,2),M=R[0],L=R[1],N=(0,s.useState)(!1),_=(0,o.default)(N,2),U=_[0],V=_[1],q=(0,s.useState)({name:"",email:"",password:"",phone:"",role:"barber"}),Y=(0,o.default)(q,2),J=Y[0],Z=Y[1],K=(0,s.useState)({name:"",address:{street:"",city:"",state:"",postalCode:""},phone:"",email:"",description:""}),ne=(0,o.default)(K,2),re=ne[0],se=ne[1],ie=(0,s.useState)(null),de=(0,o.default)(ie,2),ue=de[0],ce=de[1],me=(0,s.useState)({name:"",email:"",phone:"",role:"barber",isActive:!0}),pe=(0,o.default)(me,2),ge=pe[0],ye=pe[1],xe=(0,s.useState)({totalAppointments:0,completedAppointments:0,totalUsers:0,totalBarbers:0,totalManagers:0}),je=(0,o.default)(xe,2),be=je[0],Se=je[1];(0,s.useEffect)((function(){n&&"seif.ayadi.3.9.2@gmail.com"!==n.email?(S.default.alert("Access Denied","Only the admin account can access this screen."),t.goBack()):(we(),Te(),Be())}),[n]);var we=function(){var e=(0,a.default)((function*(){try{u(!0);var e=yield W.get("/admin/users",{headers:{Authorization:`Bearer ${n.token}`}});if(e.data&&e.data.success){var t=e.data.users||[];h(t),x(t.filter((function(e){return"barber"===e.role}))),k(t.filter((function(e){return"manager"===e.role}))),console.log(`Loaded ${t.length} users, ${y.length} barbers, ${v.length} managers`)}else console.error("Failed to load users:",e.data),S.default.alert("Error","Failed to load users");u(!1)}catch(r){console.error("Error fetching users:",r),u(!1),S.default.alert("Error","Failed to load users: "+(r.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),Te=function(){var e=(0,a.default)((function*(){try{u(!0);var e=yield W.get("/admin/stats",{headers:{Authorization:`Bearer ${n.token}`}});if(e.data&&e.data.success){var t=e.data.stats;Se({totalAppointments:t.appointments.total||0,completedAppointments:t.appointments.completed||0,totalUsers:t.users.total||0,totalBarbers:t.users.barbers||0,totalManagers:t.users.managers||0}),console.log("Dashboard stats loaded successfully")}else console.error("Failed to load stats:",e.data),Se({totalAppointments:0,completedAppointments:0,totalUsers:0,totalBarbers:0,totalManagers:0});u(!1)}catch(r){console.error("Error fetching stats:",r),u(!1),Se({totalAppointments:0,completedAppointments:0,totalUsers:0,totalBarbers:0,totalManagers:0})}}));return function(){return e.apply(this,arguments)}}(),Be=function(){var e=(0,a.default)((function*(){try{u(!0);var e=yield W.get("/admin/salons",{headers:{Authorization:`Bearer ${n.token}`}});if(e.data&&e.data.success){var t=e.data.salons||[];A(t),console.log(`Loaded ${t.length} salons`)}else console.error("Failed to load salons:",e.data),S.default.alert("Error","Failed to load salons");u(!1)}catch(r){console.error("Error fetching salons:",r),u(!1),S.default.alert("Error","Failed to load salons: "+(r.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=(0,a.default)((function*(){try{if(u(!0),!J.name||!J.email||!J.password)return S.default.alert("Error","Please fill in all required fields"),void u(!1);var e=J.name.split(" ").map((function(e){return e[0]})).join("").toUpperCase(),t=Math.floor(1e3+9e3*Math.random()),r=`${"manager"===J.role?"MGR":"BRB"}-${e}${t}`,a=Xe(Xe({},J),{},{staffId:r,isActive:!0,joinDate:(new Date).toISOString()});console.log("Creating new staff with data:",JSON.stringify(a));var o,l=n.token,s=yield W.post("/admin/users",a,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});if(console.log("API response:",JSON.stringify(s.data)),s.data&&s.data.success)console.log("Staff member created successfully:",s.data.user),yield we(),Z({name:"",email:"",password:"",phone:"",role:"barber"}),L(!1),S.default.alert("Success",`${"manager"===J.role?"Manager":"Barber"} added successfully with ID: ${r}`);else console.error("Failed to create staff member, response:",JSON.stringify(s.data)),S.default.alert("Error",(null==(o=s.data)?void 0:o.message)||"Failed to create staff member");u(!1)}catch(f){var i,d,c;console.error("Error creating staff member:",f),console.error("Error details:",(null==(i=f.response)?void 0:i.data)||f.message),u(!1),S.default.alert("Error",(null==(d=f.response)||null==(c=d.data)?void 0:c.message)||"Failed to create staff member. Check console for details.")}}));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){if(ue){var e=m.find((function(e){return e._id===ue}));e&&ye({name:e.name||"",email:e.email||"",phone:e.phone||"",role:e.role||"barber",isActive:void 0===e.isActive||e.isActive})}}),[ue]);var De=function(){var e=(0,a.default)((function*(){try{if(u(!0),!ge.name||!ge.email)return S.default.alert("Error","Please fill in all required fields"),void u(!1);console.log("Updating user with data:",JSON.stringify(ge));var e,t=n.token,r=yield W.put(`/admin/users/${ue}`,ge,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(r.data&&r.data.success)console.log("User updated successfully:",r.data.user),yield we(),ce(null),S.default.alert("Success","User updated successfully");else console.error("Failed to update user, response:",JSON.stringify(r.data)),S.default.alert("Error",(null==(e=r.data)?void 0:e.message)||"Failed to update user");u(!1)}catch(s){var a,o,l;console.error("Error updating user:",s),console.error("Error details:",(null==(a=s.response)?void 0:a.data)||s.message),u(!1),S.default.alert("Error",(null==(o=s.response)||null==(l=o.data)?void 0:l.message)||"Failed to update user. Check console for details.")}}));return function(){return e.apply(this,arguments)}}(),Fe=function(e){var t=e.item;return(0,H.jsx)(Q.default,{style:Qe.userCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:Qe.userCardHeader,children:[(0,H.jsx)(Ze.default,{size:40,label:t.name.split(" ").map((function(e){return e[0]})).join(""),backgroundColor:"#0F4C75"}),(0,H.jsxs)(i.default,{style:Qe.userInfo,children:[(0,H.jsx)(te.default,{children:t.name}),(0,H.jsxs)(i.default,{style:Qe.userDetailsRow,children:[(0,H.jsx)(ee.default,{style:Qe.userEmail,children:t.email}),t.phone&&(0,H.jsxs)(ee.default,{style:Qe.userPhone,children:["\u2022 ",t.phone]})]}),t.staffId&&(0,H.jsxs)(i.default,{style:Qe.staffIdContainer,children:[(0,H.jsxs)(ee.default,{style:Qe.staffId,children:["ID: ",t.staffId]}),(0,H.jsx)(le.default,{mode:"flat",style:[Qe.statusChip,{backgroundColor:t.isActive?"#C8E6C9":"#FFCDD2"}],children:t.isActive?"Active":"Inactive"})]})]}),(0,H.jsx)(le.default,{mode:"outlined",style:Qe.roleChip,children:t.role.charAt(0).toUpperCase()+t.role.slice(1)})]}),(0,H.jsx)(he.default,{style:{marginVertical:10}}),(0,H.jsxs)(i.default,{style:Qe.userCardActions,children:[(0,H.jsx)(B.default,{mode:"outlined",compact:!0,icon:"pencil",onPress:function(){return ce(t._id)},children:"Edit"}),(0,H.jsx)(B.default,{mode:"outlined",compact:!0,icon:"delete",textColor:"#D32F2F",onPress:function(){return e=t._id,void S.default.alert("Confirm Delete","Are you sure you want to delete this user?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:function(){var t=(0,a.default)((function*(){try{u(!0);var t,r=yield W.delete(`/admin/users/${e}`,{headers:{Authorization:`Bearer ${n.token}`}});r.data&&r.data.success?(console.log("User deleted successfully:",r.data),yield we(),S.default.alert("Success","User deleted successfully")):(console.error("Failed to delete user:",r.data),S.default.alert("Error",(null==(t=r.data)?void 0:t.message)||"Failed to delete user")),u(!1)}catch(l){var a,o;console.error("Error deleting user:",l),u(!1),S.default.alert("Error",(null==(a=l.response)||null==(o=a.data)?void 0:o.message)||"Failed to delete user")}}));return function(){return t.apply(this,arguments)}}()}]);var e},children:"Delete"})]})]})})},Pe=function(){var e=(0,a.default)((function*(){try{if(u(!0),!re.name||!re.address.street||!re.address.city||!re.phone)return S.default.alert("Error","Please fill in all required fields (name, address, phone)"),void u(!1);var e=Xe(Xe({},re),{},{coordinates:[10.1815,36.8065]});console.log("Creating new salon with data:",JSON.stringify(e));var t,r=yield W.post("/admin/salons",e,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.token}`}});if(r.data&&r.data.success)console.log("Salon created successfully:",r.data.salon),yield Be(),se({name:"",address:{street:"",city:"",state:"",postalCode:""},phone:"",email:"",description:""}),V(!1),S.default.alert("Success","Salon added successfully");else console.error("Failed to create salon, response:",JSON.stringify(r.data)),S.default.alert("Error",(null==(t=r.data)?void 0:t.message)||"Failed to create salon");u(!1)}catch(s){var a,o,l;console.error("Error creating salon:",s),console.error("Error details:",(null==(a=s.response)?void 0:a.data)||s.message),u(!1),S.default.alert("Error",(null==(o=s.response)||null==(l=o.data)?void 0:l.message)||"Failed to create salon. Check console for details.")}}));return function(){return e.apply(this,arguments)}}();return d&&0===m.length?(0,H.jsxs)(i.default,{style:Qe.centeredContainer,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading dashboard..."})]}):(0,H.jsxs)(i.default,{style:Qe.container,children:[(0,H.jsxs)(i.default,{style:Qe.header,children:[(0,H.jsx)(w.default,{style:Qe.headerTitle,children:"Admin Dashboard"}),(0,H.jsxs)(w.default,{style:Qe.headerSubtitle,children:["Welcome, ",null==n?void 0:n.name]})]}),(0,H.jsxs)(j.default,{style:Qe.content,children:[(0,H.jsxs)(i.default,{style:Qe.statsContainer,children:[(0,H.jsx)(Q.default,{style:[Qe.statsCard,{backgroundColor:"#BBE1FA"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:Qe.statsValue,children:be.totalAppointments}),(0,H.jsx)(ee.default,{children:"Total Appointments"})]})}),(0,H.jsx)(Q.default,{style:[Qe.statsCard,{backgroundColor:"#C8E6C9"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:Qe.statsValue,children:be.totalUsers}),(0,H.jsx)(ee.default,{children:"Customers"})]})}),(0,H.jsx)(Q.default,{style:[Qe.statsCard,{backgroundColor:"#FFECB3"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:Qe.statsValue,children:be.totalBarbers}),(0,H.jsx)(ee.default,{children:"Barbers"})]})})]}),(0,H.jsxs)(i.default,{style:Qe.section,children:[(0,H.jsxs)(i.default,{style:Qe.sectionHeader,children:[(0,H.jsx)(w.default,{style:Qe.sectionTitle,children:"Salon Management"}),(0,H.jsx)(B.default,{mode:"contained",icon:"plus",onPress:function(){return V(!0)},children:"Add Salon"})]}),(0,H.jsx)(ae.default,{data:P,renderItem:function(e){var r=e.item;return(0,H.jsx)(Q.default,{style:Qe.salonCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:Qe.salonCardHeader,children:[(0,H.jsx)(fe.default,{size:40,icon:"store",backgroundColor:"#0F4C75"}),(0,H.jsxs)(i.default,{style:Qe.salonInfo,children:[(0,H.jsx)(te.default,{children:r.name}),(0,H.jsxs)(ee.default,{style:Qe.salonAddress,children:[r.address.street,", ",r.address.city]}),(0,H.jsx)(ee.default,{style:Qe.salonPhone,children:r.phone})]}),(0,H.jsx)(le.default,{mode:"flat",style:[Qe.statusChip,{backgroundColor:r.isActive?"#C8E6C9":"#FFCDD2"}],children:r.isActive?"Active":"Inactive"})]}),(0,H.jsx)(he.default,{style:{marginVertical:10}}),(0,H.jsxs)(i.default,{style:Qe.salonCardActions,children:[(0,H.jsx)(B.default,{mode:"outlined",compact:!0,icon:"pencil",onPress:function(){return t.navigate("SalonDetails",{salonId:r._id})},children:"Edit"}),(0,H.jsx)(B.default,{mode:"outlined",compact:!0,icon:"account-group",onPress:function(){return t.navigate("SalonStaff",{salonId:r._id})},children:"Staff"}),(0,H.jsx)(B.default,{mode:"outlined",compact:!0,icon:"delete",textColor:"#D32F2F",onPress:function(){return e=r._id,void S.default.alert("Confirm Delete","Are you sure you want to delete this salon?",[{text:"Cancel",style:"cancel"},{text:"Delete",style:"destructive",onPress:function(){var t=(0,a.default)((function*(){try{u(!0);var t,r=yield W.delete(`/admin/salons/${e}`,{headers:{Authorization:`Bearer ${n.token}`}});r.data&&r.data.success?(console.log("Salon deleted successfully:",r.data),yield Be(),S.default.alert("Success","Salon deleted successfully")):(console.error("Failed to delete salon:",r.data),S.default.alert("Error",(null==(t=r.data)?void 0:t.message)||"Failed to delete salon")),u(!1)}catch(l){var a,o;console.error("Error deleting salon:",l),u(!1),S.default.alert("Error",(null==(a=l.response)||null==(o=a.data)?void 0:o.message)||"Failed to delete salon")}}));return function(){return t.apply(this,arguments)}}()}]);var e},children:"Delete"})]})]})})},keyExtractor:function(e){return e._id},contentContainerStyle:{paddingBottom:10},ListEmptyComponent:(0,H.jsx)(i.default,{style:Qe.emptyContainer,children:(0,H.jsx)(w.default,{style:Qe.emptyText,children:"No salons found"})})})]}),(0,H.jsxs)(i.default,{style:Qe.section,children:[(0,H.jsxs)(i.default,{style:Qe.sectionHeader,children:[(0,H.jsx)(w.default,{style:Qe.sectionTitle,children:"Staff Management"}),(0,H.jsx)(B.default,{mode:"contained",icon:"plus",onPress:function(){return L(!0)},children:"Add Staff"})]}),(0,H.jsx)(oe.default,{placeholder:"Search users...",onChangeText:z,value:O,style:Qe.searchbar}),(0,H.jsxs)(w.default,{style:Qe.subtitle,children:["Barbers (",y.length,")"]}),(0,H.jsx)(ae.default,{data:y.filter((function(e){return e.name.toLowerCase().includes(O.toLowerCase())||e.email.toLowerCase().includes(O.toLowerCase())})),renderItem:Fe,keyExtractor:function(e){return e._id},contentContainerStyle:{paddingBottom:10},ListEmptyComponent:(0,H.jsx)(i.default,{style:Qe.emptyContainer,children:(0,H.jsx)(w.default,{style:Qe.emptyText,children:"No barbers found"})})}),(0,H.jsxs)(w.default,{style:Qe.subtitle,children:["Managers (",v.length,")"]}),(0,H.jsx)(ae.default,{data:v.filter((function(e){return e.name.toLowerCase().includes(O.toLowerCase())||e.email.toLowerCase().includes(O.toLowerCase())})),renderItem:Fe,keyExtractor:function(e){return e._id},contentContainerStyle:{paddingBottom:10},ListEmptyComponent:(0,H.jsx)(i.default,{style:Qe.emptyContainer,children:(0,H.jsx)(w.default,{style:Qe.emptyText,children:"No managers found"})})})]})]}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:M,onDismiss:function(){return L(!1)},contentContainerStyle:Qe.modalContent,children:[(0,H.jsx)(te.default,{style:Qe.modalTitle,children:"Add New Staff Member"}),(0,H.jsx)(T.default,{label:"Full Name",value:J.name,onChangeText:function(e){if(Z(Xe(Xe({},J),{},{name:e})),e&&["barber","manager"].includes(J.role)){var t=e.split(" ").map((function(e){return e[0]})).join("").toUpperCase(),n=Math.floor(1e3+9e3*Math.random()),r=`${"manager"===J.role?"MGR":"BRB"}-${t}${n}`;console.log("Auto-generated Staff ID:",r)}},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Email",value:J.email,onChangeText:function(e){return Z(Xe(Xe({},J),{},{email:e}))},style:Qe.input,mode:"outlined",keyboardType:"email-address",autoCapitalize:"none"}),(0,H.jsx)(T.default,{label:"Password",value:J.password,onChangeText:function(e){return Z(Xe(Xe({},J),{},{password:e}))},style:Qe.input,mode:"outlined",secureTextEntry:!0}),(0,H.jsx)(T.default,{label:"Phone",value:J.phone,onChangeText:function(e){return Z(Xe(Xe({},J),{},{phone:e}))},style:Qe.input,mode:"outlined",keyboardType:"phone-pad"}),(0,H.jsxs)(i.default,{style:Qe.roleSelector,children:[(0,H.jsx)(w.default,{style:Qe.roleLabel,children:"Role:"}),(0,H.jsxs)(i.default,{style:Qe.roleButtons,children:[(0,H.jsx)(B.default,{mode:"barber"===J.role?"contained":"outlined",onPress:function(){if(Z(Xe(Xe({},J),{},{role:"barber"})),J.name){var e=J.name.split(" ").map((function(e){return e[0]})).join("").toUpperCase(),t=Math.floor(1e3+9e3*Math.random());console.log("Auto-generated Barber ID:",`BRB-${e}${t}`)}},style:Qe.roleButton,children:"Barber"}),(0,H.jsx)(B.default,{mode:"manager"===J.role?"contained":"outlined",onPress:function(){if(Z(Xe(Xe({},J),{},{role:"manager"})),J.name){var e=J.name.split(" ").map((function(e){return e[0]})).join("").toUpperCase(),t=Math.floor(1e3+9e3*Math.random());console.log("Auto-generated Manager ID:",`MGR-${e}${t}`)}},style:Qe.roleButton,children:"Manager"})]})]}),(0,H.jsxs)(i.default,{style:Qe.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){return L(!1)},style:Qe.button,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:ke,loading:d,style:Qe.button,children:"Add Staff"})]})]})}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:U,onDismiss:function(){return V(!1)},contentContainerStyle:Qe.modalContent,children:[(0,H.jsx)(te.default,{style:Qe.modalTitle,children:"Add New Salon"}),(0,H.jsx)(T.default,{label:"Salon Name",value:re.name,onChangeText:function(e){return se(Xe(Xe({},re),{},{name:e}))},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Street Address",value:re.address.street,onChangeText:function(e){return se(Xe(Xe({},re),{},{address:Xe(Xe({},re.address),{},{street:e})}))},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"City",value:re.address.city,onChangeText:function(e){return se(Xe(Xe({},re),{},{address:Xe(Xe({},re.address),{},{city:e})}))},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"State/Region",value:re.address.state,onChangeText:function(e){return se(Xe(Xe({},re),{},{address:Xe(Xe({},re.address),{},{state:e})}))},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Postal Code",value:re.address.postalCode,onChangeText:function(e){return se(Xe(Xe({},re),{},{address:Xe(Xe({},re.address),{},{postalCode:e})}))},style:Qe.input,mode:"outlined",keyboardType:"numeric"}),(0,H.jsx)(T.default,{label:"Phone",value:re.phone,onChangeText:function(e){return se(Xe(Xe({},re),{},{phone:e}))},style:Qe.input,mode:"outlined",keyboardType:"phone-pad"}),(0,H.jsx)(T.default,{label:"Email",value:re.email,onChangeText:function(e){return se(Xe(Xe({},re),{},{email:e}))},style:Qe.input,mode:"outlined",keyboardType:"email-address",autoCapitalize:"none"}),(0,H.jsx)(T.default,{label:"Description",value:re.description,onChangeText:function(e){return se(Xe(Xe({},re),{},{description:e}))},style:Qe.input,mode:"outlined",multiline:!0,numberOfLines:3}),(0,H.jsxs)(i.default,{style:Qe.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){return V(!1)},style:Qe.button,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:Pe,loading:d,style:Qe.button,children:"Add Salon"})]})]})}),(0,H.jsx)(Ce.default,{style:Qe.fab,icon:"refresh",onPress:function(){we(),Be(),Te()},label:"Refresh"}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:null!==ue,onDismiss:function(){return ce(null)},contentContainerStyle:Qe.modalContent,children:[(0,H.jsx)(te.default,{style:Qe.modalTitle,children:"Edit Staff Member"}),(0,H.jsx)(T.default,{label:"Full Name",value:ge.name,onChangeText:function(e){return ye(Xe(Xe({},ge),{},{name:e}))},style:Qe.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Email",value:ge.email,onChangeText:function(e){return ye(Xe(Xe({},ge),{},{email:e}))},style:Qe.input,mode:"outlined",keyboardType:"email-address",autoCapitalize:"none"}),(0,H.jsx)(T.default,{label:"Phone",value:ge.phone,onChangeText:function(e){return ye(Xe(Xe({},ge),{},{phone:e}))},style:Qe.input,mode:"outlined",keyboardType:"phone-pad"}),(0,H.jsxs)(i.default,{style:Qe.roleSelector,children:[(0,H.jsx)(w.default,{style:Qe.roleLabel,children:"Role:"}),(0,H.jsxs)(i.default,{style:Qe.roleButtons,children:[(0,H.jsx)(B.default,{mode:"barber"===ge.role?"contained":"outlined",onPress:function(){return ye(Xe(Xe({},ge),{},{role:"barber"}))},style:Qe.roleButton,children:"Barber"}),(0,H.jsx)(B.default,{mode:"manager"===ge.role?"contained":"outlined",onPress:function(){return ye(Xe(Xe({},ge),{},{role:"manager"}))},style:Qe.roleButton,children:"Manager"})]})]}),(0,H.jsxs)(i.default,{style:Qe.statusSelector,children:[(0,H.jsx)(w.default,{style:Qe.roleLabel,children:"Status:"}),(0,H.jsxs)(i.default,{style:Qe.roleButtons,children:[(0,H.jsx)(B.default,{mode:ge.isActive?"contained":"outlined",onPress:function(){return ye(Xe(Xe({},ge),{},{isActive:!0}))},style:[Qe.roleButton,{backgroundColor:ge.isActive?"#4CAF50":"transparent"}],labelStyle:{color:ge.isActive?"white":"#4CAF50"},children:"Active"}),(0,H.jsx)(B.default,{mode:ge.isActive?"outlined":"contained",onPress:function(){return ye(Xe(Xe({},ge),{},{isActive:!1}))},style:[Qe.roleButton,{backgroundColor:ge.isActive?"transparent":"#F44336"}],labelStyle:{color:ge.isActive?"#F44336":"white"},children:"Inactive"})]})]}),(0,H.jsxs)(i.default,{style:Qe.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){return ce(null)},style:Qe.button,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:De,loading:d,style:Qe.button,children:"Update Staff"})]})]})})]})};function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rt=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},content:{flex:1,padding:15},card:{marginBottom:20,elevation:2},title:{marginBottom:20},input:{marginBottom:15},note:{color:"#666",marginBottom:20},buttonContainer:{flexDirection:"row",justifyContent:"space-around",marginTop:10},button:{width:"45%"}});const at=function(e){var t=e.route,n=e.navigation,r=t.params.salonId,l=(0,s.useContext)(G).userInfo,d=(0,s.useState)(!0),u=(0,o.default)(d,2),c=u[0],f=u[1],m=(0,s.useState)(!1),h=(0,o.default)(m,2),p=h[0],g=h[1],y=(0,s.useState)(null),x=(0,o.default)(y,2),b=(x[0],x[1]),C=(0,s.useState)({name:"",address:{street:"",city:"",state:"",postalCode:""},phone:"",email:"",description:""}),v=(0,o.default)(C,2),k=v[0],D=v[1];(0,s.useEffect)((function(){F()}),[r]);var F=function(){var e=(0,a.default)((function*(){try{f(!0);var e=yield W.get(`/admin/salons/${r}`,{headers:{Authorization:`Bearer ${l.token}`}});if(e.data&&e.data.success){var t,n,a,o,s=e.data.salon;b(s),D({name:s.name||"",address:{street:(null==(t=s.address)?void 0:t.street)||"",city:(null==(n=s.address)?void 0:n.city)||"",state:(null==(a=s.address)?void 0:a.state)||"",postalCode:(null==(o=s.address)?void 0:o.postalCode)||""},phone:s.phone||"",email:s.email||"",description:s.description||""}),console.log("Salon details loaded")}else console.error("Failed to load salon details:",e.data),S.default.alert("Error","Failed to load salon details");f(!1)}catch(i){console.error("Error fetching salon details:",i),f(!1),S.default.alert("Error","Failed to load salon details: "+(i.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),P=function(){var e=(0,a.default)((function*(){if(k.name&&k.address.street&&k.address.city&&k.phone)try{g(!0);var e,t=yield W.put(`/admin/salons/${r}`,k,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.token}`}});if(t.data&&t.data.success)S.default.alert("Success","Salon updated successfully",[{text:"OK",onPress:function(){return n.goBack()}}]);else console.error("Failed to update salon:",t.data),S.default.alert("Error",(null==(e=t.data)?void 0:e.message)||"Failed to update salon");g(!1)}catch(s){var a,o;console.error("Error updating salon:",s),g(!1),S.default.alert("Error",(null==(a=s.response)||null==(o=a.data)?void 0:o.message)||"Failed to update salon")}else S.default.alert("Error","Please fill in all required fields (name, address, phone)")}));return function(){return e.apply(this,arguments)}}();return c?(0,H.jsxs)(i.default,{style:rt.centered,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading salon details..."})]}):(0,H.jsxs)(i.default,{style:rt.container,children:[(0,H.jsx)(i.default,{style:rt.header,children:(0,H.jsx)(w.default,{style:rt.headerTitle,children:"Edit Salon"})}),(0,H.jsx)(j.default,{style:rt.content,children:(0,H.jsx)(Q.default,{style:rt.card,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:rt.title,children:"Salon Information"}),(0,H.jsx)(T.default,{label:"Salon Name *",value:k.name,onChangeText:function(e){return D(nt(nt({},k),{},{name:e}))},style:rt.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Street Address *",value:k.address.street,onChangeText:function(e){return D(nt(nt({},k),{},{address:nt(nt({},k.address),{},{street:e})}))},style:rt.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"City *",value:k.address.city,onChangeText:function(e){return D(nt(nt({},k),{},{address:nt(nt({},k.address),{},{city:e})}))},style:rt.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"State/Region",value:k.address.state,onChangeText:function(e){return D(nt(nt({},k),{},{address:nt(nt({},k.address),{},{state:e})}))},style:rt.input,mode:"outlined"}),(0,H.jsx)(T.default,{label:"Postal Code",value:k.address.postalCode,onChangeText:function(e){return D(nt(nt({},k),{},{address:nt(nt({},k.address),{},{postalCode:e})}))},style:rt.input,mode:"outlined",keyboardType:"numeric"}),(0,H.jsx)(T.default,{label:"Phone *",value:k.phone,onChangeText:function(e){return D(nt(nt({},k),{},{phone:e}))},style:rt.input,mode:"outlined",keyboardType:"phone-pad"}),(0,H.jsx)(T.default,{label:"Email",value:k.email,onChangeText:function(e){return D(nt(nt({},k),{},{email:e}))},style:rt.input,mode:"outlined",keyboardType:"email-address",autoCapitalize:"none"}),(0,H.jsx)(T.default,{label:"Description",value:k.description,onChangeText:function(e){return D(nt(nt({},k),{},{description:e}))},style:rt.input,mode:"outlined",multiline:!0,numberOfLines:3}),(0,H.jsx)(w.default,{style:rt.note,children:"* Required fields"}),(0,H.jsxs)(i.default,{style:rt.buttonContainer,children:[(0,H.jsx)(B.default,{mode:"outlined",onPress:function(){return n.goBack()},style:rt.button,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:P,loading:p,disabled:p,style:rt.button,children:"Save Changes"})]})]})})})]})};var ot=n(35826),lt=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centered:{flex:1,justifyContent:"center",alignItems:"center",padding:20},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},headerSubtitle:{fontSize:16,color:"#BBE1FA",marginTop:5},content:{flex:1,padding:15},actionBar:{flexDirection:"row",justifyContent:"flex-end",marginBottom:15},title:{marginBottom:15},staffCard:{marginBottom:10,elevation:2},staffCardHeader:{flexDirection:"row",alignItems:"center"},staffInfo:{flex:1,marginLeft:10},staffDetailsRow:{flexDirection:"row",alignItems:"center"},staffEmail:{fontSize:12,color:"#666"},staffPhone:{fontSize:12,color:"#666",marginLeft:5},staffId:{fontSize:12,color:"#666",marginTop:3},roleChip:{marginLeft:10},emptyCard:{padding:20,alignItems:"center"},emptyText:{textAlign:"center",color:"#666"},modalContent:{backgroundColor:"white",padding:20,margin:20,borderRadius:5,maxHeight:"80%"},modalTitle:{marginBottom:15,textAlign:"center"},userList:{maxHeight:300},radioItem:{flexDirection:"row",alignItems:"center",padding:10,borderBottomWidth:1,borderBottomColor:"#eee"},radioItemContent:{marginLeft:10},radioItemName:{fontWeight:"bold"},radioItemRole:{fontSize:12,color:"#666",textTransform:"capitalize"},radioItemId:{fontSize:12,color:"#666"},modalActions:{flexDirection:"row",justifyContent:"space-around",marginTop:20},button:{marginHorizontal:5,width:"45%"},noUsersText:{textAlign:"center",marginVertical:20,color:"#666"},emptyUserList:{padding:20,alignItems:"center"}});const st=function(e){var t=e.route,n=(e.navigation,t.params.salonId),r=(0,s.useContext)(G).userInfo,l=(0,s.useState)(!0),d=(0,o.default)(l,2),u=d[0],c=d[1],f=(0,s.useState)(!1),m=(0,o.default)(f,2),h=m[0],p=m[1],g=(0,s.useState)(null),y=(0,o.default)(g,2),x=y[0],b=y[1],C=(0,s.useState)([]),v=(0,o.default)(C,2),T=v[0],k=v[1],D=(0,s.useState)([]),F=(0,o.default)(D,2),P=F[0],A=F[1],I=(0,s.useState)(!1),E=(0,o.default)(I,2),O=E[0],z=E[1],$=(0,s.useState)(null),R=(0,o.default)($,2),M=R[0],L=R[1];(0,s.useEffect)((function(){N()}),[n]);var N=function(){var e=(0,a.default)((function*(){try{c(!0);var e=yield W.get(`/admin/salons/${n}`,{headers:{Authorization:`Bearer ${r.token}`}});if(e.data&&e.data.success){var t=e.data.salon;if(b(t),t.staff&&t.staff.length>0){var a=Array.isArray(t.staff)?t.staff.map((function(e){return"object"===typeof e?e._id:e})):[],o=yield W.get("/admin/users",{headers:{Authorization:`Bearer ${r.token}`}});if(o.data&&o.data.success){var l=o.data.users.filter((function(e){return a.includes(e._id)}));k(l);var s=o.data.users.filter((function(e){return("barber"===e.role||"manager"===e.role)&&!a.includes(e._id)}));A(s)}}else{var i=yield W.get("/admin/users",{headers:{Authorization:`Bearer ${r.token}`}});if(i.data&&i.data.success){var d=i.data.users.filter((function(e){return"barber"===e.role||"manager"===e.role}));A(d)}}console.log("Salon staff loaded")}else console.error("Failed to load salon details:",e.data),S.default.alert("Error","Failed to load salon details");c(!1)}catch(u){console.error("Error fetching salon staff:",u),c(!1),S.default.alert("Error","Failed to load salon staff: "+(u.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),_=function(){var e=(0,a.default)((function*(){if(M)try{p(!0);var e=yield W.put(`/admin/users/${M._id}`,{role:"barber"},{headers:{Authorization:`Bearer ${r.token}`}});if(!e.data||!e.data.success)throw new Error("Failed to update user role");var t=yield W.post(`/admin/salons/${n}/staff`,{staffId:M._id},{headers:{Authorization:`Bearer ${r.token}`}});if(!t.data||!t.data.success)throw new Error("Failed to add staff to salon");S.default.alert("Success",`${M.name} has been added to the salon staff`),z(!1),L(null),N(),p(!1)}catch(a){console.error("Error adding staff:",a),S.default.alert("Error",a.message||"Failed to add staff to salon"),p(!1)}else S.default.alert("Error","Please select a user to add")}));return function(){return e.apply(this,arguments)}}();return u&&!x?(0,H.jsxs)(i.default,{style:lt.centered,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading salon staff..."})]}):(0,H.jsxs)(i.default,{style:lt.container,children:[(0,H.jsxs)(i.default,{style:lt.header,children:[(0,H.jsx)(w.default,{style:lt.headerTitle,children:"Salon Staff"}),x&&(0,H.jsx)(w.default,{style:lt.headerSubtitle,children:x.name})]}),(0,H.jsxs)(i.default,{style:lt.content,children:[(0,H.jsx)(i.default,{style:lt.actionBar,children:(0,H.jsx)(B.default,{mode:"contained",icon:"account-plus",onPress:function(){return z(!0)},children:"Add Staff Member"})}),(0,H.jsxs)(te.default,{style:lt.title,children:["Current Staff (",T.length,")"]}),T.length>0?(0,H.jsx)(ae.default,{data:T,renderItem:function(e){var t=e.item;return(0,H.jsx)(Q.default,{style:lt.staffCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:lt.staffCardHeader,children:[(0,H.jsx)(Ze.default,{size:40,label:t.name.split(" ").map((function(e){return e[0]})).join(""),backgroundColor:"#0F4C75"}),(0,H.jsxs)(i.default,{style:lt.staffInfo,children:[(0,H.jsx)(te.default,{children:t.name}),(0,H.jsxs)(i.default,{style:lt.staffDetailsRow,children:[(0,H.jsx)(w.default,{style:lt.staffEmail,children:t.email}),t.phone&&(0,H.jsxs)(w.default,{style:lt.staffPhone,children:["\u2022 ",t.phone]})]}),t.staffId&&(0,H.jsxs)(w.default,{style:lt.staffId,children:["ID: ",t.staffId]})]}),(0,H.jsx)(le.default,{mode:"outlined",style:[lt.roleChip,{backgroundColor:"manager"===t.role?"#FFD700":"#BBE1FA"}],children:t.role.charAt(0).toUpperCase()+t.role.slice(1)})]}),(0,H.jsx)(he.default,{style:{marginVertical:10}}),(0,H.jsx)(B.default,{mode:"outlined",icon:"account-remove",textColor:"#D32F2F",onPress:function(){return e=t._id,void S.default.alert("Confirm Removal","Are you sure you want to remove this staff member from the salon?",[{text:"Cancel",style:"cancel"},{text:"Remove",style:"destructive",onPress:function(){var t=(0,a.default)((function*(){try{c(!0);var t,a=yield W.delete(`/admin/salons/${n}/staff/${e}`,{headers:{Authorization:`Bearer ${r.token}`}});a.data&&a.data.success?(S.default.alert("Success","Staff member removed successfully"),N()):(console.error("Failed to remove staff:",a.data),S.default.alert("Error",(null==(t=a.data)?void 0:t.message)||"Failed to remove staff member")),c(!1)}catch(s){var o,l;console.error("Error removing staff:",s),c(!1),S.default.alert("Error",(null==(o=s.response)||null==(l=o.data)?void 0:l.message)||"Failed to remove staff member")}}));return function(){return t.apply(this,arguments)}}()}]);var e},children:"Remove from Salon"})]})})},keyExtractor:function(e){return e._id},contentContainerStyle:{paddingBottom:20}}):(0,H.jsx)(Q.default,{style:lt.emptyCard,children:(0,H.jsx)(Q.default.Content,{children:(0,H.jsx)(w.default,{style:lt.emptyText,children:"No staff members assigned to this salon"})})})]}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:O,onDismiss:function(){z(!1),L(null)},contentContainerStyle:lt.modalContent,children:[(0,H.jsx)(te.default,{style:lt.modalTitle,children:"Add Staff to Salon"}),(0,H.jsx)(j.default,{style:lt.userList,children:P.length>0?(0,H.jsx)(ae.default,{data:P,renderItem:function(e){var t=e.item;return(0,H.jsxs)(i.default,{style:lt.radioItem,children:[(0,H.jsx)(ot.default,{value:t._id,status:M&&M._id===t._id?"checked":"unchecked",onPress:function(){return L(t)}}),(0,H.jsxs)(i.default,{style:lt.radioItemContent,children:[(0,H.jsx)(w.default,{style:lt.radioItemName,children:t.name}),(0,H.jsx)(w.default,{style:lt.radioItemRole,children:t.role||"No role"}),t.staffId&&(0,H.jsxs)(w.default,{style:lt.radioItemId,children:["ID: ",t.staffId]})]})]})},keyExtractor:function(e){return e._id},scrollEnabled:!1}):(0,H.jsx)(i.default,{style:lt.emptyUserList,children:(0,H.jsx)(w.default,{style:lt.emptyText,children:"No available users to add as staff"})})}),(0,H.jsxs)(i.default,{style:lt.modalActions,children:[(0,H.jsx)(B.default,{onPress:function(){z(!1),L(null)},style:lt.button,children:"Cancel"}),(0,H.jsx)(B.default,{mode:"contained",onPress:_,loading:h,disabled:!M||h,style:lt.button,children:"Add to Salon"})]})]})})]})};var it=n(53172),dt=n(43866),ut=n(77686),ct=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centeredContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},headerSubtitle:{fontSize:16,color:"#BBE1FA",marginTop:5},content:{flex:1,padding:15},dateFilterContainer:{marginBottom:15},dateFilterButtons:{flexDirection:"row",marginTop:10},dateFilterButton:{marginRight:10},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#1B262C",marginBottom:10},barberList:{paddingBottom:15},barberCard:{marginRight:10,width:200},selectedBarberCard:{borderWidth:2,borderColor:"#0F4C75"},barberCardContent:{flexDirection:"row",alignItems:"center"},barberInfo:{marginLeft:10},barberName:{fontSize:16},statsContainer:{marginTop:15},barberStatsTitle:{fontSize:18,fontWeight:"bold",color:"#1B262C",marginBottom:15},statsCards:{flexDirection:"row",justifyContent:"space-between",marginBottom:15},statsCard:{width:"31%",elevation:2},statsValue:{fontSize:24,fontWeight:"bold"},metricsCard:{marginBottom:15},metricsTitle:{fontSize:16,marginBottom:10},metricRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:10},metricLabel:{fontSize:14,color:"#555"},metricValue:{fontSize:16,fontWeight:"bold"},progressBar:{height:8,borderRadius:4,marginTop:5,marginBottom:10},ratingContainer:{flexDirection:"row",alignItems:"center"},starIcon:{marginLeft:5},scheduleCard:{marginBottom:15},scheduleHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},scheduleTitle:{fontSize:16},scheduleDate:{fontSize:14,color:"#666"},timeSlotList:{marginTop:10},timeSlot:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:5,borderBottomWidth:1,borderBottomColor:"#eee"},timeSlotInfo:{flexDirection:"row",alignItems:"center"},timeSlotTime:{fontSize:14},timeSlotDetails:{marginLeft:10},timeSlotClient:{fontSize:12,fontWeight:"bold"},timeSlotService:{fontSize:12,color:"#555"},statusChip:{height:30},bookedChip:{backgroundColor:"#FFECB3"},freeChip:{backgroundColor:"#C8E6C9"},bookedChipText:{color:"#F57C00"},freeChipText:{color:"#388E3C"},completedChip:{backgroundColor:"#C8E6C9"},cancelledChip:{backgroundColor:"#FFCDD2"},pendingChip:{backgroundColor:"#E1F5FE"},statusChipText:{fontSize:10},appointmentsCard:{marginBottom:15},appointmentsHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:15},appointmentsTitle:{fontSize:16},appointmentItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:10,borderBottomWidth:1,borderBottomColor:"#eee"},appointmentInfo:{flex:1},appointmentClient:{fontSize:14,fontWeight:"bold"},appointmentService:{fontSize:13,color:"#555"},appointmentDate:{fontSize:12,color:"#888",marginTop:2},modalContent:{backgroundColor:"white",padding:20,margin:20,borderRadius:5},modalTitle:{marginBottom:15,textAlign:"center"},modalButton:{marginTop:20},smallChip:{height:24},smallChipText:{fontSize:8},salonButton:{margin:15,marginTop:5},timeSlotBookingInfo:{marginLeft:10},timeSlotClientName:{fontSize:12,fontWeight:"bold"},timeSlotServiceType:{fontSize:12,color:"#555"},timeSlotStatus:{fontSize:12,color:"#555"},serviceRow:{flexDirection:"row",alignItems:"center"},appointmentBarber:{fontSize:12,color:"#888",marginTop:2},serviceTypeText:{fontSize:10,color:"#888",marginLeft:4}});const ft=function(e){var t=e.navigation,n=(0,s.useContext)(G).userInfo,r=(0,s.useState)(!0),l=(0,o.default)(r,2),d=l[0],u=l[1],c=(0,s.useState)([]),f=(0,o.default)(c,2),m=f[0],h=f[1],p=(0,s.useState)(null),g=(0,o.default)(p,2),y=g[0],x=g[1],b=(0,s.useState)({}),C=(0,o.default)(b,2),v=C[0],T=C[1],k=(0,s.useState)(""),D=(0,o.default)(k,2),F=(D[0],D[1],(0,s.useState)("week")),P=(0,o.default)(F,2),A=P[0],I=P[1],E=(0,s.useState)(!1),O=(0,o.default)(E,2),z=O[0],$=O[1],R=(0,s.useState)([]),M=(0,o.default)(R,2),L=M[0],N=M[1];(0,s.useEffect)((function(){n&&"manager"!==n.role&&"admin"!==n.role?(S.default.alert("Access Denied","Only managers can access this screen."),t.goBack()):_()}),[n]),(0,s.useEffect)((function(){y&&U(y._id)}),[A,y]);var _=function(){var e=(0,a.default)((function*(){try{u(!0);var e=yield W.get("/users/barbers");e.data&&e.data.success?(h(e.data.barbers||[]),e.data.barbers&&e.data.barbers.length>0&&(x(e.data.barbers[0]),U(e.data.barbers[0]._id))):S.default.alert("Error","Failed to load barbers"),u(!1)}catch(t){console.error("Error fetching barbers:",t),u(!1),S.default.alert("Error","Failed to load barbers")}}));return function(){return e.apply(this,arguments)}}(),U=function(){var e=(0,a.default)((function*(e){try{u(!0);var t=yield W.get(`/manager/barber/${e}/stats?period=${A}`,{headers:{Authorization:`Bearer ${n.token}`}}),r=yield W.get(`/manager/barber/${e}/appointments?period=${A}`,{headers:{Authorization:`Bearer ${n.token}`}});if(t.data&&t.data.success&&r.data&&r.data.success){var a=t.data.stats,l=r.data.appointments||[],s=new Date;s.setHours(0,0,0,0);for(var i=l.filter((function(e){var t=new Date(e.date);return t.setHours(0,0,0,0),t.getTime()===s.getTime()})),d=[],c=function*(){var e=9+f,t={time:`${e}:00 - ${e}:30`,status:"free"},n={time:`${e}:30 - ${e+1}:00`,status:"free"};i.forEach((function(r){var a,l,s,i,d=r.startTime.split(":").map(Number),u=(0,o.default)(d,2),c=u[0],f=u[1];c===e&&0===f&&(t.status="booked",t.appointmentId=r._id,t.clientName=(null==(a=r.customer)?void 0:a.name)||"Client",t.service=(null==(l=r.service)?void 0:l.name)||"Service");c===e&&30===f&&(n.status="booked",n.appointmentId=r._id,n.clientName=(null==(s=r.customer)?void 0:s.name)||"Client",n.service=(null==(i=r.service)?void 0:i.name)||"Service")})),d.push(t),d.push(n)},f=0;f<9;f++)yield*c();var m=l.map((function(e){var t,n,r,a,o;return{id:e._id,date:new Date(e.date),formattedDate:(0,ge.default)(new Date(e.date),"MMM dd, yyyy HH:mm"),client:(null==(t=e.customer)?void 0:t.name)||"Unknown Client",barber:(null==(n=e.barber)?void 0:n.name)||"Unknown Barber",service:(null==(r=e.service)?void 0:r.name)||"Unknown Service",serviceType:(null==(a=e.service)?void 0:a.category)||"Unknown Type",price:(null==(o=e.service)?void 0:o.price)||0,status:e.status}}));m.sort((function(e,t){return t.date-e.date})),T({barberId:e,appointmentsCount:a.appointmentsCount||0,clientsCount:a.clientsCount||0,revenue:a.revenue||0,timeSlots:d,utilization:a.utilization||0,clientRetention:a.clientRetention||0,averageRating:a.averageRating||"0.0"}),N(m)}else console.error("Failed to fetch barber stats:",t.data,r.data),S.default.alert("Error","Failed to load barber statistics.");u(!1)}catch(h){console.error("Error fetching barber stats:",h),u(!1),S.default.alert("Error","Failed to load barber statistics. Please try again.")}}));return function(t){return e.apply(this,arguments)}}();return d&&!m.length?(0,H.jsxs)(i.default,{style:ct.centeredContainer,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading dashboard..."})]}):(0,H.jsxs)(i.default,{style:ct.container,children:[(0,H.jsxs)(i.default,{style:ct.header,children:[(0,H.jsx)(w.default,{style:ct.headerTitle,children:"Manager Dashboard"}),(0,H.jsx)(w.default,{style:ct.headerSubtitle,children:"Staff Monitoring"})]}),(0,H.jsx)(B.default,{mode:"contained",icon:"store",onPress:function(){return t.navigate("SalonDashboard")},style:ct.salonButton,children:"Salon Dashboard"}),(0,H.jsxs)(j.default,{style:ct.content,children:[(0,H.jsxs)(i.default,{style:ct.dateFilterContainer,children:[(0,H.jsx)(w.default,{style:ct.sectionTitle,children:"Statistics Period:"}),(0,H.jsxs)(i.default,{style:ct.dateFilterButtons,children:[(0,H.jsx)(B.default,{mode:"day"===A?"contained":"outlined",onPress:function(){return I("day")},style:ct.dateFilterButton,children:"Day"}),(0,H.jsx)(B.default,{mode:"week"===A?"contained":"outlined",onPress:function(){return I("week")},style:ct.dateFilterButton,children:"Week"}),(0,H.jsx)(B.default,{mode:"month"===A?"contained":"outlined",onPress:function(){return I("month")},style:ct.dateFilterButton,children:"Month"})]})]}),(0,H.jsx)(w.default,{style:ct.sectionTitle,children:"Your Staff:"}),(0,H.jsx)(ae.default,{data:m,renderItem:function(e){var t,n=e.item;return(0,H.jsx)(Q.default,{style:[ct.barberCard,(null==y?void 0:y._id)===n._id?ct.selectedBarberCard:null],onPress:function(){return x(e=n),void U(e._id);var e},children:(0,H.jsxs)(Q.default.Content,{style:ct.barberCardContent,children:[(0,H.jsx)(me.default,{size:50,source:{uri:n.profileImage||"https://randomuser.me/api/portraits/men/32.jpg"}}),(0,H.jsxs)(i.default,{style:ct.barberInfo,children:[(0,H.jsx)(te.default,{style:ct.barberName,children:n.name}),(0,H.jsx)(ee.default,{children:(null==(t=n.specialties)?void 0:t.join(", "))||"General Barber"})]})]})})},keyExtractor:function(e){return e._id},horizontal:!0,showsHorizontalScrollIndicator:!1,contentContainerStyle:ct.barberList}),y&&v&&(0,H.jsxs)(i.default,{style:ct.statsContainer,children:[(0,H.jsxs)(w.default,{style:ct.barberStatsTitle,children:["Statistics for ",y.name]}),(0,H.jsxs)(i.default,{style:ct.statsCards,children:[(0,H.jsx)(Q.default,{style:[ct.statsCard,{backgroundColor:"#E3F2FD"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Appointments"}),(0,H.jsx)(te.default,{style:ct.statsValue,children:v.appointmentsCount})]})}),(0,H.jsx)(Q.default,{style:[ct.statsCard,{backgroundColor:"#E8F5E9"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Clients"}),(0,H.jsx)(te.default,{style:ct.statsValue,children:v.clientsCount})]})}),(0,H.jsx)(Q.default,{style:[ct.statsCard,{backgroundColor:"#FFF8E1"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Revenue"}),(0,H.jsxs)(te.default,{style:ct.statsValue,children:["$",v.revenue]})]})})]}),(0,H.jsx)(Q.default,{style:ct.metricsCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:ct.metricsTitle,children:"Performance Metrics"}),(0,H.jsxs)(i.default,{style:ct.metricRow,children:[(0,H.jsx)(w.default,{style:ct.metricLabel,children:"Utilization"}),(0,H.jsxs)(w.default,{style:ct.metricValue,children:[v.utilization,"%"]})]}),(0,H.jsx)(it.default,{progress:v.utilization/100,color:"#2196F3",style:ct.progressBar}),(0,H.jsxs)(i.default,{style:ct.metricRow,children:[(0,H.jsx)(w.default,{style:ct.metricLabel,children:"Client Retention"}),(0,H.jsxs)(w.default,{style:ct.metricValue,children:[v.clientRetention,"%"]})]}),(0,H.jsx)(it.default,{progress:v.clientRetention/100,color:"#4CAF50",style:ct.progressBar}),(0,H.jsxs)(i.default,{style:ct.metricRow,children:[(0,H.jsx)(w.default,{style:ct.metricLabel,children:"Average Rating"}),(0,H.jsxs)(i.default,{style:ct.ratingContainer,children:[(0,H.jsx)(w.default,{style:ct.metricValue,children:v.averageRating}),(0,H.jsx)(ut.default,{name:"star",size:16,color:"#FFC107",style:ct.starIcon})]})]})]})}),(0,H.jsx)(Q.default,{style:ct.scheduleCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:ct.scheduleHeader,children:[(0,H.jsx)(te.default,{style:ct.scheduleTitle,children:"Today's Schedule"}),(0,H.jsx)(w.default,{style:ct.scheduleDate,children:(0,ge.default)(new Date,"MMMM d, yyyy")})]}),(0,H.jsx)(ae.default,{data:v.timeSlots,renderItem:function(e){var t=e.item;return(0,H.jsxs)(i.default,{style:[ct.timeSlot,"booked"===t.status?ct.bookedSlot:ct.freeSlot],children:[(0,H.jsx)(w.default,{style:ct.timeSlotTime,children:t.time}),"booked"===t.status?(0,H.jsxs)(i.default,{style:ct.timeSlotBookingInfo,children:[(0,H.jsx)(w.default,{style:ct.timeSlotClientName,children:t.clientName}),(0,H.jsx)(w.default,{style:ct.timeSlotService,children:t.service}),t.serviceType&&(0,H.jsx)(w.default,{style:ct.timeSlotServiceType,children:t.serviceType})]}):(0,H.jsx)(w.default,{style:ct.timeSlotStatus,children:"Free"})]})},keyExtractor:function(e,t){return`time-${t}`},style:ct.timeSlotList,scrollEnabled:!1})]})}),(0,H.jsx)(Q.default,{style:ct.appointmentsCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsxs)(i.default,{style:ct.appointmentsHeader,children:[(0,H.jsx)(te.default,{style:ct.appointmentsTitle,children:"Recent Appointments"}),(0,H.jsx)(B.default,{mode:"text",onPress:function(){$(!0)},children:"See All"})]}),L.slice(0,5).map((function(e,t){return(0,H.jsxs)(i.default,{style:ct.appointmentItem,children:[(0,H.jsxs)(i.default,{style:ct.appointmentInfo,children:[(0,H.jsx)(w.default,{style:ct.appointmentClient,children:e.client}),(0,H.jsxs)(i.default,{style:ct.serviceRow,children:[(0,H.jsx)(w.default,{style:ct.appointmentService,children:e.service}),(0,H.jsx)(w.default,{style:ct.appointmentServiceType,children:"Unknown Type"!==e.serviceType?`(${e.serviceType})`:""})]}),(0,H.jsx)(w.default,{style:ct.appointmentDate,children:e.formattedDate}),(0,H.jsxs)(w.default,{style:ct.appointmentBarber,children:["Barber: ","Unknown Barber"!==e.barber?e.barber:"Not assigned"]})]}),(0,H.jsx)(le.default,{style:[ct.statusChip,"completed"===e.status?ct.completedChip:"cancelled"===e.status?ct.cancelledChip:ct.pendingChip],textStyle:ct.statusChipText,children:e.status.toUpperCase()})]},e.id)}))]})})]})]}),(0,H.jsx)(ve.default,{children:(0,H.jsxs)(Ve.default,{visible:z,onDismiss:function(){return $(!1)},contentContainerStyle:ct.modalContent,children:[(0,H.jsxs)(te.default,{style:ct.modalTitle,children:[null==y?void 0:y.name,"'s Appointments"]}),(0,H.jsxs)(dt.default,{children:[(0,H.jsxs)(dt.default.Header,{children:[(0,H.jsx)(dt.default.Title,{children:"Date"}),(0,H.jsx)(dt.default.Title,{children:"Client"}),(0,H.jsx)(dt.default.Title,{children:"Service"}),(0,H.jsx)(dt.default.Title,{children:"Barber"}),(0,H.jsx)(dt.default.Title,{numeric:!0,children:"Price"}),(0,H.jsx)(dt.default.Title,{children:"Status"})]}),(0,H.jsx)(j.default,{style:{maxHeight:400},children:L.map((function(e){return(0,H.jsxs)(dt.default.Row,{children:[(0,H.jsx)(dt.default.Cell,{children:(0,ge.default)(e.date,"MM/dd HH:mm")}),(0,H.jsx)(dt.default.Cell,{children:e.client}),(0,H.jsxs)(dt.default.Cell,{children:[e.service,(0,H.jsx)(w.default,{style:ct.serviceTypeText,children:"Unknown Type"!==e.serviceType?`(${e.serviceType})`:""})]}),(0,H.jsx)(dt.default.Cell,{children:"Unknown Barber"!==e.barber?e.barber:"Not assigned"}),(0,H.jsxs)(dt.default.Cell,{numeric:!0,children:["$",e.price]}),(0,H.jsx)(dt.default.Cell,{children:(0,H.jsx)(le.default,{style:[ct.smallChip,"completed"===e.status?ct.completedChip:"cancelled"===e.status?ct.cancelledChip:ct.pendingChip],textStyle:ct.smallChipText,children:e.status.substr(0,4).toUpperCase()})})]},e.id)}))})]}),(0,H.jsx)(B.default,{mode:"contained",onPress:function(){return $(!1)},style:ct.modalButton,children:"Close"})]})})]})};var mt=n(58647),ht=n(26725).default.get("window").width-40,pt=x.default.create({container:{flex:1,backgroundColor:"#f5f5f5"},centeredContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f5f5f5"},header:{backgroundColor:"#0F4C75",padding:20,paddingTop:50,paddingBottom:20},headerTitle:{fontSize:24,fontWeight:"bold",color:"white"},headerSubtitle:{fontSize:18,color:"#BBE1FA",marginTop:5},content:{flex:1,padding:15},tabContainer:{flexDirection:"row",backgroundColor:"#fff",elevation:2},tab:{flex:1,paddingVertical:15,alignItems:"center",justifyContent:"center"},activeTab:{borderBottomWidth:2,borderBottomColor:"#0F4C75"},tabText:{fontSize:16,color:"#555"},activeTabText:{color:"#0F4C75",fontWeight:"bold"},dateFilterContainer:{marginBottom:15},dateFilterButtons:{flexDirection:"row",marginTop:10},dateFilterButton:{marginRight:10},sectionTitle:{fontSize:18,fontWeight:"bold",color:"#1B262C",marginBottom:10},statsContainer:{marginBottom:20},statsCards:{flexDirection:"row",justifyContent:"space-between",marginBottom:15},statsCard:{flex:1,marginRight:10},statsValue:{fontSize:20,fontWeight:"bold"},chartCard:{marginBottom:15},chartTitle:{fontSize:18,marginBottom:10},chart:{marginVertical:8,borderRadius:16},statusCard:{marginBottom:15},statusTitle:{fontSize:18,marginBottom:15},statusRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:5},statusLabel:{fontSize:14},statusValue:{fontSize:14,fontWeight:"bold"},progressBar:{height:8,borderRadius:4,marginBottom:15},searchBar:{marginBottom:15,elevation:1},customerCount:{fontSize:16,marginBottom:10,color:"#555"},customerCard:{marginBottom:10},customerCardContent:{flexDirection:"row"},customerInfo:{flex:1},customerName:{fontSize:18},customerMetrics:{flexDirection:"row",marginTop:10},customerMetric:{marginRight:8},lastVisit:{marginTop:8,fontStyle:"italic"},emptyContainer:{padding:20,alignItems:"center",justifyContent:"center"},emptyText:{fontSize:16,color:"#555"},staffContainer:{marginBottom:20},staffCard:{marginBottom:10},staffCardContent:{flexDirection:"row"},staffInfo:{marginLeft:15,flex:1},staffName:{fontSize:16},specialtiesContainer:{flexDirection:"row",flexWrap:"wrap",marginTop:5},specialtyChip:{marginRight:5,marginBottom:5,backgroundColor:"#E1F5FE"},appointmentInfo:{flexDirection:"row",alignItems:"center",marginBottom:10},appointmentClient:{flex:1,fontSize:16},serviceRow:{flexDirection:"row",alignItems:"center"},appointmentService:{fontSize:16},appointmentServiceType:{fontSize:14,fontStyle:"italic"},appointmentDate:{fontSize:14,color:"#555"},appointmentBarber:{fontSize:14,color:"#555"},serviceTypeText:{fontSize:14,fontStyle:"italic"}});const gt=function(e){var t=e.route,n=e.navigation,r=(t.params||{}).salonId,l=(0,s.useContext)(G).userInfo,d=(0,s.useState)(!0),u=(0,o.default)(d,2),c=u[0],f=u[1],m=(0,s.useState)(null),h=(0,o.default)(m,2),p=h[0],g=h[1],y=(0,s.useState)(null),x=(0,o.default)(y,2),b=x[0],v=x[1],T=(0,s.useState)([]),k=(0,o.default)(T,2),D=k[0],F=k[1],P=(0,s.useState)("week"),A=(0,o.default)(P,2),I=A[0],E=A[1],O=(0,s.useState)(""),z=(0,o.default)(O,2),$=z[0],R=z[1],M=(0,s.useState)("stats"),L=(0,o.default)(M,2),N=L[0],_=L[1];(0,s.useEffect)((function(){U()}),[r]),(0,s.useEffect)((function(){p&&V()}),[I,p]);var U=function(){var e=(0,a.default)((function*(){try{if(f(!0),r){var e=yield W.get(`/salons/${r}`,{headers:{Authorization:`Bearer ${l.token}`}});e.data&&e.data.success?(g(e.data.salon),V(r),q(r)):(S.default.alert("Error","Failed to load salon details"),f(!1))}else{var t=yield W.get("/manager/salons",{headers:{Authorization:`Bearer ${l.token}`}});if(!(t.data&&t.data.success&&t.data.salons.length>0))return S.default.alert("Error","No salons found for this manager"),void f(!1);g(t.data.salons[0]),V(t.data.salons[0]._id),q(t.data.salons[0]._id)}}catch(n){console.error("Error fetching salon:",n),f(!1),S.default.alert("Error","Failed to load salon: "+(n.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,a.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;try{f(!0);var t=e||p._id,n=yield W.get(`/manager/salon/${t}/stats?period=${I}`,{headers:{Authorization:`Bearer ${l.token}`}});n.data&&n.data.success?v(n.data.stats):S.default.alert("Error","Failed to load salon statistics"),f(!1)}catch(a){console.error("Error fetching salon stats:",a),f(!1),S.default.alert("Error","Failed to load salon statistics: "+(a.message||"Unknown error"))}}));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,a.default)((function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;try{var t=e||p._id,n=yield W.get(`/manager/salon/${t}/customers`,{headers:{Authorization:`Bearer ${l.token}`}});n.data&&n.data.success?F(n.data.customers):console.error("Failed to load customers:",n.data)}catch(a){console.error("Error fetching customers:",a)}}));return function(){return e.apply(this,arguments)}}(),Y=D.filter((function(e){return e.name.toLowerCase().includes($.toLowerCase())||e.email.toLowerCase().includes($.toLowerCase())||e.phone&&e.phone.includes($)}));appointments.map((function(e){var t,n,r,a,o;return{id:e._id,date:new Date(e.date),formattedDate:(0,ge.default)(new Date(e.date),"MMM dd, yyyy HH:mm"),client:(null==(t=e.customer)?void 0:t.name)||"Unknown Client",barber:(null==(n=e.barber)?void 0:n.name)||"Unknown Barber",service:(null==(r=e.service)?void 0:r.name)||"Unknown Service",serviceType:(null==(a=e.service)?void 0:a.category)||"Unknown Type",price:(null==(o=e.service)?void 0:o.price)||0,status:e.status}}));return c&&!p?(0,H.jsxs)(i.default,{style:pt.centeredContainer,children:[(0,H.jsx)(X.default,{size:"large",color:"#0F4C75"}),(0,H.jsx)(w.default,{style:{marginTop:20},children:"Loading salon dashboard..."})]}):(0,H.jsxs)(i.default,{style:pt.container,children:[(0,H.jsxs)(i.default,{style:pt.header,children:[(0,H.jsx)(w.default,{style:pt.headerTitle,children:"Salon Dashboard"}),p&&(0,H.jsx)(w.default,{style:pt.headerSubtitle,children:p.name})]}),(0,H.jsxs)(i.default,{style:pt.tabContainer,children:[(0,H.jsx)(C.default,{style:[pt.tab,"stats"===N&&pt.activeTab],onPress:function(){return _("stats")},children:(0,H.jsx)(w.default,{style:[pt.tabText,"stats"===N&&pt.activeTabText],children:"Stats"})}),(0,H.jsx)(C.default,{style:[pt.tab,"customers"===N&&pt.activeTab],onPress:function(){return _("customers")},children:(0,H.jsx)(w.default,{style:[pt.tabText,"customers"===N&&pt.activeTabText],children:"Customers"})}),(0,H.jsx)(C.default,{style:[pt.tab,"appointments"===N&&pt.activeTab],onPress:function(){return _("appointments")},children:(0,H.jsx)(w.default,{style:[pt.tabText,"appointments"===N&&pt.activeTabText],children:"Staff"})})]}),(0,H.jsxs)(j.default,{style:pt.content,children:["stats"===N&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsxs)(i.default,{style:pt.dateFilterContainer,children:[(0,H.jsx)(w.default,{style:pt.sectionTitle,children:"Statistics Period:"}),(0,H.jsxs)(i.default,{style:pt.dateFilterButtons,children:[(0,H.jsx)(B.default,{mode:"day"===I?"contained":"outlined",onPress:function(){return E("day")},style:pt.dateFilterButton,children:"Day"}),(0,H.jsx)(B.default,{mode:"week"===I?"contained":"outlined",onPress:function(){return E("week")},style:pt.dateFilterButton,children:"Week"}),(0,H.jsx)(B.default,{mode:"month"===I?"contained":"outlined",onPress:function(){return E("month")},style:pt.dateFilterButton,children:"Month"})]})]}),b&&(0,H.jsxs)(i.default,{style:pt.statsContainer,children:[(0,H.jsxs)(i.default,{style:pt.statsCards,children:[(0,H.jsx)(Q.default,{style:[pt.statsCard,{backgroundColor:"#E3F2FD"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Appointments"}),(0,H.jsx)(te.default,{style:pt.statsValue,children:b.appointmentsCount})]})}),(0,H.jsx)(Q.default,{style:[pt.statsCard,{backgroundColor:"#E8F5E9"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Customers"}),(0,H.jsx)(te.default,{style:pt.statsValue,children:b.clientsCount})]})}),(0,H.jsx)(Q.default,{style:[pt.statsCard,{backgroundColor:"#FFF8E1"}],children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(ee.default,{children:"Revenue"}),(0,H.jsxs)(te.default,{style:pt.statsValue,children:["$",b.revenue]})]})})]}),(0,H.jsx)(Q.default,{style:pt.chartCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:pt.chartTitle,children:"Daily Appointments"}),(0,H.jsx)(mt.BarChart,{data:function(){if(!b||!b.dailyAppointments)return{labels:["No Data"],datasets:[{data:[0]}]};var e=Object.keys(b.dailyAppointments).sort().slice(-7);return{labels:e.map((function(e){var t=e.split("-"),n=(0,o.default)(t,3);n[0];return`${n[1]}/${n[2]}`})),datasets:[{data:e.map((function(e){return b.dailyAppointments[e]||0}))}]}}(),width:ht,height:220,yAxisLabel:"",chartConfig:{backgroundColor:"#ffffff",backgroundGradientFrom:"#ffffff",backgroundGradientTo:"#ffffff",decimalPlaces:0,color:function(){return`rgba(15, 76, 117, ${arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})`},labelColor:function(){return`rgba(0, 0, 0, ${arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})`},style:{borderRadius:16}},style:pt.chart})]})}),(0,H.jsx)(Q.default,{style:pt.statusCard,children:(0,H.jsxs)(Q.default.Content,{children:[(0,H.jsx)(te.default,{style:pt.statusTitle,children:"Appointment Status"}),(0,H.jsxs)(i.default,{style:pt.statusRow,children:[(0,H.jsx)(w.default,{style:pt.statusLabel,children:"Pending"}),(0,H.jsx)(w.default,{style:pt.statusValue,children:b.statusCounts.pending})]}),(0,H.jsx)(it.default,{progress:b.appointmentsCount>0?b.statusCounts.pending/b.appointmentsCount:0,color:"#FFC107",style:pt.progressBar}),(0,H.jsxs)(i.default,{style:pt.statusRow,children:[(0,H.jsx)(w.default,{style:pt.statusLabel,children:"Confirmed"}),(0,H.jsx)(w.default,{style:pt.statusValue,children:b.statusCounts.confirmed})]}),(0,H.jsx)(it.default,{progress:b.appointmentsCount>0?b.statusCounts.confirmed/b.appointmentsCount:0,color:"#2196F3",style:pt.progressBar}),(0,H.jsxs)(i.default,{style:pt.statusRow,children:[(0,H.jsx)(w.default,{style:pt.statusLabel,children:"Completed"}),(0,H.jsx)(w.default,{style:pt.statusValue,children:b.statusCounts.completed})]}),(0,H.jsx)(it.default,{progress:b.appointmentsCount>0?b.statusCounts.completed/b.appointmentsCount:0,color:"#4CAF50",style:pt.progressBar}),(0,H.jsxs)(i.default,{style:pt.statusRow,children:[(0,H.jsx)(w.default,{style:pt.statusLabel,children:"Cancelled"}),(0,H.jsx)(w.default,{style:pt.statusValue,children:b.statusCounts.cancelled})]}),(0,H.jsx)(it.default,{progress:b.appointmentsCount>0?b.statusCounts.cancelled/b.appointmentsCount:0,color:"#F44336",style:pt.progressBar})]})})]})]}),"customers"===N&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(oe.default,{placeholder:"Search customers...",onChangeText:function(e){return R(e)},value:$,style:pt.searchBar}),(0,H.jsxs)(w.default,{style:pt.customerCount,children:[Y.length," ",1===Y.length?"Customer":"Customers"]}),0===Y.length?(0,H.jsx)(i.default,{style:pt.emptyContainer,children:(0,H.jsx)(w.default,{style:pt.emptyText,children:"No customers found"})}):Y.map((function(e){return function(e){var t=e.item;return(0,H.jsx)(Q.default,{style:pt.customerCard,children:(0,H.jsx)(Q.default.Content,{style:pt.customerCardContent,children:(0,H.jsxs)(i.default,{style:pt.customerInfo,children:[(0,H.jsx)(te.default,{style:pt.customerName,children:t.name}),(0,H.jsx)(ee.default,{children:t.email}),(0,H.jsx)(ee.default,{children:t.phone||"No phone"}),(0,H.jsxs)(i.default,{style:pt.customerMetrics,children:[(0,H.jsxs)(le.default,{style:pt.customerMetric,children:["Visits: ",t.visits]}),(0,H.jsxs)(le.default,{style:pt.customerMetric,children:["Spent: $",t.totalSpent]})]}),t.lastVisit&&(0,H.jsxs)(ee.default,{style:pt.lastVisit,children:["Last visit: ",(0,ge.default)(new Date(t.lastVisit),"MMM dd, yyyy")]})]})})})}({item:e})}))]}),"appointments"===N&&p&&(0,H.jsxs)(H.Fragment,{children:[(0,H.jsx)(w.default,{style:pt.sectionTitle,children:"Staff Members"}),p.staff&&p.staff.length>0?(0,H.jsx)(i.default,{style:pt.staffContainer,children:p.staff.map((function(e){var t;return(0,H.jsxs)(Q.default,{style:pt.staffCard,children:[(0,H.jsxs)(Q.default.Content,{style:pt.staffCardContent,children:[(0,H.jsx)(me.default,{size:50,source:{uri:e.profileImage||"https://randomuser.me/api/portraits/men/32.jpg"}}),(0,H.jsxs)(i.default,{style:pt.staffInfo,children:[(0,H.jsx)(te.default,{style:pt.staffName,children:e.name}),(0,H.jsx)(ee.default,{children:e.role}),(0,H.jsx)(i.default,{style:pt.specialtiesContainer,children:null==(t=e.specialties)?void 0:t.map((function(e,t){return(0,H.jsx)(le.default,{style:pt.specialtyChip,children:e},t)}))})]})]}),(0,H.jsx)(Q.default.Actions,{children:(0,H.jsx)(B.default,{onPress:function(){return n.navigate("ManagerDashboard",{barber:e})},children:"View Performance"})})]},e._id)}))}):(0,H.jsx)(i.default,{style:pt.emptyContainer,children:(0,H.jsx)(w.default,{style:pt.emptyText,children:"No staff members found for this salon"})})]})]})]})};n(74037);var yt=n(51181);x.default.create({container:{flex:1,padding:20},title:{fontSize:24,fontWeight:"bold",marginBottom:20},settingItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:15,borderBottomWidth:1,borderBottomColor:"#e0e0e0"},settingLabel:{fontSize:16},themeToggleContainer:{flexDirection:"row",alignItems:"center"},switch:{marginHorizontal:10},button:{marginTop:30,padding:15,borderRadius:8,alignItems:"center"},buttonText:{color:"white",fontWeight:"bold",fontSize:16}});var xt=n(94780);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ct={primary:{light:"#0F4C75",dark:"#3282B8"},secondary:{light:"#3282B8",dark:"#0F4C75"},accent:{light:"#BBE1FA",dark:"#5DA3FA"},background:{light:"#F5F5F5",dark:"#1B262C"},surface:{light:"#FFFFFF",dark:"#222831"},text:{light:"#1B262C",dark:"#F5F5F5"},disabled:{light:"#C5C5C5",dark:"#6B6B6B"},placeholder:{light:"#A0A0A0",dark:"#8D8D8D"},backdrop:{light:"rgba(0, 0, 0, 0.5)",dark:"rgba(0, 0, 0, 0.7)"},notification:{light:"#FF4500",dark:"#FF6347"},success:{light:"#4CAF50",dark:"#81C784"},warning:{light:"#FFC107",dark:"#FFD54F"},error:{light:"#F44336",dark:"#E57373"}},vt=bt(bt({},yt.DefaultTheme),{},{dark:!1,roundness:8,colors:bt(bt({},yt.DefaultTheme.colors),{},{primary:Ct.primary.light,accent:Ct.accent.light,background:Ct.background.light,surface:Ct.surface.light,text:Ct.text.light,disabled:Ct.disabled.light,placeholder:Ct.placeholder.light,backdrop:Ct.backdrop.light,notification:Ct.notification.light,success:Ct.success.light,warning:Ct.warning.light,error:Ct.error.light,secondary:Ct.secondary.light}),fonts:bt(bt({},yt.DefaultTheme.fonts),{},{regular:{fontFamily:"sans-serif",fontWeight:"normal"},medium:{fontFamily:"sans-serif-medium",fontWeight:"500"},light:{fontFamily:"sans-serif-light",fontWeight:"300"},thin:{fontFamily:"sans-serif-thin",fontWeight:"100"}}),animation:{scale:1}}),St=bt(bt({},xt.MD3DarkTheme),{},{dark:!0,roundness:8,colors:bt(bt({},xt.MD3DarkTheme.colors),{},{primary:Ct.primary.dark,accent:Ct.accent.dark,background:Ct.background.dark,surface:Ct.surface.dark,text:Ct.text.dark,disabled:Ct.disabled.dark,placeholder:Ct.placeholder.dark,backdrop:Ct.backdrop.dark,notification:Ct.notification.dark,success:Ct.success.dark,warning:Ct.warning.dark,error:Ct.error.dark,secondary:Ct.secondary.dark}),fonts:bt(bt({},yt.DefaultTheme.fonts),{},{regular:{fontFamily:"sans-serif",fontWeight:"normal"},medium:{fontFamily:"sans-serif-medium",fontWeight:"500"},light:{fontFamily:"sans-serif-light",fontWeight:"300"},thin:{fontFamily:"sans-serif-thin",fontWeight:"100"}}),animation:{scale:1}});const wt={LightTheme:vt,CustomDarkTheme:St,colors:Ct};var Tt=(0,s.createContext)(),Bt=function(e){var t=e.children,n=(0,s.useState)(!1),l=(0,o.default)(n,2),i=l[0],d=l[1],u=(0,s.useState)(vt),c=(0,o.default)(u,2),f=c[0],m=c[1],p=(0,s.useState)(!0),g=(0,o.default)(p,2),y=g[0],x=g[1];(0,s.useEffect)((function(){var e=function(){var e=(0,a.default)((function*(){try{x(!0),"dark"===(yield h.default.getItem("themePreference"))?(d(!0),m(r.DarkTheme)):(d(!1),m(vt))}catch(e){console.error("Erreur lors du chargement des pr\xe9f\xe9rences de th\xe8me:",e),d(!1),m(vt)}finally{x(!1)}}));return function(){return e.apply(this,arguments)}}();e()}),[]);var j=function(){var e=(0,a.default)((function*(){try{var e=!i;d(e),m(e?r.DarkTheme:vt),yield h.default.setItem("themePreference",e?"dark":"light")}catch(t){console.error("Erreur lors de la sauvegarde des pr\xe9f\xe9rences de th\xe8me:",t)}}));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,a.default)((function*(e){try{var t="dark"===e;d(t),m(t?r.DarkTheme:vt),yield h.default.setItem("themePreference",e)}catch(n){console.error("Erreur lors de la sauvegarde des pr\xe9f\xe9rences de th\xe8me:",n)}}));return function(t){return e.apply(this,arguments)}}();return(0,H.jsx)(Tt.Provider,{value:{theme:f,isDarkMode:i,toggleTheme:j,setThemeMode:b,isLoading:y},children:t})};function kt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kt(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ft=(0,f.default)(),Pt=(0,m.default)(),At=Dt(Dt({},DefaultTheme),{},{colors:Dt(Dt({},DefaultTheme.colors),{},{primary:"#0F4C75",accent:"#3282B8",background:"#F5F5F5",text:"#1B262C"})}),It=function(){return(0,H.jsxs)(Pt.Navigator,{screenOptions:function(e){var t=e.route;return{tabBarIcon:function(e){var n,r=e.focused,a=e.color,o=e.size;return"Home"===t.name?n=r?"home":"home-outline":"Services"===t.name?n=r?"list":"list-outline":"Appointments"===t.name?n=r?"calendar":"calendar-outline":"Profile"===t.name&&(n=r?"person":"person-outline"),(0,H.jsx)(g.default,{name:n,size:o,color:a})},tabBarActiveTintColor:At.colors.primary,tabBarInactiveTintColor:"gray",headerShown:!1}},children:[(0,H.jsx)(Pt.Screen,{name:"Home",component:re}),(0,H.jsx)(Pt.Screen,{name:"Services",component:ce}),(0,H.jsx)(Pt.Screen,{name:"Appointments",component:De}),(0,H.jsx)(Pt.Screen,{name:"Profile",component:Me})]})},Et=function(){return(0,H.jsxs)(Pt.Navigator,{screenOptions:function(e){var t=e.route;return{tabBarIcon:function(e){var n,r=e.focused,a=e.color,o=e.size;return"Dashboard"===t.name?n=r?"grid":"grid-outline":"Services"===t.name?n=r?"list":"list-outline":"Appointments"===t.name?n=r?"calendar":"calendar-outline":"Profile"===t.name&&(n=r?"person":"person-outline"),(0,H.jsx)(g.default,{name:n,size:o,color:a})},tabBarActiveTintColor:At.colors.primary,tabBarInactiveTintColor:"gray",headerShown:!1}},children:[(0,H.jsx)(Pt.Screen,{name:"Dashboard",component:et,options:{title:"Admin Dashboard"}}),(0,H.jsx)(Pt.Screen,{name:"Services",component:ce}),(0,H.jsx)(Pt.Screen,{name:"Appointments",component:Ue}),(0,H.jsx)(Pt.Screen,{name:"Profile",component:Me})]})},Ot=function(){return(0,H.jsxs)(Pt.Navigator,{screenOptions:function(e){var t=e.route;return{tabBarIcon:function(e){var n,r=e.focused,a=e.color,o=e.size;return"Dashboard"===t.name?n=r?"grid":"grid-outline":"Appointments"===t.name?n=r?"calendar":"calendar-outline":"Profile"===t.name&&(n=r?"person":"person-outline"),(0,H.jsx)(g.default,{name:n,size:o,color:a})},tabBarActiveTintColor:At.colors.primary,tabBarInactiveTintColor:"gray",headerShown:!1}},children:[(0,H.jsx)(Pt.Screen,{name:"Dashboard",component:Je,options:{title:"My Schedule"}}),(0,H.jsx)(Pt.Screen,{name:"Appointments",component:Ue,options:{title:"Appointments"}}),(0,H.jsx)(Pt.Screen,{name:"Profile",component:Me})]})},zt=function(){return(0,H.jsxs)(Pt.Navigator,{screenOptions:function(e){var t=e.route;return{tabBarIcon:function(e){var n,r=e.focused,a=e.color,o=e.size;return"Dashboard"===t.name?n=r?"grid":"grid-outline":"Services"===t.name?n=r?"list":"list-outline":"Appointments"===t.name?n=r?"calendar":"calendar-outline":"Profile"===t.name&&(n=r?"person":"person-outline"),(0,H.jsx)(g.default,{name:n,size:o,color:a})},tabBarActiveTintColor:At.colors.primary,tabBarInactiveTintColor:"gray",headerShown:!1}},children:[(0,H.jsx)(Pt.Screen,{name:"Dashboard",component:ft,options:{title:"Manager Dashboard"}}),(0,H.jsx)(Pt.Screen,{name:"Services",component:ce}),(0,H.jsx)(Pt.Screen,{name:"Appointments",component:Ue}),(0,H.jsx)(Pt.Screen,{name:"Profile",component:Me})]})},$t=function(){return(0,H.jsxs)(Ft.Navigator,{screenOptions:{headerShown:!1},children:[(0,H.jsx)(Ft.Screen,{name:"Login",component:J}),(0,H.jsx)(Ft.Screen,{name:"Register",component:K})]})},Rt=function(){var e=(0,s.useState)(!1),t=(0,o.default)(e,2),n=t[0],r=t[1],l=(0,s.useState)(!0),c=(0,o.default)(l,2),f=c[0],m=c[1],p=(0,s.useContext)(G),g=p.userToken,y=p.userInfo,x=(0,s.useState)("customer"),j=(0,o.default)(x,2),b=j[0],C=j[1];if((0,s.useEffect)((function(){var e=function(){var e=(0,a.default)((function*(){try{m(!0);var e=yield h.default.getItem("userToken"),t=yield h.default.getItem("userInfo");console.log("Auth check - token present:",!!e),console.log("Auth check - userInfo present:",!!t);var n=!(!e||!t);if(r(n),n&&t){var a=JSON.parse(t);C(a.role||"customer"),console.log("User role set to:",a.role||"customer")}}catch(o){console.error("Error checking login status:",o),r(!1)}finally{m(!1)}}));return function(){return e.apply(this,arguments)}}();e()}),[g,y]),f)return(0,H.jsxs)(i.default,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:[(0,H.jsx)(d.default,{size:"large",color:At.colors.primary}),(0,H.jsx)(u.default,{style:{marginTop:10},children:"Loading..."})]});return(0,H.jsxs)(Ft.Navigator,{screenOptions:{headerShown:!1},children:[n?(0,H.jsx)(Ft.Screen,{name:"Main",component:function(){switch(b){case"admin":return Et;case"manager":return zt;case"barber":return Ot;default:return It}}()}):(0,H.jsx)(Ft.Screen,{name:"Auth",component:$t}),(0,H.jsx)(Ft.Screen,{name:"Booking",component:xe,options:{headerShown:!0,title:"Book Appointment"}}),(0,H.jsx)(Ft.Screen,{name:"AdminDashboard",component:et,options:{headerShown:!0,title:"Admin Dashboard"}}),(0,H.jsx)(Ft.Screen,{name:"ManagerDashboard",component:ft,options:{headerShown:!0,title:"Manager Dashboard"}}),(0,H.jsx)(Ft.Screen,{name:"BarberAppointments",component:Ue,options:{headerShown:!0,title:"Appointments"}}),(0,H.jsx)(Ft.Screen,{name:"SalonDetails",component:at,options:{headerShown:!0,title:"Edit Salon"}}),(0,H.jsx)(Ft.Screen,{name:"SalonStaff",component:st,options:{headerShown:!0,title:"Salon Staff"}}),(0,H.jsx)(Ft.Screen,{name:"SalonDashboard",component:gt,options:{headerShown:!0,title:"Salon Dashboard"}})]})};function Mt(){return(0,H.jsx)(Bt,{children:(0,H.jsx)(Tt.Consumer,{children:function(e){var t=e.theme,n=e.isDarkMode;return(0,H.jsx)(q,{children:(0,H.jsx)(y.default,{theme:t,children:(0,H.jsxs)(c.default,{ref:Lt,theme:t,children:[(0,H.jsx)(p.default,{style:n?"light":"dark"}),(0,H.jsx)(Rt,{})]})})})}})})}var Lt=(0,s.createRef)();function Nt(e){var t;null==(t=Lt.current)||t.navigate(e)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e=[];n.O=(t,r,a,o)=>{if(!r){var l=1/0;for(u=0;u<e.length;u++){for(var[r,a,o]=e[u],s=!0,i=0;i<r.length;i++)(!1&o||l>=o)&&Object.keys(n.O).every((e=>n.O[e](r[i])))?r.splice(i--,1):(s=!1,o<l&&(l=o));if(s){e.splice(u--,1);var d=a();void 0!==d&&(t=d)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[r,a,o]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var o=Object.create(null);n.r(o);var l={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>l[e]=()=>r[e]));return l.default=()=>r,n.d(o,l),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var a,o,[l,s,i]=r,d=0;if(l.some((t=>0!==e[t]))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(i)var u=i(n)}for(t&&t(r);d<l.length;d++)o=l[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(u)},r=self.webpackChunkweb=self.webpackChunkweb||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,[947],(()=>n(55819)));r=n.O(r)})();
//# sourceMappingURL=main.768600e2.js.map