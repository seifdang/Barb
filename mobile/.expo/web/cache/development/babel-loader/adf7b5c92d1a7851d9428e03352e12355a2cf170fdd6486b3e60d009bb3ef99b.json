{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport { Text, Card, Title, Paragraph, Button, ActivityIndicator, Chip, FAB, Divider, Banner, Dialog, Portal } from 'react-native-paper';\nimport { format } from 'date-fns';\nimport { appointmentsApi } from \"../../api/client\";\nimport { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"react/jsx-runtime\";\nvar sampleAppointments = [{\n  _id: '1',\n  service: {\n    _id: '101',\n    name: 'Classic Haircut',\n    price: 25,\n    duration: 30\n  },\n  barber: {\n    _id: '201',\n    name: 'John Barber'\n  },\n  date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(),\n  startTime: '10:00',\n  endTime: '10:30',\n  status: 'confirmed'\n}, {\n  _id: '2',\n  service: {\n    _id: '102',\n    name: 'Beard Trim',\n    price: 15,\n    duration: 20\n  },\n  barber: {\n    _id: '202',\n    name: 'Mike Scissors'\n  },\n  date: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString(),\n  startTime: '14:00',\n  endTime: '14:20',\n  status: 'pending'\n}, {\n  _id: '3',\n  service: {\n    _id: '103',\n    name: 'Premium Package',\n    price: 45,\n    duration: 60\n  },\n  barber: {\n    _id: '203',\n    name: 'Sarah Style'\n  },\n  date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),\n  startTime: '11:00',\n  endTime: '12:00',\n  status: 'completed'\n}, {\n  _id: '4',\n  service: {\n    _id: '104',\n    name: 'Hair Coloring',\n    price: 60,\n    duration: 90\n  },\n  barber: {\n    _id: '204',\n    name: 'Alex Color'\n  },\n  date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),\n  startTime: '09:00',\n  endTime: '10:30',\n  status: 'cancelled'\n}];\nvar AppointmentsScreen = function AppointmentsScreen(_ref) {\n  var navigation = _ref.navigation;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    appointments = _useState2[0],\n    setAppointments = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(false),\n    _useState6 = _slicedToArray(_useState5, 2),\n    refreshing = _useState6[0],\n    setRefreshing = _useState6[1];\n  var _useState7 = useState(null),\n    _useState8 = _slicedToArray(_useState7, 2),\n    error = _useState8[0],\n    setError = _useState8[1];\n  var _useState9 = useState('upcoming'),\n    _useState10 = _slicedToArray(_useState9, 2),\n    activeTab = _useState10[0],\n    setActiveTab = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    usingSampleData = _useState12[0],\n    setUsingSampleData = _useState12[1];\n  var _useState13 = useState(''),\n    _useState14 = _slicedToArray(_useState13, 2),\n    cancellationReason = _useState14[0],\n    setCancellationReason = _useState14[1];\n  var _useState15 = useState(false),\n    _useState16 = _slicedToArray(_useState15, 2),\n    dialogVisible = _useState16[0],\n    setDialogVisible = _useState16[1];\n  var _useState17 = useState(null),\n    _useState18 = _slicedToArray(_useState17, 2),\n    appointmentToCancel = _useState18[0],\n    setAppointmentToCancel = _useState18[1];\n  useEffect(function () {\n    fetchAppointments();\n    var unsubscribe = navigation.addListener('focus', function () {\n      fetchAppointments();\n    });\n    return unsubscribe;\n  }, [navigation]);\n  var fetchAppointments = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      try {\n        setLoading(true);\n        setError(null);\n        setUsingSampleData(false);\n        console.log('Fetching appointments...');\n        var response = yield appointmentsApi.getUserAppointments();\n        if (response.data.appointments && response.data.appointments.length > 0) {\n          console.log(\"Received \" + response.data.appointments.length + \" appointments from API\");\n          response.data.appointments.forEach(function (app) {\n            console.log(\"Appointment \" + app._id + \": status=\" + app.status + \", date=\" + new Date(app.date).toDateString());\n          });\n          setAppointments(response.data.appointments);\n        } else {\n          console.log('No appointments found or empty response, using sample data');\n          setAppointments(sampleAppointments);\n          setUsingSampleData(true);\n        }\n        setLoading(false);\n      } catch (error) {\n        console.error('Error fetching appointments:', error);\n        setError('Failed to load appointments from server. Showing sample data instead.');\n        setAppointments(sampleAppointments);\n        setUsingSampleData(true);\n        setLoading(false);\n      }\n    });\n    return function fetchAppointments() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var onRefresh = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      setRefreshing(true);\n      yield fetchAppointments();\n      setRefreshing(false);\n    });\n    return function onRefresh() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var promptCancellation = function promptCancellation(appointmentId) {\n    var appointment = appointments.find(function (app) {\n      return app._id === appointmentId;\n    });\n    setAppointmentToCancel(appointmentId);\n    setDialogVisible(true);\n    setCancellationReason('');\n    console.log(\"Prompted cancellation for appointment \" + appointmentId);\n    if (appointment) {\n      console.log(\"Appointment details: \" + appointment.service.name + \" on \" + format(new Date(appointment.date), 'MMM d'));\n    }\n  };\n  var cancelAppointment = function () {\n    var _ref4 = _asyncToGenerator(function* (appointmentId, reason) {\n      try {\n        setLoading(true);\n        console.log(\"Cancelling appointment \" + appointmentId + \" with reason: \" + (reason || 'No reason provided'));\n        if (usingSampleData) {\n          console.log('Using sample data, updating locally');\n          var updatedAppointments = appointments.map(function (appointment) {\n            return appointment._id === appointmentId ? _objectSpread(_objectSpread({}, appointment), {}, {\n              status: 'cancelled',\n              cancellationReason: reason\n            }) : appointment;\n          });\n          setAppointments(updatedAppointments);\n          setLoading(false);\n          Alert.alert('Success', 'Appointment cancelled successfully');\n          return;\n        }\n        console.log('Sending cancellation request with reason:', reason);\n        var response = yield appointmentsApi.cancelAppointment(appointmentId, {\n          cancellationReason: reason\n        });\n        console.log('Cancel appointment response:', response.data);\n        if (response.data && response.data.success) {\n          Alert.alert('Success', 'Appointment cancelled successfully');\n          yield fetchAppointments();\n        } else {\n          var _response$data;\n          console.error('Failed to cancel appointment:', response.data);\n          Alert.alert('Error', ((_response$data = response.data) == null ? void 0 : _response$data.message) || 'Failed to cancel appointment');\n          setLoading(false);\n        }\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.error('Error cancelling appointment:', error);\n        Alert.alert('Error', ((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.message) || 'Failed to cancel appointment. Please try again.');\n        setLoading(false);\n      }\n    });\n    return function cancelAppointment(_x, _x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var deleteAppointment = function () {\n    var _ref5 = _asyncToGenerator(function* (appointmentId) {\n      try {\n        setLoading(true);\n        console.log(\"Deleting appointment \" + appointmentId);\n        if (usingSampleData) {\n          console.log('Using sample data, updating locally');\n          var updatedAppointments = appointments.filter(function (appointment) {\n            return appointment._id !== appointmentId;\n          });\n          setAppointments(updatedAppointments);\n          setLoading(false);\n          Alert.alert('Success', 'Appointment deleted successfully');\n          return;\n        }\n        console.log('Sending delete request');\n        var response = yield appointmentsApi.deleteAppointment(appointmentId);\n        console.log('Delete appointment response:', response.data);\n        if (response.data && response.data.success) {\n          Alert.alert('Success', 'Appointment deleted successfully');\n          yield fetchAppointments();\n        } else {\n          var _response$data2;\n          console.error('Failed to delete appointment:', response.data);\n          Alert.alert('Error', ((_response$data2 = response.data) == null ? void 0 : _response$data2.message) || 'Failed to delete appointment');\n          setLoading(false);\n        }\n      } catch (error) {\n        var _error$response2, _error$response2$data;\n        console.error('Error deleting appointment:', error);\n        Alert.alert('Error', ((_error$response2 = error.response) == null ? void 0 : (_error$response2$data = _error$response2.data) == null ? void 0 : _error$response2$data.message) || 'Failed to delete appointment. Please try again.');\n        setLoading(false);\n      }\n    });\n    return function deleteAppointment(_x3) {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var promptDelete = function promptDelete(appointmentId) {\n    var appointment = appointments.find(function (app) {\n      return app._id === appointmentId;\n    });\n    Alert.alert('Delete Appointment', \"Are you sure you want to delete this appointment\" + (appointment ? \" for \" + appointment.service.name : '') + \"?\", [{\n      text: 'Cancel',\n      style: 'cancel'\n    }, {\n      text: 'Delete',\n      onPress: function onPress() {\n        return deleteAppointment(appointmentId);\n      },\n      style: 'destructive'\n    }]);\n    console.log(\"Prompted deletion for appointment \" + appointmentId);\n  };\n  var filteredAppointments = appointments.filter(function (appointment) {\n    var appointmentDate = new Date(appointment.date);\n    var today = new Date();\n    today.setHours(0, 0, 0, 0);\n    if (activeTab === 'upcoming') {\n      return appointmentDate >= today || appointmentDate.getDate() === today.getDate() && appointment.status !== 'completed' && appointment.status !== 'cancelled';\n    } else {\n      return appointmentDate < today || appointment.status === 'completed' || appointment.status === 'cancelled';\n    }\n  }).sort(function (a, b) {\n    var dateA = new Date(a.date);\n    var dateB = new Date(b.date);\n    if (activeTab === 'upcoming') {\n      return dateA - dateB;\n    } else {\n      return dateB - dateA;\n    }\n  });\n  var renderAppointmentItem = function renderAppointmentItem(_ref6) {\n    var item = _ref6.item;\n    var appointmentDate = new Date(item.date);\n    var today = new Date();\n    today.setHours(0, 0, 0, 0);\n    var isPast = appointmentDate < today || item.status === 'completed' || item.status === 'cancelled';\n    var canCancel = !isPast && (item.status === 'confirmed' || item.status === 'pending');\n    console.log(\"Appointment \" + item._id + \": date=\" + appointmentDate.toDateString() + \", status=\" + item.status + \", isPast=\" + isPast + \", canCancel=\" + canCancel);\n    return _jsx(Card, {\n      style: [styles.card, isPast && styles.pastCard],\n      children: _jsxs(Card.Content, {\n        children: [_jsxs(View, {\n          style: styles.headerRow,\n          children: [_jsx(Title, {\n            children: item.service.name\n          }), canCancel && _jsx(Chip, {\n            mode: \"outlined\",\n            style: styles.actionChip,\n            textStyle: {\n              color: '#F44336'\n            },\n            children: \"Cancellable\"\n          })]\n        }), _jsxs(View, {\n          style: styles.row,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"Date:\"\n          }), _jsx(Text, {\n            children: format(new Date(item.date), 'MMMM d, yyyy')\n          })]\n        }), _jsxs(View, {\n          style: styles.row,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"Time:\"\n          }), _jsxs(Text, {\n            children: [item.startTime, \" - \", item.endTime]\n          })]\n        }), _jsxs(View, {\n          style: styles.row,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"Barber:\"\n          }), _jsx(Text, {\n            style: styles.barberName,\n            children: item.barber.name\n          })]\n        }), _jsxs(View, {\n          style: styles.row,\n          children: [_jsx(Text, {\n            style: styles.label,\n            children: \"Price:\"\n          }), _jsxs(Text, {\n            children: [\"$\", item.service.price]\n          })]\n        }), _jsx(View, {\n          style: styles.statusContainer,\n          children: _jsx(Chip, {\n            style: {\n              backgroundColor: item.status === 'confirmed' ? '#4CAF50' : item.status === 'pending' ? '#FFC107' : item.status === 'completed' ? '#3282B8' : '#F44336'\n            },\n            textStyle: {\n              color: 'white'\n            },\n            children: item.status.toUpperCase()\n          })\n        }), _jsxs(View, {\n          style: styles.buttonContainer,\n          children: [canCancel && _jsx(Button, {\n            mode: \"contained\",\n            style: styles.cancelButton,\n            icon: \"close\",\n            color: \"#F44336\",\n            onPress: function onPress() {\n              return promptCancellation(item._id);\n            },\n            children: \"Cancel\"\n          }), _jsx(Button, {\n            mode: \"outlined\",\n            style: styles.deleteButton,\n            icon: \"delete\",\n            color: \"#FF5722\",\n            onPress: function onPress() {\n              return promptDelete(item._id);\n            },\n            children: \"Delete\"\n          })]\n        })]\n      })\n    });\n  };\n  if (loading && !refreshing) {\n    return _jsx(View, {\n      style: styles.centered,\n      children: _jsx(ActivityIndicator, {\n        size: \"large\",\n        color: \"#0F4C75\"\n      })\n    });\n  }\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(View, {\n      style: styles.header,\n      children: _jsx(Text, {\n        style: styles.headerTitle,\n        children: \"My Appointments\"\n      })\n    }), _jsxs(View, {\n      style: styles.tabContainer,\n      children: [_jsx(Button, {\n        mode: activeTab === 'upcoming' ? 'contained' : 'outlined',\n        onPress: function onPress() {\n          return setActiveTab('upcoming');\n        },\n        style: styles.tabButton,\n        children: \"Upcoming\"\n      }), _jsx(Button, {\n        mode: activeTab === 'past' ? 'contained' : 'outlined',\n        onPress: function onPress() {\n          return setActiveTab('past');\n        },\n        style: styles.tabButton,\n        children: \"Past\"\n      })]\n    }), _jsx(Divider, {}), usingSampleData && _jsx(Banner, {\n      visible: true,\n      icon: \"information\",\n      actions: [{\n        label: 'Retry',\n        onPress: fetchAppointments\n      }],\n      children: \"Showing demo appointments. Tap \\\"Retry\\\" to attempt loading from server.\"\n    }), error ? _jsx(Banner, {\n      visible: true,\n      icon: \"alert\",\n      actions: [{\n        label: 'Retry',\n        onPress: fetchAppointments\n      }],\n      children: error\n    }) : _jsxs(_Fragment, {\n      children: [_jsx(FlatList, {\n        data: filteredAppointments,\n        renderItem: renderAppointmentItem,\n        keyExtractor: function keyExtractor(item) {\n          return item._id;\n        },\n        contentContainerStyle: styles.appointmentsList,\n        refreshControl: _jsx(RefreshControl, {\n          refreshing: refreshing,\n          onRefresh: onRefresh,\n          colors: ['#0F4C75']\n        }),\n        ListEmptyComponent: _jsxs(View, {\n          style: styles.emptyContainer,\n          children: [_jsx(Text, {\n            style: styles.emptyText,\n            children: activeTab === 'upcoming' ? \"You don't have any upcoming appointments\" : \"You don't have any past appointments\"\n          }), activeTab === 'upcoming' && _jsx(Button, {\n            mode: \"contained\",\n            style: styles.bookButton,\n            onPress: function onPress() {\n              return navigation.navigate('Services');\n            },\n            children: \"Book an Appointment\"\n          })]\n        })\n      }), activeTab === 'upcoming' && _jsx(FAB, {\n        style: styles.fab,\n        icon: \"plus\",\n        label: \"Book\",\n        onPress: function onPress() {\n          return navigation.navigate('Services');\n        }\n      })]\n    }), _jsx(Portal, {\n      children: _jsxs(Dialog, {\n        visible: dialogVisible,\n        onDismiss: function onDismiss() {\n          return setDialogVisible(false);\n        },\n        children: [_jsx(Dialog.Title, {\n          style: styles.dialogTitle,\n          children: \"Confirm Cancellation\"\n        }), _jsxs(Dialog.Content, {\n          children: [_jsx(Text, {\n            style: styles.dialogText,\n            children: \"Are you sure you want to cancel this appointment? This action cannot be undone.\"\n          }), _jsx(Text, {\n            style: styles.dialogSubText,\n            children: \"Please provide a reason for cancelling (optional):\"\n          }), _jsx(TextInput, {\n            style: styles.input,\n            value: cancellationReason,\n            onChangeText: setCancellationReason,\n            placeholder: \"e.g., Schedule conflict, illness, etc.\",\n            multiline: true\n          })]\n        }), _jsxs(Dialog.Actions, {\n          children: [_jsx(Button, {\n            onPress: function onPress() {\n              return setDialogVisible(false);\n            },\n            style: styles.dialogButton,\n            children: \"Go Back\"\n          }), _jsx(Button, {\n            onPress: function onPress() {\n              setDialogVisible(false);\n              cancelAppointment(appointmentToCancel, cancellationReason);\n            },\n            mode: \"contained\",\n            color: \"#F44336\",\n            style: styles.dialogConfirmButton,\n            children: \"Confirm Cancellation\"\n          })]\n        })]\n      })\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#f5f5f5'\n  },\n  centered: {\n    flex: 1,\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: 20\n  },\n  errorText: {\n    color: '#d32f2f',\n    marginBottom: 20,\n    textAlign: 'center'\n  },\n  header: {\n    backgroundColor: '#0F4C75',\n    padding: 20,\n    paddingTop: 50,\n    paddingBottom: 20\n  },\n  headerTitle: {\n    fontSize: 24,\n    color: 'white',\n    fontWeight: 'bold'\n  },\n  tabContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-around',\n    padding: 10,\n    backgroundColor: 'white'\n  },\n  tabButton: {\n    flex: 1,\n    margin: 5\n  },\n  appointmentsList: {\n    padding: 15,\n    paddingBottom: 80\n  },\n  card: {\n    marginBottom: 15,\n    borderRadius: 10,\n    elevation: 3\n  },\n  pastCard: {\n    opacity: 0.8\n  },\n  row: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginVertical: 5\n  },\n  label: {\n    fontWeight: 'bold',\n    color: '#666'\n  },\n  statusContainer: {\n    marginTop: 10,\n    marginBottom: 15,\n    alignItems: 'flex-start'\n  },\n  cancelButton: {\n    marginTop: 15,\n    borderColor: '#F44336',\n    backgroundColor: '#F44336',\n    padding: 5,\n    marginHorizontal: 20\n  },\n  emptyContainer: {\n    padding: 20,\n    alignItems: 'center'\n  },\n  emptyText: {\n    fontSize: 16,\n    color: 'gray',\n    marginBottom: 20,\n    textAlign: 'center'\n  },\n  bookButton: {\n    marginTop: 10\n  },\n  fab: {\n    position: 'absolute',\n    margin: 16,\n    right: 0,\n    bottom: 0,\n    backgroundColor: '#0F4C75'\n  },\n  dialogTitle: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 10\n  },\n  dialogText: {\n    marginBottom: 10\n  },\n  dialogSubText: {\n    marginBottom: 10\n  },\n  dialogButton: {\n    marginRight: 10\n  },\n  dialogConfirmButton: {\n    marginLeft: 10\n  },\n  input: {\n    borderWidth: 1,\n    borderColor: '#ddd',\n    borderRadius: 5,\n    padding: 10,\n    marginTop: 5,\n    minHeight: 80\n  },\n  barberName: {\n    fontWeight: 'bold'\n  },\n  headerRow: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center'\n  },\n  actionChip: {\n    borderColor: '#F44336',\n    backgroundColor: 'white'\n  },\n  buttonContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    marginTop: 10\n  },\n  deleteButton: {\n    borderColor: '#FF5722',\n    backgroundColor: 'white'\n  }\n});\nexport default AppointmentsScreen;","map":{"version":3,"names":["React","useState","useEffect","View","StyleSheet","FlatList","RefreshControl","Alert","TextInput","Text","Card","Title","Paragraph","Button","ActivityIndicator","Chip","FAB","Divider","Banner","Dialog","Portal","format","appointmentsApi","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","sampleAppointments","_id","service","name","price","duration","barber","date","Date","now","toISOString","startTime","endTime","status","AppointmentsScreen","_ref","navigation","_useState","_useState2","_slicedToArray","appointments","setAppointments","_useState3","_useState4","loading","setLoading","_useState5","_useState6","refreshing","setRefreshing","_useState7","_useState8","error","setError","_useState9","_useState10","activeTab","setActiveTab","_useState11","_useState12","usingSampleData","setUsingSampleData","_useState13","_useState14","cancellationReason","setCancellationReason","_useState15","_useState16","dialogVisible","setDialogVisible","_useState17","_useState18","appointmentToCancel","setAppointmentToCancel","fetchAppointments","unsubscribe","addListener","_ref2","_asyncToGenerator","console","log","response","getUserAppointments","data","length","forEach","app","toDateString","apply","arguments","onRefresh","_ref3","promptCancellation","appointmentId","appointment","find","cancelAppointment","_ref4","reason","updatedAppointments","map","_objectSpread","alert","success","_response$data","message","_error$response","_error$response$data","_x","_x2","deleteAppointment","_ref5","filter","_response$data2","_error$response2","_error$response2$data","_x3","promptDelete","text","style","onPress","filteredAppointments","appointmentDate","today","setHours","getDate","sort","a","b","dateA","dateB","renderAppointmentItem","_ref6","item","isPast","canCancel","styles","card","pastCard","children","Content","headerRow","mode","actionChip","textStyle","color","row","label","barberName","statusContainer","backgroundColor","toUpperCase","buttonContainer","cancelButton","icon","deleteButton","centered","size","container","header","headerTitle","tabContainer","tabButton","visible","actions","renderItem","keyExtractor","contentContainerStyle","appointmentsList","refreshControl","colors","ListEmptyComponent","emptyContainer","emptyText","bookButton","navigate","fab","onDismiss","dialogTitle","dialogText","dialogSubText","input","value","onChangeText","placeholder","multiline","Actions","dialogButton","dialogConfirmButton","create","flex","justifyContent","alignItems","padding","errorText","marginBottom","textAlign","paddingTop","paddingBottom","fontSize","fontWeight","flexDirection","margin","borderRadius","elevation","opacity","marginVertical","marginTop","borderColor","marginHorizontal","position","right","bottom","marginRight","marginLeft","borderWidth","minHeight"],"sources":["C:/Users/User/Downloads/mobile/screens/customer/AppointmentsScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { View, StyleSheet, FlatList, RefreshControl, Alert, TextInput } from 'react-native';\r\nimport { Text, Card, Title, Paragraph, Button, ActivityIndicator, Chip, FAB, Divider, Banner, Dialog, Portal } from 'react-native-paper';\r\nimport { format } from 'date-fns';\r\nimport { appointmentsApi } from '../../api/client';\r\n\r\n// Sample appointments for fallback if API fails\r\nconst sampleAppointments = [\r\n  {\r\n    _id: '1',\r\n    service: {\r\n      _id: '101',\r\n      name: 'Classic Haircut',\r\n      price: 25,\r\n      duration: 30\r\n    },\r\n    barber: {\r\n      _id: '201',\r\n      name: 'John Barber'\r\n    },\r\n    date: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(), // 2 days from now\r\n    startTime: '10:00',\r\n    endTime: '10:30',\r\n    status: 'confirmed'\r\n  },\r\n  {\r\n    _id: '2',\r\n    service: {\r\n      _id: '102',\r\n      name: 'Beard Trim',\r\n      price: 15,\r\n      duration: 20\r\n    },\r\n    barber: {\r\n      _id: '202',\r\n      name: 'Mike Scissors'\r\n    },\r\n    date: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000).toISOString(), // 5 days from now\r\n    startTime: '14:00',\r\n    endTime: '14:20',\r\n    status: 'pending'\r\n  },\r\n  {\r\n    _id: '3',\r\n    service: {\r\n      _id: '103',\r\n      name: 'Premium Package',\r\n      price: 45,\r\n      duration: 60\r\n    },\r\n    barber: {\r\n      _id: '203',\r\n      name: 'Sarah Style'\r\n    },\r\n    date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(), // 3 days ago\r\n    startTime: '11:00',\r\n    endTime: '12:00',\r\n    status: 'completed'\r\n  },\r\n  {\r\n    _id: '4',\r\n    service: {\r\n      _id: '104',\r\n      name: 'Hair Coloring',\r\n      price: 60,\r\n      duration: 90\r\n    },\r\n    barber: {\r\n      _id: '204',\r\n      name: 'Alex Color'\r\n    },\r\n    date: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(), // 7 days ago\r\n    startTime: '09:00',\r\n    endTime: '10:30',\r\n    status: 'cancelled'\r\n  }\r\n];\r\n\r\nconst AppointmentsScreen = ({ navigation }) => {\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [refreshing, setRefreshing] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [activeTab, setActiveTab] = useState('upcoming'); // 'upcoming' or 'past'\r\n  const [usingSampleData, setUsingSampleData] = useState(false);\r\n  const [cancellationReason, setCancellationReason] = useState('');\r\n  const [dialogVisible, setDialogVisible] = useState(false);\r\n  const [appointmentToCancel, setAppointmentToCancel] = useState(null);\r\n  \r\n  useEffect(() => {\r\n    fetchAppointments();\r\n    \r\n    // Refresh appointments when screen is focused\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      fetchAppointments();\r\n    });\r\n    \r\n    return unsubscribe;\r\n  }, [navigation]);\r\n  \r\n  const fetchAppointments = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      setUsingSampleData(false);\r\n      \r\n      console.log('Fetching appointments...');\r\n      const response = await appointmentsApi.getUserAppointments();\r\n      \r\n      if (response.data.appointments && response.data.appointments.length > 0) {\r\n        console.log(`Received ${response.data.appointments.length} appointments from API`);\r\n        // Log the status of each appointment to debug\r\n        response.data.appointments.forEach(app => {\r\n          console.log(`Appointment ${app._id}: status=${app.status}, date=${new Date(app.date).toDateString()}`);\r\n        });\r\n        setAppointments(response.data.appointments);\r\n      } else {\r\n        console.log('No appointments found or empty response, using sample data');\r\n        setAppointments(sampleAppointments);\r\n        setUsingSampleData(true);\r\n      }\r\n      \r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error fetching appointments:', error);\r\n      setError('Failed to load appointments from server. Showing sample data instead.');\r\n      // Use sample data if API fails\r\n      setAppointments(sampleAppointments);\r\n      setUsingSampleData(true);\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  const onRefresh = async () => {\r\n    setRefreshing(true);\r\n    await fetchAppointments();\r\n    setRefreshing(false);\r\n  };\r\n  \r\n  const promptCancellation = (appointmentId) => {\r\n    // Find the appointment to get more details for a better user experience\r\n    const appointment = appointments.find(app => app._id === appointmentId);\r\n    setAppointmentToCancel(appointmentId);\r\n    setDialogVisible(true);\r\n    setCancellationReason('');\r\n    \r\n    // Debug info\r\n    console.log(`Prompted cancellation for appointment ${appointmentId}`);\r\n    if (appointment) {\r\n      console.log(`Appointment details: ${appointment.service.name} on ${format(new Date(appointment.date), 'MMM d')}`);\r\n    }\r\n  };\r\n  \r\n  const cancelAppointment = async (appointmentId, reason) => {\r\n    try {\r\n      setLoading(true);\r\n      console.log(`Cancelling appointment ${appointmentId} with reason: ${reason || 'No reason provided'}`);\r\n      \r\n      // If using sample data, just update the local state\r\n      if (usingSampleData) {\r\n        console.log('Using sample data, updating locally');\r\n        const updatedAppointments = appointments.map(appointment => \r\n          appointment._id === appointmentId \r\n            ? { ...appointment, status: 'cancelled', cancellationReason: reason }\r\n            : appointment\r\n        );\r\n        setAppointments(updatedAppointments);\r\n        setLoading(false);\r\n        Alert.alert('Success', 'Appointment cancelled successfully');\r\n        return;\r\n      }\r\n      \r\n      // Otherwise, call the API\r\n      console.log('Sending cancellation request with reason:', reason);\r\n      const response = await appointmentsApi.cancelAppointment(appointmentId, { cancellationReason: reason });\r\n      console.log('Cancel appointment response:', response.data);\r\n      \r\n      if (response.data && response.data.success) {\r\n        Alert.alert('Success', 'Appointment cancelled successfully');\r\n        // Reload appointments to get updated status\r\n        await fetchAppointments();\r\n      } else {\r\n        console.error('Failed to cancel appointment:', response.data);\r\n        Alert.alert('Error', response.data?.message || 'Failed to cancel appointment');\r\n        setLoading(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error cancelling appointment:', error);\r\n      Alert.alert('Error', error.response?.data?.message || 'Failed to cancel appointment. Please try again.');\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Add a new deleteAppointment function\r\n  const deleteAppointment = async (appointmentId) => {\r\n    try {\r\n      setLoading(true);\r\n      console.log(`Deleting appointment ${appointmentId}`);\r\n      \r\n      // If using sample data, just update the local state\r\n      if (usingSampleData) {\r\n        console.log('Using sample data, updating locally');\r\n        const updatedAppointments = appointments.filter(appointment => \r\n          appointment._id !== appointmentId\r\n        );\r\n        setAppointments(updatedAppointments);\r\n        setLoading(false);\r\n        Alert.alert('Success', 'Appointment deleted successfully');\r\n        return;\r\n      }\r\n      \r\n      // Otherwise, call the API\r\n      console.log('Sending delete request');\r\n      const response = await appointmentsApi.deleteAppointment(appointmentId);\r\n      console.log('Delete appointment response:', response.data);\r\n      \r\n      if (response.data && response.data.success) {\r\n        Alert.alert('Success', 'Appointment deleted successfully');\r\n        // Reload appointments to refresh the list\r\n        await fetchAppointments();\r\n      } else {\r\n        console.error('Failed to delete appointment:', response.data);\r\n        Alert.alert('Error', response.data?.message || 'Failed to delete appointment');\r\n        setLoading(false);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error deleting appointment:', error);\r\n      Alert.alert('Error', error.response?.data?.message || 'Failed to delete appointment. Please try again.');\r\n      setLoading(false);\r\n    }\r\n  };\r\n  \r\n  // Add a function to prompt for deletion confirmation\r\n  const promptDelete = (appointmentId) => {\r\n    // Find the appointment to get more details for a better user experience\r\n    const appointment = appointments.find(app => app._id === appointmentId);\r\n    \r\n    Alert.alert(\r\n      'Delete Appointment',\r\n      `Are you sure you want to delete this appointment${appointment ? ` for ${appointment.service.name}` : ''}?`,\r\n      [\r\n        {\r\n          text: 'Cancel',\r\n          style: 'cancel'\r\n        },\r\n        {\r\n          text: 'Delete',\r\n          onPress: () => deleteAppointment(appointmentId),\r\n          style: 'destructive'\r\n        }\r\n      ]\r\n    );\r\n    \r\n    // Debug info\r\n    console.log(`Prompted deletion for appointment ${appointmentId}`);\r\n  };\r\n  \r\n  // Filter appointments by upcoming or past\r\n  const filteredAppointments = appointments.filter(appointment => {\r\n    const appointmentDate = new Date(appointment.date);\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    \r\n    if (activeTab === 'upcoming') {\r\n      return appointmentDate >= today || \r\n             (appointmentDate.getDate() === today.getDate() && \r\n              appointment.status !== 'completed' && \r\n              appointment.status !== 'cancelled');\r\n    } else {\r\n      return appointmentDate < today || \r\n             appointment.status === 'completed' || \r\n             appointment.status === 'cancelled';\r\n    }\r\n  }).sort((a, b) => {\r\n    // Sort by date\r\n    const dateA = new Date(a.date);\r\n    const dateB = new Date(b.date);\r\n    \r\n    if (activeTab === 'upcoming') {\r\n      return dateA - dateB; // Ascending for upcoming\r\n    } else {\r\n      return dateB - dateA; // Descending for past\r\n    }\r\n  });\r\n  \r\n  const renderAppointmentItem = ({ item }) => {\r\n    // Improved date comparison\r\n    const appointmentDate = new Date(item.date);\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0); // Set to start of day\r\n    \r\n    const isPast = appointmentDate < today || \r\n                  item.status === 'completed' || \r\n                  item.status === 'cancelled';\r\n    \r\n    const canCancel = !isPast && \r\n                     (item.status === 'confirmed' || item.status === 'pending');\r\n    \r\n    console.log(`Appointment ${item._id}: date=${appointmentDate.toDateString()}, status=${item.status}, isPast=${isPast}, canCancel=${canCancel}`);\r\n    \r\n    return (\r\n      <Card style={[styles.card, isPast && styles.pastCard]}>\r\n        <Card.Content>\r\n          <View style={styles.headerRow}>\r\n            <Title>{item.service.name}</Title>\r\n            {canCancel && (\r\n              <Chip \r\n                mode=\"outlined\" \r\n                style={styles.actionChip}\r\n                textStyle={{color: '#F44336'}}\r\n              >\r\n                Cancellable\r\n              </Chip>\r\n            )}\r\n          </View>\r\n          \r\n          <View style={styles.row}>\r\n            <Text style={styles.label}>Date:</Text>\r\n            <Text>{format(new Date(item.date), 'MMMM d, yyyy')}</Text>\r\n          </View>\r\n          <View style={styles.row}>\r\n            <Text style={styles.label}>Time:</Text>\r\n            <Text>{item.startTime} - {item.endTime}</Text>\r\n          </View>\r\n          <View style={styles.row}>\r\n            <Text style={styles.label}>Barber:</Text>\r\n            <Text style={styles.barberName}>{item.barber.name}</Text>\r\n          </View>\r\n          <View style={styles.row}>\r\n            <Text style={styles.label}>Price:</Text>\r\n            <Text>${item.service.price}</Text>\r\n          </View>\r\n          \r\n          <View style={styles.statusContainer}>\r\n            <Chip\r\n              style={{\r\n                backgroundColor: \r\n                  item.status === 'confirmed' ? '#4CAF50' :\r\n                  item.status === 'pending' ? '#FFC107' :\r\n                  item.status === 'completed' ? '#3282B8' : '#F44336'\r\n              }}\r\n              textStyle={{ color: 'white' }}\r\n            >\r\n              {item.status.toUpperCase()}\r\n            </Chip>\r\n          </View>\r\n          \r\n          <View style={styles.buttonContainer}>\r\n            {canCancel && (\r\n              <Button\r\n                mode=\"contained\"\r\n                style={styles.cancelButton}\r\n                icon=\"close\"\r\n                color=\"#F44336\"\r\n                onPress={() => promptCancellation(item._id)}\r\n              >\r\n                Cancel\r\n              </Button>\r\n            )}\r\n            \r\n            {/* Add delete button */}\r\n            <Button\r\n              mode=\"outlined\"\r\n              style={styles.deleteButton}\r\n              icon=\"delete\"\r\n              color=\"#FF5722\"\r\n              onPress={() => promptDelete(item._id)}\r\n            >\r\n              Delete\r\n            </Button>\r\n          </View>\r\n        </Card.Content>\r\n      </Card>\r\n    );\r\n  };\r\n  \r\n  if (loading && !refreshing) {\r\n    return (\r\n      <View style={styles.centered}>\r\n        <ActivityIndicator size=\"large\" color=\"#0F4C75\" />\r\n      </View>\r\n    );\r\n  }\r\n  \r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.header}>\r\n        <Text style={styles.headerTitle}>My Appointments</Text>\r\n      </View>\r\n      \r\n      <View style={styles.tabContainer}>\r\n        <Button\r\n          mode={activeTab === 'upcoming' ? 'contained' : 'outlined'}\r\n          onPress={() => setActiveTab('upcoming')}\r\n          style={styles.tabButton}\r\n        >\r\n          Upcoming\r\n        </Button>\r\n        <Button\r\n          mode={activeTab === 'past' ? 'contained' : 'outlined'}\r\n          onPress={() => setActiveTab('past')}\r\n          style={styles.tabButton}\r\n        >\r\n          Past\r\n        </Button>\r\n      </View>\r\n      \r\n      <Divider />\r\n      \r\n      {usingSampleData && (\r\n        <Banner\r\n          visible={true}\r\n          icon=\"information\"\r\n          actions={[\r\n            {\r\n              label: 'Retry',\r\n              onPress: fetchAppointments,\r\n            },\r\n          ]}\r\n        >\r\n          Showing demo appointments. Tap \"Retry\" to attempt loading from server.\r\n        </Banner>\r\n      )}\r\n      \r\n      {error ? (\r\n        <Banner\r\n          visible={true}\r\n          icon=\"alert\"\r\n          actions={[\r\n            {\r\n              label: 'Retry',\r\n              onPress: fetchAppointments,\r\n            },\r\n          ]}\r\n        >\r\n          {error}\r\n        </Banner>\r\n      ) : (\r\n        <>\r\n          <FlatList\r\n            data={filteredAppointments}\r\n            renderItem={renderAppointmentItem}\r\n            keyExtractor={(item) => item._id}\r\n            contentContainerStyle={styles.appointmentsList}\r\n            refreshControl={\r\n              <RefreshControl\r\n                refreshing={refreshing}\r\n                onRefresh={onRefresh}\r\n                colors={['#0F4C75']}\r\n              />\r\n            }\r\n            ListEmptyComponent={\r\n              <View style={styles.emptyContainer}>\r\n                <Text style={styles.emptyText}>\r\n                  {activeTab === 'upcoming'\r\n                    ? \"You don't have any upcoming appointments\"\r\n                    : \"You don't have any past appointments\"}\r\n                </Text>\r\n                {activeTab === 'upcoming' && (\r\n                  <Button\r\n                    mode=\"contained\"\r\n                    style={styles.bookButton}\r\n                    onPress={() => navigation.navigate('Services')}\r\n                  >\r\n                    Book an Appointment\r\n                  </Button>\r\n                )}\r\n              </View>\r\n            }\r\n          />\r\n          \r\n          {activeTab === 'upcoming' && (\r\n            <FAB\r\n              style={styles.fab}\r\n              icon=\"plus\"\r\n              label=\"Book\"\r\n              onPress={() => navigation.navigate('Services')}\r\n            />\r\n          )}\r\n        </>\r\n      )}\r\n      \r\n      <Portal>\r\n        <Dialog visible={dialogVisible} onDismiss={() => setDialogVisible(false)}>\r\n          <Dialog.Title style={styles.dialogTitle}>Confirm Cancellation</Dialog.Title>\r\n          <Dialog.Content>\r\n            <Text style={styles.dialogText}>\r\n              Are you sure you want to cancel this appointment? This action cannot be undone.\r\n            </Text>\r\n            <Text style={styles.dialogSubText}>\r\n              Please provide a reason for cancelling (optional):\r\n            </Text>\r\n            <TextInput\r\n              style={styles.input}\r\n              value={cancellationReason}\r\n              onChangeText={setCancellationReason}\r\n              placeholder=\"e.g., Schedule conflict, illness, etc.\"\r\n              multiline\r\n            />\r\n          </Dialog.Content>\r\n          <Dialog.Actions>\r\n            <Button onPress={() => setDialogVisible(false)} style={styles.dialogButton}>Go Back</Button>\r\n            <Button \r\n              onPress={() => {\r\n                setDialogVisible(false);\r\n                cancelAppointment(appointmentToCancel, cancellationReason);\r\n              }}\r\n              mode=\"contained\"\r\n              color=\"#F44336\"\r\n              style={styles.dialogConfirmButton}\r\n            >\r\n              Confirm Cancellation\r\n            </Button>\r\n          </Dialog.Actions>\r\n        </Dialog>\r\n      </Portal>\r\n    </View>\r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#f5f5f5',\r\n  },\r\n  centered: {\r\n    flex: 1,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    padding: 20,\r\n  },\r\n  errorText: {\r\n    color: '#d32f2f',\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n  },\r\n  header: {\r\n    backgroundColor: '#0F4C75',\r\n    padding: 20,\r\n    paddingTop: 50,\r\n    paddingBottom: 20,\r\n  },\r\n  headerTitle: {\r\n    fontSize: 24,\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n  },\r\n  tabContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-around',\r\n    padding: 10,\r\n    backgroundColor: 'white',\r\n  },\r\n  tabButton: {\r\n    flex: 1,\r\n    margin: 5,\r\n  },\r\n  appointmentsList: {\r\n    padding: 15,\r\n    paddingBottom: 80, // Add extra padding at bottom for FAB\r\n  },\r\n  card: {\r\n    marginBottom: 15,\r\n    borderRadius: 10,\r\n    elevation: 3,\r\n  },\r\n  pastCard: {\r\n    opacity: 0.8,\r\n  },\r\n  row: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginVertical: 5,\r\n  },\r\n  label: {\r\n    fontWeight: 'bold',\r\n    color: '#666',\r\n  },\r\n  statusContainer: {\r\n    marginTop: 10,\r\n    marginBottom: 15,\r\n    alignItems: 'flex-start',\r\n  },\r\n  cancelButton: {\r\n    marginTop: 15,\r\n    borderColor: '#F44336',\r\n    backgroundColor: '#F44336',\r\n    padding: 5,\r\n    marginHorizontal: 20,\r\n  },\r\n  emptyContainer: {\r\n    padding: 20,\r\n    alignItems: 'center',\r\n  },\r\n  emptyText: {\r\n    fontSize: 16,\r\n    color: 'gray',\r\n    marginBottom: 20,\r\n    textAlign: 'center',\r\n  },\r\n  bookButton: {\r\n    marginTop: 10,\r\n  },\r\n  fab: {\r\n    position: 'absolute',\r\n    margin: 16,\r\n    right: 0,\r\n    bottom: 0,\r\n    backgroundColor: '#0F4C75',\r\n  },\r\n  dialogTitle: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n    marginBottom: 10,\r\n  },\r\n  dialogText: {\r\n    marginBottom: 10,\r\n  },\r\n  dialogSubText: {\r\n    marginBottom: 10,\r\n  },\r\n  dialogButton: {\r\n    marginRight: 10,\r\n  },\r\n  dialogConfirmButton: {\r\n    marginLeft: 10,\r\n  },\r\n  input: {\r\n    borderWidth: 1,\r\n    borderColor: '#ddd',\r\n    borderRadius: 5,\r\n    padding: 10,\r\n    marginTop: 5,\r\n    minHeight: 80,\r\n  },\r\n  barberName: {\r\n    fontWeight: 'bold',\r\n  },\r\n  headerRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n  },\r\n  actionChip: {\r\n    borderColor: '#F44336',\r\n    backgroundColor: 'white',\r\n  },\r\n  buttonContainer: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    marginTop: 10,\r\n  },\r\n  deleteButton: {\r\n    borderColor: '#FF5722',\r\n    backgroundColor: 'white',\r\n  },\r\n});\r\n\r\nexport default AppointmentsScreen; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}